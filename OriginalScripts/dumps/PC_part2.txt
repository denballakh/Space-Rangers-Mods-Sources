Version=7
GlobalVars <{
}
GlobalCode=<<<
  if(GetShipPirateRank(Player())<2) {
    GRun();
  }
>>>
LocalVars <{
    locations <{
        Type=unknown
        Value=None
    }
    rewards <{
        Type=unknown
        Value=None
    }
    rewards_text <{
        Type=unknown
        Value=None
    }
	
    bonus_name <{
        Type=str
        Value=
    }
    stukach_name <{
        Type=str
        Value=
    }
    reward_item <{
        Type=str
        Value=
    }
    points <{
        Type=str
        Value=
    }
	
    quest_star <{
        Type=dword
        Value=0
    }
    quest_planet <{
        Type=dword
        Value=0
    }
    quest_item <{
        Type=dword
        Value=0
    }
    rewardSeed <{
        Type=dword
        Value=0
    }
    quest_ship <{
        Type=dword
        Value=0
    }
    temp_planet <{
        Type=dword
        Value=0
    }
	
    quest_started <{
        Type=int
        Value=0
    }
    points_reached <{
        Type=int
        Value=0
    }
    safety_dist <{
        Type=int
        Value=0
    }
    counter <{
        Type=int
        Value=0
    }
    quest_complete <{
        Type=int
        Value=0
    }
    stukach_resqued <{
        Type=int
        Value=0
    }
    reward_received <{
        Type=int
        Value=0
    }
    stukach_race <{
        Type=int
        Value=0
    }
    stukach_face <{
        Type=int
        Value=0
    }
    stukach_talk <{
        Type=int
        Value=0
    }
    planet_owner <{
        Type=int
        Value=0
    }
    itemlocx <{
        Type=int
        Value=0
    }
    itemlocy <{
        Type=int
        Value=0
    }
    money_offer <{
        Type=int
        Value=0
    }
    completion_type <{
        Type=int
        Value=0
    }
    stukach_killed_date <{
        Type=int
        Value=0
    }
    stukach_dead <{
        Type=int
        Value=0
    }
    stukach_picked <{
        Type=int
        Value=0
    }
    message_from_gov <{
        Type=int
        Value=0
    }
    gov_talk <{
        Type=int
        Value=0
    }
    gov_planet <{
        Type=int
        Value=0
    }
    quest_taken <{
        Type=int
        Value=0
    }
    item_type <{
        Type=int
        Value=0
    }
    syst_pir <{
        Type=int
        Value=0
    }
    syst_dom <{
        Type=int
        Value=0
    }
    cycle_flag <{
        Type=int
        Value=0
    }
    counter2 <{
        Type=int
        Value=0
    }
    change_loc <{
        Type=int
        Value=0
    }
    block_sys_date <{
        Type=int
        Value=0
    }
    stukach_fullname <{
        Type=str
        Value=
    }
    alt_message <{
        Type=int
        Value=0
    }
    player_kills_stukach <{
        Type=int
        Value=0
    }
    stukach_id <{
        Type=int
        Value=0
    }
    money_for_rank <{
        Type=int
        Value=4000
    }
	
    StarNew <{
        Type=dword
        Value=0
    }
    PlanetNew <{
        Type=dword
        Value=0
    }
    Stukach_Capsule <{
        Type=dword
        Value=0
    }
	
    GroupNew <{
        Type=dword
        Value=0
    }
    Stukach <{
        Type=dword
        Value=1
    }
    Dummy <{
        Type=dword
        Value=2
    }
	
    DialogPB3 <{
        Type=dword
        Value=0
    }
    DialogPB1 <{
        Type=dword
        Value=1
    }
    DialogPB2 <{
        Type=dword
        Value=2
    }
    DialogPlanet <{
        Type=dword
        Value=3
    }
    DialogPB4 <{
        Type=dword
        Value=4
    }
    DialogStukach <{
        Type=dword
        Value=5
    }
    DialogPlanet2 <{
        Type=dword
        Value=6
    }
    DialogPB6 <{
        Type=dword
        Value=7
    }
}
Constellations=0
Stars <{
    StarNew <{
        Constellation=-1
        NoKling=False
        NoComeKling=False
        StarLinks <{
        }
        Planets <{
            PlanetNew <{
                Race=Maloc,Peleng,People,Fei,Gaal
                Owner=Maloc,Peleng,People,Fei,Gaal
                Economy=Agriculture,Industrial,Mixed
                Government=Anarchy,Dictatorship,Monarchy,Republic,Democracy
                Range=0..100
                Dialog=
            }
        }
        Ships <{
            0 <{
                Count=1
                Owner=Maloc,Peleng,People,Fei,Gaal
                Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
                IsPlayer=True
                Speed=0..10000
                Weapon=Undef
                CargoHook=0
                EmptySpace=0
                Status <{
                    Trader=0..100
                    Warrior=0..100
                    Pirate=0..100
                }
                Strength=0.0..0.0
                Ruins=
            }
        }
    }
}
Places <{
}
Items <{
    Stukach_Capsule <{
        Place=
        Class=Unknown
        Type=0
        Size=10
        Level=1
        Radius=150
        Owner=None
        Useless=
    }
}
Groups <{
    GroupNew <{
        Planet=PlanetNew
        State=0(StateNew)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
        Count=1..1
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=True
        Status <{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
    Stukach <{
        Planet=PlanetNew
        State=1(StateStukach)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
        Count=0..0
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=False
        Status <{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
    Dummy <{
        Planet=PlanetNew
        State=2(StateNone)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
        Count=0..0
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=False
        Status <{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
}
GroupLinks <{
}
InitCode=<<<
  locations=newarray(1);
  rewards=newarray(1);
  //BuildListOfMMByPriority(rewards,40,69);
  //ArrayRandomize(50,rewards);
  rewards_text=newarray(3);
  //rewards_text[0]='</color>'+BonusText(rewards[0])+'<color=0,0,0>';
  //rewards_text[1]='</color>'+BonusText(rewards[1])+'<color=0,0,0>';
  //rewards_text[2]='</color>'+BonusText(rewards[2])+'<color=0,0,0>';
>>>
TurnCode=<<<
  if(!points_reached) {
    if(ShipPirateRankPoints(Player())>=ShipNextPirateRankPoints(Player())) {
      if(GetShipPirateRank(Player())==1) {
        points_reached=1;
        if(!quest_started) {
          Ether(0,'818812AE-CE19-4409-869A-D980C0E82FB6',CT("Script.PC_part2.151"));
        }
      }
    }
  }
  if(quest_started) {
    if(!stukach_killed_date) {
      if(GroupCount(Stukach)==0) {
        stukach_killed_date=CurTurn();
        if(ItemExist(Stukach_Capsule)) {
          if(!ShipInNormalSpace(Player()) || !ItemIn(Stukach_Capsule,ShipStar(Player()))) {
            counter=0;
            while (counter<GalaxyStars()){
            if (ItemIn(Stukach_Capsule,GalaxyStar(counter))){ItemDestroy(Stukach_Capsule,1);}
            counter=counter+1;}
            ReleaseItemFromScript(Stukach_Capsule);
            if(stukach_picked) {
              Ether(0,'9DEA6BA7-3D4B-4B14-B715-D6F501DF51BA',CT("Script.PC_part2.168"));
            }
          }
        }
      }
    }
  }
  if(!stukach_dead) {
    if(stukach_killed_date) {
      if(ItemExist(Stukach_Capsule)) {
        if(ItemIn(Stukach_Capsule,Player()) && !stukach_picked) {
          stukach_picked=1;
          Ether(3,'17947350-25C4-4E2D-89FD-A24BD0BEE7C1',CT("Script.PC_part2.114"));
        }
        if(!ItemIn(Stukach_Capsule,Player())) {
          if((CurTurn()>stukach_killed_date+3) || !ItemIn(Stukach_Capsule,ShipStar(Player()))) {
            counter=0;
            while (counter<GalaxyStars()){
            if (ItemIn(Stukach_Capsule,GalaxyStar(counter))){ItemDestroy(Stukach_Capsule,1);}
            counter=counter+1;}
            ReleaseItemFromScript(Stukach_Capsule);
            if(stukach_picked) {
              Ether(0,'9DEA6BA7-3D4B-4B14-B715-D6F501DF51BA',CT("Script.PC_part2.168"));
            }
          }
        }
      }
      if(!ItemExist(Stukach_Capsule) && !completion_type) {
        stukach_dead=1;
        Ether(3,'573DD065-E77D-4FFB-A280-ACC0019873CD',Format(CT("Script.PC_part2.150"),"<0>",stukach_fullname));
        Ether(0,'B868DCF1-8DDB-41F1-9BBB-4DDEE804E730',CT("Script.PC_part2.89"));
        if(stukach_picked && !stukach_resqued) {
          stukach_picked=0;
          Ether(4,'17947350-25C4-4E2D-89FD-A24BD0BEE7C1',CT("Script.PC_part2.114"));
        }
      }
    }
  }
  if(GroupCount(Stukach)) {
    if(!message_from_gov) {
      if(ShipInNormalSpace(Player())) {
        gov_planet=0;
        counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),1,255);
        if (counter){counter=StarListToTransitPlanetList(locations,ShipStar(Player()),ShipStar(GroupToShip(Stukach)),70,150,200,100,90,75);}
        if (counter){gov_planet=Id(locations[0]);}
        if(gov_planet) {
          message_from_gov=1;
          Ether(0,'ED99C452-1542-41D4-9911-9E66254B1955',Format(CT("Script.PC_part2.149"),"<0>",ShipName(Player()),"<1>",Name(PlanetToStar(IdToPlanet(gov_planet))),"<2>",Name(IdToPlanet(gov_planet))));
        }
      }
    }
    if(message_from_gov && !gov_talk) {
      if(change_loc) {
        gov_planet=0;
        counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),1,255);
        if (counter){counter=StarListToTransitPlanetList(locations,ShipStar(Player()),ShipStar(GroupToShip(Stukach)),70,150,200,100,90,75);}
        if (counter){gov_planet=Id(locations[0]);}
        if(gov_planet) {
          change_loc=0;
          alt_message=1;
          if (!NoComeKlingToStar(PlanetToStar(IdToPlanet(gov_planet)))){
          block_sys_date=CurTurn();
          NoComeKlingToStar(PlanetToStar(IdToPlanet(gov_planet)),1);}
          Ether(0,'93C643B9-6A8B-4CDE-93A5-13CB26BB5A0B',Format(CT("Script.PC_part2.148"),"<0>",Name(IdToPlanet(gov_planet)),"<1>",Name(PlanetToStar(IdToPlanet(gov_planet)))));
        }
      }
      if(!change_loc) {
        if(PlanetOwner(IdToPlanet(gov_planet))<Kling) {
          if(!ShipInNormalSpace(Player())) {
            if(!alt_message) {
              Ether(0,'ED99C452-1542-41D4-9911-9E66254B1955',Format(CT("Script.PC_part2.149"),"<0>",ShipName(Player()),"<1>",Name(PlanetToStar(IdToPlanet(gov_planet))),"<2>",Name(IdToPlanet(gov_planet))));
            }
            if(alt_message) {
              Ether(0,'93C643B9-6A8B-4CDE-93A5-13CB26BB5A0B',Format(CT("Script.PC_part2.148"),"<0>",Name(IdToPlanet(gov_planet)),"<1>",Name(PlanetToStar(IdToPlanet(gov_planet)))));
            }
          }
        }
        if(PlanetOwner(IdToPlanet(gov_planet))>=Kling) {
          Ether(0,'176203FF-F4FA-403C-ACA1-BF920BAE330D',Format(CT("Script.PC_part2.147"),"<0>",Name(PlanetToStar(IdToPlanet(gov_planet)))));
          change_loc=1;
          gov_planet=0;
        }
      }
    }
  }
  if(block_sys_date) {
    if((block_sys_date+30)<CurTurn()) {
      block_sys_date=0;
      NoComeKlingToStar(PlanetToStar(IdToPlanet(gov_planet)),0);
    }
  }
  if(!rewardSeed) rewardSeed=Rnd(0,2000000000);
>>>
DialogBegin=<<<
  if(GetShipRuins(Player())>0) {
    if(ShipType(GetShipRuins(Player()))=='PB') {
      if(GetShipPirateRank(Player())==1) {
        if(ShipPirateRankPoints(Player())<ShipNextPirateRankPoints(Player())) {
          AddDialogInject('DialogPB1','',CT("Script.PC_part2.113"),1);
        }
        if(ShipPirateRankPoints(Player())>=ShipNextPirateRankPoints(Player())) {
          if(!quest_complete) {
            if(quest_started && !quest_taken) {
              AddDialogOverride('DialogPB3',10);
            }
            if(!quest_started && !CoalitionDefeated()) {
              counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),20,60);
              if(!counter) {
                AddDialogInject('DialogPB2','',CT("Script.PC_part2.112"),1);
              }
              if(counter) {
                counter=StarListToPlanetList(locations,150,200,100,90,75,visited_locations,50);
                if(!counter) {
                  AddDialogInject('DialogPB2','',CT("Script.PC_part2.112"),1);
                }
                if(counter) {
                  quest_planet=locations[0];
                  quest_star=PlanetToStar(quest_planet);
                  quest_ship=BuyPirate(quest_planet);
                  stukach_id=Id(quest_ship);
                  stukach_race=ShipPilotRace(quest_ship);
                  stukach_face=Rnd(1,10);
                  ShipFace(quest_ship,stukach_face);
                  stukach_name=ShipName(quest_ship);
                  stukach_fullname=Name(quest_ship);
                  ShipJoin(Stukach,quest_ship);
                  NoTargetToShip(quest_ship,2);
                  quest_item=CreateQuestItem('Usl_CapsuleStukach');
                  LinkItemToScript(quest_item,Stukach_Capsule);
                  ShipAddDropItem(quest_ship,quest_item);
                  AddDialogOverride('DialogPB3',10);
                  GotoGov(1);
                  quest_planet=Id(quest_planet);
                  quest_star=Id(quest_star);
                  ArrayAdd(visited_locations,quest_star);
                  quest_started=1;
                  Ether(3,'573DD065-E77D-4FFB-A280-ACC0019873CD',Format(CT("Script.PC_part2.152"),"<0>",stukach_fullname));
                }
              }
            }
            if(stukach_killed_date) {
              if(ItemIn(Stukach_Capsule,Player())) {
                AddDialogOverride('DialogPB4',10);
                GotoGov(1);
                if(!completion_type) {
                  Ether(4,'573DD065-E77D-4FFB-A280-ACC0019873CD',Format(CT("Script.PC_part2.150"),"<0>",stukach_fullname));
                }
              }
              if(!ItemExist(Stukach_Capsule)) {
                AddDialogOverride('DialogPB4',10);
                GotoGov(1);
                if(!completion_type) {
                  Ether(4,'573DD065-E77D-4FFB-A280-ACC0019873CD',Format(CT("Script.PC_part2.150"),"<0>",stukach_fullname));
                }
                if(stukach_picked) {
                  Ether(4,'17947350-25C4-4E2D-89FD-A24BD0BEE7C1',CT("Script.PC_part2.114"));
                }
              }
            }
          }
          if(CoalitionDefeated() && !quest_started) {
            money_for_rank=4000;
            AddDialogInject('DialogPB6','',CT("Script.PC_part2.112"),1);
          }
        }
      }
    }
  }
  if(GetShipPlanet(Player())>0) {
    if(quest_started) {
      if(GroupCount(Stukach)) {
        if(Id(GetShipPlanet(Player()))==gov_planet) {
          if(!gov_talk) {
            AddDialogOverride('DialogPlanet2',10);
          }
        }
      }
    }
    if(ItemIn(Stukach_Capsule,Player())) {
      if(PlanetOwner(GetShipPlanet(Player()))<Kling) {
        AddDialogOverride('DialogPlanet',10);
      }
    }
  }
>>>
States <{
    StateNew <{
        Type=None
        Attack <{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            if(GroupCount(Stukach)==0) {
              if(!stukach_talk) {
                if(ItemIn(Stukach_Capsule,ShipStar(Player()))) {
                  if(ShipInNormalSpace(Player())) {
                    if(Dist(Stukach_Capsule,Player())<1000) {
                      if(!CoalitionDefeated()) {
                        temp_planet=FindPlanet(ShipStar(Player()),'NotMaloc,NotPeleng,NotPeople,NotFei,NotGaal,NotPirateClan',0,100);
                        if (!temp_planet){temp_planet=StarPlanets(ShipStar(Player()),0);}
                        planet_owner=PlanetRace(temp_planet,stukach_race);
                        quest_ship=BuyPirate(temp_planet);
                        PlanetRace(temp_planet,planet_owner);
                        ShipFace(quest_ship,stukach_face);
                        SetName(quest_ship,stukach_name);
                        itemlocx=CoordX(Stukach_Capsule);
                        itemlocy=CoordY(Stukach_Capsule);
                        ShipSetCoords(quest_ship,itemlocx,itemlocy);
                        ShipJoin(Dummy,quest_ship);
                      }
                    }
                  }
                }
              }
            }
        >>>
    }
    StateStukach <{
        Type=Free
        Attack <{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            if(ShipGetBad(CurShip)==Player()) {
              player_kills_stukach=1;
            }
            if(ShipGetBad(CurShip)!=Player()) {
              player_kills_stukach=0;
            }
        >>>
    }
    StateNone <{
        Type=None
        Attack <{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            if(!stukach_talk) {
              Dialog(DialogStukach,CurShip);
              ShipDestroy(CurShip);
            }
        >>>
    }
}
Dialogs <{
    DialogPB3 <{
        Code=<<<
            GotoGov(2);
            DChange(0);
            exit;
        >>>
    }
    DialogPB1 <{
        Code=<<<
            points='<clrEnd>'+CT('FormRuins.PB.RankPoints.RankPoints');
            DChange(1);
            exit;
        >>>
    }
    DialogPB2 <{
        Code=<<<
            counter=1;
            counter2=0;
            syst_dom=0;
            syst_pir=0;
            cycle_flag=1;
            while (cycle_flag){
            if (SectorVisible(StarToCon(StarNearbyStars(StarNew,counter)))){
            counter2=counter2+1;
            if (StarOwner(StarNearbyStars(StarNew,counter))==1){syst_dom=syst_dom+1;}
            if (StarOwner(StarNearbyStars(StarNew,counter))==2){syst_pir=syst_pir+1;}}
            counter=counter+1;
            if (counter==GalaxyStars()){cycle_flag=0;}
            if (counter2==20){cycle_flag=0;}
            }
            if(syst_pir<syst_dom) {
              DChange(2);
              exit;
            }
            if(syst_pir>=syst_dom) {
              DChange(24);
              exit;
            }
        >>>
    }
    DialogPlanet <{
        Code=<<<
            stukach_resqued=1;
            FreeItem(GetItemFromShip(Player(),FindItemInShip(Player(),Stukach_Capsule)));
            item_type=Rnd(0,1000)%ArrayDim(reward_eq_size);
            bonus_name=gov_mod[item_type];
            bonus_name=bonus_name+' I';
            if (GalaxyTechLevel()>2){bonus_name=bonus_name+'I';}
            if (GalaxyTechLevel()>4){bonus_name=bonus_name+'I';}
            if (FindBonusByName(bonus_name)>-1){
            quest_item=CreateEquipmentWithSpecial(
              FindBonusByName(bonus_name),
              reward_eq_size[item_type],
              GalaxyTechLevel(),
              PlanetOwner(GetShipPlanet(Player())));
            } else quest_item=CreateEquipment(Rnd(t_FuelTanks,t_DefGenerator),20,GalaxyTechLevel(),ShipOwner(Player()));
            reward_item=DeleteTags(ItemFullName(quest_item));
            AddItemToShip(Player(),quest_item);
            if (ArrayDim(reward_eq_size)>1){
            ArrayDelete(reward_eq_size,item_type);
            ArrayDelete(pirate_mod,item_type);
            ArrayDelete(gov_mod,item_type);}
            agent_counter=agent_counter+1;
            Ether(4,'17947350-25C4-4E2D-89FD-A24BD0BEE7C1',CT("Script.PC_part2.114"));
            DChange(3);
            exit;
        >>>
    }
    DialogPB4 <{
        Code=<<<
            GotoGov(2);
            if(!completion_type) {
              if(!ItemExist(Stukach_Capsule)) {
                if(stukach_resqued) {
                  completion_type=3;
                }
                if(!stukach_resqued) {
                  completion_type=2;
                  item_type=Rnd(0,1000)%ArrayDim(reward_eq_size);
                  bonus_name=pirate_mod[item_type];
                  bonus_name=bonus_name+' I';
                  if (GalaxyTechLevel()>2){bonus_name=bonus_name+'I';}
                  if (GalaxyTechLevel()>4){bonus_name=bonus_name+'I';}
                  if (FindBonusByName(bonus_name)>-1){
                  quest_item=CreateEquipmentWithSpecial(
                    FindBonusByName(bonus_name),
                    reward_eq_size[item_type],
                    GalaxyTechLevel(),
                    ShipOwner(GetShipRuins(Player())));
                  } else quest_item=CreateEquipment(Rnd(t_FuelTanks,t_DefGenerator),20,GalaxyTechLevel(),ShipOwner(Player()));
                  reward_item=DeleteTags(ItemFullName(quest_item));
                  if (ArrayDim(reward_eq_size)>1){
                  ArrayDelete(reward_eq_size,item_type);
                  ArrayDelete(pirate_mod,item_type);
                  ArrayDelete(gov_mod,item_type);}
                  AddItemToShip(Player(),quest_item);
                }
              }
              if(ItemExist(Stukach_Capsule)) {
                item_type=Rnd(0,1000)%ArrayDim(reward_eq_size);
                bonus_name=pirate_mod[item_type];
                bonus_name=bonus_name+' I';
                if (GalaxyTechLevel()>2){bonus_name=bonus_name+'I';}
                if (GalaxyTechLevel()>4){bonus_name=bonus_name+'I';}
                if (FindBonusByName(bonus_name)>-1){
                quest_item=CreateEquipmentWithSpecial(
                  FindBonusByName(bonus_name),
                  reward_eq_size[item_type],
                  GalaxyTechLevel(),
                  ShipOwner(GetShipRuins(Player())));
                } else quest_item=CreateEquipment(Rnd(t_FuelTanks,t_DefGenerator),20,GalaxyTechLevel(),ShipOwner(Player()));
                reward_item=DeleteTags(ItemFullName(quest_item));
                if (ArrayDim(reward_eq_size)>1){
                ArrayDelete(reward_eq_size,item_type);
                ArrayDelete(pirate_mod,item_type);
                ArrayDelete(gov_mod,item_type);}
                AddItemToShip(Player(),quest_item);
                completion_type=1;
                FreeItem(GetItemFromShip(Player(),FindItemInShip(Player(),Stukach_Capsule)));
                Ether(4,'17947350-25C4-4E2D-89FD-A24BD0BEE7C1',CT("Script.PC_part2.114"));
              }
            }
            if(completion_type) {
              BuildListOfMMByPriority(rewards,40,69);
              ArrayRandomize(50,rewards,rewardSeed);
              rewards_text[0]='</color>'+BonusText(rewards[0])+'<color=0,0,0>';
              rewards_text[1]='</color>'+BonusText(rewards[1])+'<color=0,0,0>';
              rewards_text[2]='</color>'+BonusText(rewards[2])+'<color=0,0,0>';
              if(completion_type==3) {
                DChange(4);
                exit;
              }
              if(completion_type==2) {
                DChange(6);
                exit;
              }
              if(completion_type==1) {
                DChange(5);
                exit;
              }
            }
        >>>
    }
    DialogStukach <{
        Code=<<<
            stukach_talk=1;
            counter=GalaxyEvents()-1;
            while (counter>=0){
            if (GalaxyEventType(counter)=='PlayerKillsShip'){
            if (GalaxyEventData(counter,2)==stukach_id){
            player_kills_stukach=1;}}
            if (GalaxyEventType(counter)=='PlayerAssistKillsShip'){
            if (GalaxyEventData(counter,2)==stukach_id){
            player_kills_stukach=1;}}
            if (GalaxyEventType(counter)=='PlayerCompanionKillsShip'){
            if (GalaxyEventData(counter,2)==stukach_id){
            player_kills_stukach=1;}}
            if (GalaxyEventType(counter)=='PlayerCompanionAssistKillsShip'){
            if (GalaxyEventData(counter,2)==stukach_id){
            player_kills_stukach=1;}}
            if (GalaxyEventDate(counter)<CurTurn()-2){counter=0;}
            counter=counter-1;}
            if(!player_kills_stukach) {
              DChange(25);
              exit;
            }
            if(player_kills_stukach) {
              DChange(7);
              exit;
            }
        >>>
    }
    DialogPlanet2 <{
        Code=<<<
            DChange(19);
            exit;
        >>>
    }
    DialogPB6 <{
        Code=<<<
            DChange(26);
            exit;
        >>>
    }
}
DialogMsgs <{
    0 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.169"),"<0>",ShipName(Player()),"<1>",ShipName(Player()),"<2>",ShipName(Player()),"<3>",Name(GroupToShip(Stukach)),"<4>",Name(ShipStar(GroupToShip(Stukach)))));    DAdd(3);
            DAdd(4);

        >>>
    }
    1 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.172"),"<0>",ShipNextPirateRankPoints(Player()),"<1>",ShipPirateRankPoints(Player()),"<2>",points));    DAdd(30);

        >>>
    }
    2 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.161"));    DAdd(30);

        >>>
    }
    3 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.118"),"<0>",reward_item));    DAdd(31);

        >>>
    }
    4 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.153"),"<0>",BonusName(rewards[0]),"<1>",rewards_text[0],"<2>",BonusName(rewards[1]),"<3>",rewards_text[1],"<4>",BonusName(rewards[2]),"<5>",rewards_text[2]));    DAdd(18);
            DAdd(19);
            DAdd(20);

        >>>
    }
    5 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.154"),"<0>",ShipName(Player()),"<1>",ShipName(Player()),"<2>",reward_item,"<3>",BonusName(rewards[0]),"<4>",rewards_text[0],"<5>",BonusName(rewards[1]),"<6>",rewards_text[1],"<7>",BonusName(rewards[2]),"<8>",rewards_text[2]));    DAdd(21);
            DAdd(22);
            DAdd(23);

        >>>
    }
    6 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.155"),"<0>",reward_item,"<1>",BonusName(rewards[0]),"<2>",rewards_text[0],"<3>",BonusName(rewards[1]),"<4>",rewards_text[1],"<5>",BonusName(rewards[2]),"<6>",rewards_text[2]));    DAdd(18);
            DAdd(19);
            DAdd(20);

        >>>
    }
    7 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.61"));    DAdd(6);

        >>>
    }
    8 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.141"));    DAdd(5);

        >>>
    }
    9 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.56"));    DAdd(2);

        >>>
    }
    10 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.57"));    DAdd(2);

        >>>
    }
    11 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.144"));    DAdd(7);

        >>>
    }
    12 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.122"));    DAdd(8);
            DAdd(11);

        >>>
    }
    13 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.64"),"<0>",money_offer));    DAdd(9);
            DAdd(10);

        >>>
    }
    14 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.65"));    DAdd(12);
            DAdd(13);

        >>>
    }
    15 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.66"));    DAdd(14);
            DAdd(15);

        >>>
    }
    16 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.67"),"<0>",ShipName(Player())));    DAdd(16);
            DAdd(17);

        >>>
    }
    17 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.85"));    DAdd(24);

        >>>
    }
    18 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.86"),"<0>",ShipName(Player())));    DAdd(1);

        >>>
    }
    19 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.173"),"<0>",ShipName(Player())));    DAdd(25);

        >>>
    }
    20 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.124"));    DAdd(26);
            DAdd(27);

        >>>
    }
    21 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.97"));    DAdd(28);

        >>>
    }
    22 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.142"),"<0>",Name(GroupToShip(Stukach))));    DAdd(29);

        >>>
    }
    23 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.143"));    DAdd(0);

        >>>
    }
    24 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.126"));    DAdd(30);

        >>>
    }
    25 <{
        Name=
        Code=<<<
            DText(CT("Script.PC_part2.171"));    DAdd(6);

        >>>
    }
    26 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.167"),"<0>",ShipName(Player()),"<1>",money_for_rank));    if(ShipMoney(Player())>=money_for_rank) {
              DAdd(32);
            }
            DAdd(33);

        >>>
    }
    27 <{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_part2.163"),"<0>",ShipName(Player())));    DAdd(34);

        >>>
    }
}
DialogAnswers <{
    0 <{
        Command=planet
        Answer=DAnswer('planet~'+CT("Script.PC_part2.127"));
        Code=
    }
    1 <{
        Command=restart
        Answer=DAnswer('restart~'+CT("Script.PC_part2.99"));
        Code=
    }
    2 <{
        Command=restart
        Answer=DAnswer('restart~'+CT("Script.PC_part2.107"));
        Code=<<<
            quest_taken=1;
            GotoGov(0);
        >>>
    }
    3 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.58"));
        Code=<<<
            DChange(9);
            exit;
        >>>
    }
    4 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.59"));
        Code=<<<
            DChange(8);
            exit;
        >>>
    }
    5 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.60"));
        Code=<<<
            DChange(10);
            exit;
        >>>
    }
    6 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.68"));
        Code=<<<
            DChange(11);
            exit;
        >>>
    }
    7 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.69"));
        Code=<<<
            money_offer=GalaxyMoney(3);
            DChange(12);
            exit;
        >>>
    }
    8 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.70"));
        Code=<<<
            DChange(13);
            exit;
        >>>
    }
    9 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.71"));
        Code=<<<
            ShipMoney(Player(),ShipMoney(Player())+money_offer);
            Sound('Sound.Buy');
            DChange(16);
            exit;
        >>>
    }
    10 <{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_part2.72"));
        Code=
    }
    11 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.73"));
        Code=<<<
            DChange(14);
            exit;
        >>>
    }
    12 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.74"));
        Code=<<<
            DChange(15);
            exit;
        >>>
    }
    13 <{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_part2.145"));
        Code=
    }
    14 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.76"));
        Code=<<<
            DChange(16);
            exit;
        >>>
    }
    15 <{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_part2.77"));
        Code=
    }
    16 <{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_part2.78"));
        Code=
    }
    17 <{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_part2.79"));
        Code=
    }
    18 <{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_part2.87"),"<0>",BonusName(rewards[0])));
        Code=<<<
            AddItemToShip(Player(),CreateMM(rewards[0]));
            while (GetShipPirateRank(Player())<2){RaisePirateRank(Player());}
            reward_received=1;
            quest_complete;
            GotoGov(0);
            ShipOut(Player());
            if (block_sys_date){block_sys_date=0;
            NoComeKlingToStar(PlanetToStar(IdToPlanet(gov_planet)),0);}
            DChange(17);
            exit;
        >>>
    }
    19 <{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_part2.87"),"<0>",BonusName(rewards[1])));
        Code=<<<
            AddItemToShip(Player(),CreateMM(rewards[1]));
            while (GetShipPirateRank(Player())<2){RaisePirateRank(Player());}
            reward_received=1;
            quest_complete;
            GotoGov(0);
            ShipOut(Player());
            if (block_sys_date){block_sys_date=0;
            NoComeKlingToStar(PlanetToStar(IdToPlanet(gov_planet)),0);}
            DChange(17);
            exit;
        >>>
    }
    20 <{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_part2.87"),"<0>",BonusName(rewards[2])));
        Code=<<<
            AddItemToShip(Player(),CreateMM(rewards[2]));
            while (GetShipPirateRank(Player())<2){RaisePirateRank(Player());}
            reward_received=1;
            quest_complete;
            GotoGov(0);
            ShipOut(Player());
            if (block_sys_date){block_sys_date=0;
            NoComeKlingToStar(PlanetToStar(IdToPlanet(gov_planet)),0);}
            DChange(17);
            exit;
        >>>
    }
    21 <{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_part2.87"),"<0>",BonusName(rewards[0])));
        Code=<<<
            AddItemToShip(Player(),CreateMM(rewards[0]));
            while (GetShipPirateRank(Player())<2){RaisePirateRank(Player());}
            reward_received=1;
            quest_complete;
            GotoGov(0);
            ShipOut(Player());
            if (block_sys_date){block_sys_date=0;
            NoComeKlingToStar(PlanetToStar(IdToPlanet(gov_planet)),0);}
            DChange(18);
            exit;
        >>>
    }
    22 <{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_part2.87"),"<0>",BonusName(rewards[1])));
        Code=<<<
            AddItemToShip(Player(),CreateMM(rewards[1]));
            while (GetShipPirateRank(Player())<2){RaisePirateRank(Player());}
            reward_received=1;
            quest_complete;
            GotoGov(0);
            ShipOut(Player());
            if (block_sys_date){block_sys_date=0;
            NoComeKlingToStar(PlanetToStar(IdToPlanet(gov_planet)),0);}
            DChange(18);
            exit;
        >>>
    }
    23 <{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_part2.87"),"<0>",BonusName(rewards[2])));
        Code=<<<
            AddItemToShip(Player(),CreateMM(rewards[2]));
            while (GetShipPirateRank(Player())<2){RaisePirateRank(Player());}
            reward_received=1;
            quest_complete;
            GotoGov(0);
            ShipOut(Player());
            if (block_sys_date){block_sys_date=0;
            NoComeKlingToStar(PlanetToStar(IdToPlanet(gov_planet)),0);}
            DChange(18);
            exit;
        >>>
    }
    24 <{
        Command=restart
        Answer=DAnswer('restart~'+CT("Script.PC_part2.100"));
        Code=
    }
    25 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.101"));
        Code=<<<
            DChange(20);
            exit;
        >>>
    }
    26 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.102"));
        Code=<<<
            gov_talk=1;
            if (block_sys_date){block_sys_date=0;
            NoComeKlingToStar(ShipStar(Player()),0);}
            DChange(21);
            exit;
        >>>
    }
    27 <{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_part2.103"),"<0>",Name(GroupToShip(Stukach))));
        Code=<<<
            gov_talk=1;
            if (block_sys_date){block_sys_date=0;
            NoComeKlingToStar(ShipStar(Player()),0);}
            DChange(22);
            exit;
        >>>
    }
    28 <{
        Command=planet
        Answer=DAnswer('planet~'+CT("Script.PC_part2.104"));
        Code=
    }
    29 <{
        Command=planet
        Answer=DAnswer('planet~'+CT("Script.PC_part2.105"));
        Code=
    }
    30 <{
        Command=restart
        Answer=DAnswer('restart~'+CT("Script.PC_part2.106"));
        Code=
    }
    31 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.128"));
        Code=<<<
            DChange(23);
            exit;
        >>>
    }
    32 <{
        Command=
        Answer=DAnswer(CT("Script.PC_part2.164"));
        Code=<<<
            while (GetShipPirateRank(Player())<2){RaisePirateRank(Player());}
            ShipMoney(Player(),ShipMoney(Player())-money_for_rank);
            Sound('Sound.Buy');
            ShipOut(Player());
            DChange(27);
            exit;
        >>>
    }
    33 <{
        Command=restart
        Answer=DAnswer('restart~'+CT("Script.PC_part2.165"));
        Code=
    }
    34 <{
        Command=restart
        Answer=DAnswer('restart~'+CT("Script.PC_part2.166"));
        Code=
    }
}
