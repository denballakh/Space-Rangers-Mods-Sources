Version=7
GlobalVars ~{
}
GlobalCode=<<<
  GRun();
>>>
LocalVars ~{
    quest_ship ~{
        Type=Dword
        Value=0
    }
    quest_item ~{
        Type=Dword
        Value=0
    }
    counter ~{
        Type=Integer
        Value=0
    }
    bonus_mm ~{
        Type=Unknown
        Value=None
    }
    fem_names ~{
        Type=Unknown
        Value=None
    }
    name_used ~{
        Type=Integer
        Value=0
    }
    counter2 ~{
        Type=Integer
        Value=0
    }
    hull_names ~{
        Type=Unknown
        Value=None
    }
    quest_planet ~{
        Type=Dword
        Value=0
    }
    quest_star ~{
        Type=Dword
        Value=0
    }
    item_names ~{
        Type=Unknown
        Value=None
    }
    quest_data1 ~{
        Type=Unknown
        Value=None
    }
    quest_data2 ~{
        Type=Unknown
        Value=None
    }
    trust_value ~{
        Type=Unknown
        Value=None
    }
    fem_id ~{
        Type=Unknown
        Value=None
    }
    max_num ~{
        Type=Integer
        Value=0
    }
    cur_num ~{
        Type=Integer
        Value=0
    }
    player_hate ~{
        Type=Integer
        Value=0
    }
    ship_to_guard ~{
        Type=Dword
        Value=0
    }
    ship_under_prot ~{
        Type=Integer
        Value=0
    }
    ship_num ~{
        Type=Integer
        Value=0
    }
    ship_is_enemy ~{
        Type=Integer
        Value=0
    }
    enemy_id ~{
        Type=Unknown
        Value=None
    }
    player_helps ~{
        Type=Dword
        Value=0
    }
    temp_curship ~{
        Type=Dword
        Value=0
    }
    new_enemies ~{
        Type=Unknown
        Value=None
    }
    player_is_enemy ~{
        Type=Integer
        Value=0
    }
    switch_state ~{
        Type=Integer
        Value=0
    }
    bonus_arts ~{
        Type=Unknown
        Value=None
    }
    roll ~{
        Type=Integer
        Value=0
    }
    locations ~{
        Type=Unknown
        Value=None
    }
    safety_dist ~{
        Type=Integer
        Value=0
    }
    prev_dist ~{
        Type=Integer
        Value=0
    }
    cycle_flag ~{
        Type=Integer
        Value=0
    }
    last_turn_check ~{
        Type=Integer
        Value=0
    }
    prev_dist2 ~{
        Type=Integer
        Value=0
    }
    max_relation ~{
        Type=Integer
        Value=100
    }
    player_robs ~{
        Type=Dword
        Value=0
    }
    player_transport_kills ~{
        Type=Dword
        Value=0
    }
    player_pirate_kills ~{
        Type=Dword
        Value=0
    }
    player_warrior_kills ~{
        Type=Dword
        Value=0
    }
    player_ranger_kills ~{
        Type=Dword
        Value=0
    }
    relation_shift ~{
        Type=Integer
        Value=0
    }
    cur_relation ~{
        Type=Integer
        Value=0
    }
    cur_relation_type ~{
        Type=Integer
        Value=0
    }
    req_complete ~{
        Type=Integer
        Value=0
    }
    reward_item ~{
        Type=String
        Value=
    }
    quest_status ~{
        Type=Integer
        Value=0
    }
    money_truce ~{
        Type=Dword
        Value=0
    }
    second_try ~{
        Type=Integer
        Value=0
    }
    planet_list2 ~{
        Type=Unknown
        Value=None
    }
    planet_list ~{
        Type=Unknown
        Value=None
    }
    min_dist ~{
        Type=Dword
        Value=0
    }
    cur_dist ~{
        Type=Dword
        Value=0
    }
    req_dist ~{
        Type=Dword
        Value=0
    }
    counter3 ~{
        Type=Integer
        Value=0
    }
    temp_planet ~{
        Type=Dword
        Value=0
    }
    best_dist ~{
        Type=Integer
        Value=0
    }
    num_planets ~{
        Type=Integer
        Value=8
    }
    planet_list_created ~{
        Type=Integer
        Value=0
    }
    beacon_quest_deadline ~{
        Type=Integer
        Value=0
    }
    beacon_quest_duration ~{
        Type=Integer
        Value=0
    }
    planet_statuses ~{
        Type=Unknown
        Value=None
    }
    mission_briefing ~{
        Type=Integer
        Value=0
    }
    planet_num ~{
        Type=Integer
        Value=0
    }
    beacons_placed ~{
        Type=Integer
        Value=0
    }
    pirate_side_chosen ~{
        Type=Integer
        Value=0
    }
    gov_reward1 ~{
        Type=Integer
        Value=0
    }
    gov_planet ~{
        Type=Dword
        Value=0
    }
    gov_message1 ~{
        Type=Integer
        Value=0
    }
    obj_to_run ~{
        Type=Dword
        Value=0
    }
    turns_to_run ~{
        Type=Integer
        Value=0
    }
    quest_star2 ~{
        Type=Dword
        Value=0
    }
    observe_days ~{
        Type=Integer
        Value=100
    }
    observe_start ~{
        Type=Integer
        Value=0
    }
    last_star ~{
        Type=Integer
        Value=0
    }
    diplo_annoy ~{
        Type=Integer
        Value=0
    }
    turns_near_player ~{
        Type=Integer
        Value=0
    }
    visited_stars_list ~{
        Type=Unknown
        Value=None
    }
    visited_planets_list ~{
        Type=Unknown
        Value=None
    }
    nearby_stars_list ~{
        Type=Unknown
        Value=None
    }
    nearby_ships_list ~{
        Type=Unknown
        Value=None
    }
    last_turn_in_space ~{
        Type=Integer
        Value=0
    }
    array_index ~{
        Type=Integer
        Value=0
    }
    last_turn_diplo ~{
        Type=Integer
        Value=0
    }
    turns_without_player ~{
        Type=Integer
        Value=0
    }
    second_mission_refused ~{
        Type=Integer
        Value=0
    }
    diplo_id ~{
        Type=Integer
        Value=0
    }
    player_kills_diplo ~{
        Type=Integer
        Value=0
    }
    diplo_try ~{
        Type=Integer
        Value=0
    }
    suspicious_ship_name ~{
        Type=String
        Value=
    }
    suspicious_ships_list ~{
        Type=Unknown
        Value=None
    }
    suspicious_ship_id ~{
        Type=Integer
        Value=0
    }
    cur_talk_ship ~{
        Type=Dword
        Value=0
    }
    gov_message2 ~{
        Type=Integer
        Value=0
    }
    turns_under_surv ~{
        Type=Integer
        Value=0
    }
    diplo_name ~{
        Type=String
        Value=
    }
    report_stars ~{
        Type=Unknown
        Value=None
    }
    num_page ~{
        Type=Integer
        Value=0
    }
    chosen_num ~{
        Type=Integer
        Value=0
    }
    report_failed ~{
        Type=Integer
        Value=0
    }
    report_planet1 ~{
        Type=Integer
        Value=0
    }
    report_planet_count1 ~{
        Type=Integer
        Value=0
    }
    report_planet2 ~{
        Type=Integer
        Value=0
    }
    report_planet_count2 ~{
        Type=Integer
        Value=0
    }
    susp_ship_report_name ~{
        Type=String
        Value=
    }
    investigation_start_date ~{
        Type=Integer
        Value=0
    }
    gov_message3 ~{
        Type=Integer
        Value=0
    }
    invite_for_third_mission ~{
        Type=Integer
        Value=0
    }
    planet_supply ~{
        Type=Dword
        Value=0
    }
    last_start ~{
        Type=Integer
        Value=0
    }
    third_mission_refused ~{
        Type=Integer
        Value=0
    }
    star_dest ~{
        Type=Dword
        Value=0
    }
    supply_annoy ~{
        Type=Integer
        Value=0
    }
    center_warning ~{
        Type=Integer
        Value=0
    }
    quest_hole ~{
        Type=Dword
        Value=0
    }
    hole_id ~{
        Type=Dword
        Value=0
    }
    hole_create_turn ~{
        Type=Integer
        Value=0
    }
    star_prev ~{
        Type=Integer
        Value=0
    }
    player_intruder ~{
        Type=Integer
        Value=0
    }
    ab_starts ~{
        Type=Integer
        Value=0
    }
    gov_message4 ~{
        Type=Integer
        Value=0
    }
    gov_reward2 ~{
        Type=Integer
        Value=0
    }
    planet_owner ~{
        Type=Integer
        Value=0
    }
    planet_race ~{
        Type=Integer
        Value=0
    }
    BK_enters_BH ~{
        Type=Integer
        Value=0
    }
    supply_system ~{
        Type=Dword
        Value=0
    }
    supply_system_value ~{
        Type=Integer
        Value=0
    }
    supply_system_value2 ~{
        Type=Integer
        Value=0
    }
    att_bonus ~{
        Type=Dword
        Value=300
    }
    def_bonus ~{
        Type=Dword
        Value=300
    }
    mov_bonus ~{
        Type=Dword
        Value=300
    }
    last_turn_adjust ~{
        Type=Dword
        Value=0
    }
    sum_bonus ~{
        Type=Dword
        Value=0
    }
    points_a ~{
        Type=Unknown
        Value=None
    }
    points_d ~{
        Type=Unknown
        Value=None
    }
    points_m ~{
        Type=Unknown
        Value=None
    }
    points_bonus ~{
        Type=Unknown
        Value=None
    }
    nearest_bonus ~{
        Type=Integer
        Value=0
    }
    nearest_bonus_distance ~{
        Type=Integer
        Value=0
    }
    cur_point_distance ~{
        Type=Integer
        Value=0
    }
    last_bonus ~{
        Type=Integer
        Value=-1
    }
    shu_state ~{
        Type=Integer
        Value=0
    }
    mode_name ~{
        Type=Unknown
        Value=None
    }
    truce_flag ~{
        Type=Integer
        Value=0
    }
    ether_id ~{
        Type=String
        Value=
    }
    shu_id ~{
        Type=Dword
        Value=0
    }
    player_kills_shu ~{
        Type=Integer
        Value=0
    }
    goods_type ~{
        Type=Integer
        Value=7
    }
    bon ~{
        Type=Integer
        Value=0
    }
    StarNew ~{
        Type=Dword
        Value=0
    }
    PlanetNew ~{
        Type=Dword
        Value=0
    }
    BeaconContainer ~{
        Type=Dword
        Value=0
    }
    HybridDroid ~{
        Type=Dword
        Value=0
    }
    GroupNew ~{
        Type=Dword
        Value=0
    }
    GroupFem ~{
        Type=Dword
        Value=1
    }
    GroupTransports ~{
        Type=Dword
        Value=2
    }
    GroupEnemies ~{
        Type=Dword
        Value=3
    }
    GroupDiplo ~{
        Type=Dword
        Value=4
    }
    GroupSupply ~{
        Type=Dword
        Value=5
    }
    GroupShuCenter ~{
        Type=Dword
        Value=6
    }
    GroupOriginalShu ~{
        Type=Dword
        Value=7
    }
    DialogHate ~{
        Type=Dword
        Value=0
    }
    DialogMission ~{
        Type=Dword
        Value=1
    }
    DialogPB ~{
        Type=Dword
        Value=2
    }
    DialogPlanet1 ~{
        Type=Dword
        Value=3
    }
    DialogSecondTry ~{
        Type=Dword
        Value=4
    }
    DialogPartnershipBreak ~{
        Type=Dword
        Value=5
    }
    DialogNextMission ~{
        Type=Dword
        Value=6
    }
    DialogDiploSuspects ~{
        Type=Dword
        Value=7
    }
    DialogDiploAngry ~{
        Type=Dword
        Value=8
    }
    DialogPlanetRepeat ~{
        Type=Dword
        Value=9
    }
    DialogPlanetSuccess ~{
        Type=Dword
        Value=10
    }
    DialogPlanetFail ~{
        Type=Dword
        Value=11
    }
    DialogSuccess2 ~{
        Type=Dword
        Value=12
    }
    DialogReport ~{
        Type=Dword
        Value=13
    }
    DialogWarningSupply ~{
        Type=Dword
        Value=14
    }
    DialogSupply ~{
        Type=Dword
        Value=15
    }
    DialogCenterWarning ~{
        Type=Dword
        Value=16
    }
    DialogShu ~{
        Type=Dword
        Value=17
    }
    DialogStoryComplete ~{
        Type=Dword
        Value=18
    }
}
Constellations=0
Stars ~{
    StarNew ~{
        Constellation=-1
        NoKling=False
        NoComeKling=False
        StarLinks ~{
        }
        Planets ~{
            PlanetNew ~{
                Race=Maloc,Peleng,People,Fei,Gaal
                Owner=Maloc,Peleng,People,Fei,Gaal
                Economy=Agriculture,Industrial,Mixed
                Government=Anarchy,Dictatorship,Monarchy,Republic,Democracy
                Range=0..100
                Dialog=
            }
        }
        Ships ~{
            0 ~{
                Count=1
                Owner=Maloc,Peleng,People,Fei,Gaal
                Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
                IsPlayer=True
                Speed=0..10000
                Weapon=Undef
                CargoHook=0
                EmptySpace=0
                Status ~{
                    Trader=0..100
                    Warrior=0..100
                    Pirate=0..100
                }
                Strength=0.0..0.0
                Ruins=
            }
        }
    }
}
Places ~{
}
Items ~{
    BeaconContainer ~{
        Place=
        Class=Unknown
        Type=0
        Size=10
        Level=1
        Radius=150
        Owner=None
        Useless=
    }
    HybridDroid ~{
        Place=
        Class=Unknown
        Type=0
        Size=10
        Level=1
        Radius=150
        Owner=None
        Useless=
    }
}
Groups ~{
    GroupNew ~{
        Planet=PlanetNew
        State=0(StateNew)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=
        Count=1..1
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=True
        Status ~{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
    GroupFem ~{
        Planet=PlanetNew
        State=1(StateCreate)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
        Count=0..0
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=False
        Status ~{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
    GroupTransports ~{
        Planet=PlanetNew
        State=4(StateFree)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
        Count=0..0
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=False
        Status ~{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
    GroupEnemies ~{
        Planet=PlanetNew
        State=5(StateFree)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
        Count=0..0
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=False
        Status ~{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
    GroupDiplo ~{
        Planet=PlanetNew
        State=11(StateFree)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
        Count=0..0
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=False
        Status ~{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
    GroupSupply ~{
        Planet=PlanetNew
        State=12(StateInit)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
        Count=0..0
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=False
        Status ~{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
    GroupShuCenter ~{
        Planet=PlanetNew
        State=15(StateWait)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
        Count=0..0
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=False
        Status ~{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
    GroupOriginalShu ~{
        Planet=PlanetNew
        State=17(StateRevenge)
        Owner=Maloc,Peleng,People,Fei,Gaal
        Type=Ranger,Warrior,Pirate,Transport,Liner,Diplomat
        Count=0..0
        Speed=100..10000
        Weapon=Undef
        CargoHook=0
        EmptySpace=0
        AddPlayer=False
        Status ~{
            Trader=0..100
            Warrior=0..100
            Pirate=0..100
        }
        SearchDist=10000
        Dialog=
        Strength=0.0..0.0
        Ruins=
    }
}
GroupLinks ~{
}
InitCode=<<<
  bonus_mm=newarray(1);
  fem_names=newarray(1);
  fem_names[0]=CT("Script.PC_fem_rangers.18");
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.17"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.16"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.15"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.14"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.13"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.12"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.11"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.10"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.9"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.8"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.7"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.6"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.5"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.4"));
  ArrayAdd(fem_names,CT("Script.PC_fem_rangers.3"));
  hull_names=newarray(8);
  hull_names[0]=CT("Script.PC_fem_rangers.2");
  hull_names[1]=hull_names[0];
  hull_names[2]=hull_names[0];
  hull_names[3]=CT("Script.PC_fem_rangers.1");
  hull_names[4]=hull_names[3];
  hull_names[5]=hull_names[3];
  hull_names[6]=CT("Script.PC_fem_rangers.0");
  hull_names[7]=hull_names[6];
  item_names=newarray(1);
  item_names[0]='Usl_RandomItem_01';
  ArrayAdd(item_names,'Usl_RandomItem_02');
  ArrayAdd(item_names,'Usl_RandomItem_03');
  ArrayAdd(item_names,'Usl_RandomItem_04');
  bonus_arts=newarray(1);
  bonus_arts[0]=t_ArtefactHull;
  ArrayAdd(bonus_arts,t_ArtefactFuel);
  ArrayAdd(bonus_arts,t_ArtefactSpeed);
  ArrayAdd(bonus_arts,t_ArtefactPower);
  ArrayAdd(bonus_arts,t_ArtefactRadar);
  ArrayAdd(bonus_arts,t_ArtefactScaner);
  ArrayAdd(bonus_arts,t_ArtefactDroid);
  ArrayAdd(bonus_arts,t_ArtefactNano);
  ArrayAdd(bonus_arts,t_ArtefactHook);
  ArrayAdd(bonus_arts,t_ArtefactDef);
  ArrayAdd(bonus_arts,t_ArtefactMiniExpl);
  ArrayAdd(bonus_arts,t_ArtefactAntigrav);
  ArrayAdd(bonus_arts,t_ArtDefToEnergy);
  ArrayAdd(bonus_arts,t_ArtEnergyPulse);
  ArrayAdd(bonus_arts,t_ArtEnergyDef);
  ArrayAdd(bonus_arts,t_ArtSplinter);
  ArrayAdd(bonus_arts,t_ArtDecelerate);
  ArrayAdd(bonus_arts,t_ArtMissileDef);
  ArrayAdd(bonus_arts,t_ArtForsage);
  ArrayAdd(bonus_arts,t_ArtWeaponToSpeed);
  ArrayAdd(bonus_arts,t_ArtGiperJump);
  ArrayAdd(bonus_arts,t_ArtDefToArms1);
  ArrayAdd(bonus_arts,t_ArtDefToArms2);
  ArrayAdd(bonus_arts,t_ArtArtefactor);
  ArrayAdd(bonus_arts,t_ArtBio);
  max_num=5;
  fem_id=newarray(max_num);
  quest_data1=newarray(max_num);
  quest_data2=newarray(max_num);
  trust_value=newarray(max_num);
  counter=0;
  while (counter<max_num){
  fem_id[counter]=0;
  quest_data1[counter]=0;
  quest_data2[counter]=0;
  trust_value[counter]=0;
  counter=counter+1;}
  enemy_id=newarray(1);
  new_enemies=newarray(1);
  locations=newarray(1);
  planet_list=newarray(20);
  planet_list2=newarray(20);
  planet_statuses=newarray(20);
>>>
TurnCode=<<<
  if(ItemIn(HybridDroid,Player())) {
    if(ItemIsInUse(HybridDroid) && !ItemIsBroken(HybridDroid)) {
      if(CurTurn()>last_turn_adjust) {
        last_turn_adjust=CurTurn();
        counter2=GalaxyEvents()-1;
        while (counter2>=0){
        if (GalaxyEventDate(counter2)>=CurTurn()){
        if (GalaxyEventType(counter2)=='PlayerKillsShip'){
        att_bonus=att_bonus+100;}
        if (GalaxyEventType(counter2)=='PlayerAssistKillsShip'){
        att_bonus=att_bonus+100;}
        }
        if (GalaxyEventDate(counter2)<CurTurn()){counter2=0;}
        counter2=counter2-1;}
        def_bonus=def_bonus+HullDamage(Player());
        mov_bonus=mov_bonus+30*PlayerQuestInProgress();
        counter=0;
        while (counter<8){
        mov_bonus=mov_bonus+GoodsCount(Player(),counter)/20;
        counter=counter+1;}
        counter=0;
        if (ShipGetBad(Player()) && ShipSpeed(Player())){
        if (ShipSpeed(ShipGetBad(Player()))>ShipSpeed(Player())){
        mov_bonus=mov_bonus+100*ShipSpeed(ShipGetBad(Player()))/ShipSpeed(Player());
        }}
        if (ShipInHyperSpace(Player())){mov_bonus=mov_bonus+30;}
        if ((att_bonus+def_bonus+mov_bonus)>1000){
        att_bonus=(99*att_bonus)/100;
        def_bonus=(99*def_bonus)/100;
        mov_bonus=(99*mov_bonus)/100;
        }
        sum_bonus=att_bonus+def_bonus+mov_bonus;
        nearest_bonus_distance=1000;
        nearest_bonus=6;
        counter=0;
        while (counter<7){
        cur_point_distance=abs(points_a[counter]-(att_bonus*100)/sum_bonus);
        cur_point_distance=cur_point_distance+abs(points_d[counter]-(def_bonus*100)/sum_bonus);
        cur_point_distance=cur_point_distance+abs(points_m[counter]-(mov_bonus*100)/sum_bonus);
        if (cur_point_distance<nearest_bonus_distance){
        nearest_bonus_distance=cur_point_distance;
        nearest_bonus=counter;}
        counter=counter+1;}
        if(nearest_bonus!=last_bonus) {
          if (FindBonusByCustomTag(points_bonus[nearest_bonus])>-1){SpecialToEquipment(FindBonusByCustomTag(points_bonus[nearest_bonus]),HybridDroid);
          att_bonus=att_bonus/2+(sum_bonus*points_a[nearest_bonus])/200;
          def_bonus=def_bonus/2+(sum_bonus*points_d[nearest_bonus])/200;
          mov_bonus=mov_bonus/2+(sum_bonus*points_m[nearest_bonus])/200;
          }
          ShipCalcParam(Player());
          last_bonus=nearest_bonus;
          Ether(2,'6E34ABFA-A3A1-4512-B35B-89DD324A99C9',Format(CT("Script.PC_fem_rangers.325"),"<0>",mode_name[nearest_bonus]));
        }
      }
    }
  }
  if(CurTurn()>last_turn_check) {
    last_turn_check=CurTurn();
    while((ArrayDim(enemy_id)-1)>GroupCount(GroupEnemies)) {
      counter=1;
      while (1){
      quest_ship=IdToShip(enemy_id[counter]);
      if (!quest_ship) break;
      if (!ShipInScript(quest_ship)) break;
      if (!ShipInCurScript(quest_ship)) break;
      if (ShipGroup(quest_ship)==GroupEnemies) break;
      counter=counter+1;
      }
      //while (IdToShip(enemy_id[counter])){counter=counter+1;}
      player_helps=0;
      counter2=GalaxyEvents()-1;
      while (counter2>=0){
      if (GalaxyEventDate(counter2)>=CurTurn()){
      if (GalaxyEventType(counter2)=='PlayerKillsShip'){
      if (GalaxyEventData(counter2,2)==enemy_id[counter]){
      player_helps=player_helps+4;}}
      if (GalaxyEventType(counter2)=='PlayerAssistKillsShip'){
      if (GalaxyEventData(counter2,2)==enemy_id[counter]){
      player_helps=player_helps+3;}}
      if (GalaxyEventType(counter2)=='PlayerCompanionKillsShip'){
      if ((GalaxyEventData(counter2,2)==enemy_id[counter]) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
      player_helps=player_helps+2;}}
      if (GalaxyEventType(counter2)=='PlayerCompanionAssistKillsShip'){
      if ((GalaxyEventData(counter2,2)==enemy_id[counter]) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
      player_helps=player_helps+1;}}
      if (GalaxyEventType(counter2)=='PlayerTranclucatorKillsShip'){
      if ((GalaxyEventData(counter2,2)==enemy_id[counter]) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
      player_helps=player_helps+2;}}
      }
      if (GalaxyEventDate(counter2)<CurTurn()){counter2=0;}
      counter2=counter2-1;}
      ArrayDelete(enemy_id,counter);
    }
    while(cur_num>GroupCount(GroupFem)) {
      counter=0;
      while (fem_id[counter] && IdToShip(fem_id[counter])){counter=counter+1;}
      counter2=GalaxyEvents()-1;
      while (counter2>=0){
      if (GalaxyEventDate(counter2)>=CurTurn()){
      if (GalaxyEventType(counter2)=='PlayerKillsShip'){
      if (GalaxyEventData(counter2,2)==fem_id[counter]){
      player_hate=1;}}
      if (GalaxyEventType(counter2)=='PlayerAssistKillsShip'){
      if (GalaxyEventData(counter2,2)==fem_id[counter]){
      player_hate=1;}}
      if (GalaxyEventType(counter2)=='PlayerCompanionKillsShip'){
      if ((GalaxyEventData(counter2,2)==fem_id[counter]) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
      player_hate=1;}}
      if (GalaxyEventType(counter2)=='PlayerCompanionAssistKillsShip'){
      if ((GalaxyEventData(counter2,2)==fem_id[counter]) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
      player_hate=1;}}
      if (GalaxyEventType(counter2)=='PlayerTranclucatorKillsShip'){
      if ((GalaxyEventData(counter2,2)==fem_id[counter]) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
      player_hate=1;}}
      }
      if (GalaxyEventDate(counter2)<CurTurn()){counter2=0;}
      counter2=counter2-1;}
      fem_id[counter]=0;
      quest_data1[counter]=0;
      quest_data2[counter]=0;
      cur_num=cur_num-1;
    }
    if((GroupCount(GroupFem)<min(max_num,1+max_num*ControlledSystems(0)/60)) && !pirate_side_chosen && !CoalitionDefeated()) {
      quest_planet=0;
      counter=0;
      while (!quest_planet && (counter<5)){
      quest_star=GalaxyStar(Rnd(1,1000)%GalaxyStars());
      quest_planet=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));
      counter=counter+1;}
      //quest_planet=StarPlanets(GalaxyStar(2),2);//;
      if(PlanetOwner(quest_planet)==2) {
        if(PlanetEco(quest_planet)==2) {
          if(quest_planet!=GetShipPlanet(Player())) {
            quest_ship=BuyRanger(quest_planet);
            bon=FindBonusByName(hull_names[GalaxyTechLevel()-1]);
            if (bon>-1){SpecialToEquipment(bon,ShipItems(quest_ship,0));}
            ShipRefit(quest_ship);
            ShipRefit(quest_ship);
            ShipRefit(quest_ship);
            counter=0;
            while (counter<ShipItems(quest_ship)){
            quest_item=ShipItems(quest_ship,counter);
            if (ItemType(quest_item)>=t_Weapon1){
            if (ItemType(quest_item)<=t_Weapon12){
            if (ItemType(quest_item)!=t_Weapon4){
            FreeItem(GetItemFromShip(quest_ship,counter));
            quest_item=CreateEquipment(t_Weapon4,10+Rnd(1,10),GalaxyTechLevel(),2);
            AddItemToShip(quest_ship,quest_item);}}}
            counter=counter+1;}
            quest_item=CreateEquipment(t_Weapon4,10+Rnd(1,10),GalaxyTechLevel(),2);
            AddItemToShip(quest_ship,quest_item);
            ShipImproveItems(quest_ship,2*GalaxyTechLevel());
            counter=Rnd(1,1000)%ArrayDim(fem_names);
            name_used=1;
            while (name_used){
            counter=counter+1;
            if (counter>=ArrayDim(fem_names)){counter=0;}
            counter2=0;
            name_used=0;
            if (ShipName(Player())==fem_names[counter]){name_used=1;}
            while ((counter2<GroupCount(GroupFem)) && !name_used){
            if (ShipName(GroupShip(GroupFem,counter2))==fem_names[counter]){name_used=1;}
            counter2=counter2+1;}}
            SetName(quest_ship,fem_names[counter]);
            counter=24+Rnd(1,1000)%8;
            name_used=1;
            while (name_used){
            counter=counter+1;
            if (counter>=33){counter=25;}
            counter2=0;
            name_used=0;
            while ((counter2<GroupCount(GroupFem)) && !name_used){
            if (ShipFace(GroupShip(GroupFem,counter2))==counter){name_used=1;}
            counter2=counter2+1;}}
            ShipFace(quest_ship,counter);
            Chameleon(quest_ship);
            ShipStatus(quest_ship,0,70+Id(quest_ship)%11);
            ShipStatus(quest_ship,1,0);
            ShipStatus(quest_ship,2,30-Id(quest_ship)%11);
            ShipJoin(GroupFem,quest_ship);
            counter=0;
            while (IdToShip(fem_id[counter])){counter=counter+1;}
            fem_id[counter]=Id(quest_ship);
            quest_data1[counter]=0;
            quest_data2[counter]=0;
            trust_value[counter]=0;
            cur_num=cur_num+1;
          }
        }
      }
    }
    counter=GalaxyEvents()-1;
    while (counter>=0){
    if (GalaxyEventDate(counter)==CurTurn()){
    if (GalaxyEventType(counter)=='PlayerExtortsMoney'){
    if (GalaxyEventData(counter,1)==t_Transport){
    player_robs=player_robs+1;}}
    if (GalaxyEventType(counter)=='PlayerExtortsGoods'){
    if (GalaxyEventData(counter,1)==t_Transport){
    player_robs=player_robs+1;}}
    if (GalaxyEventType(counter)=='PlayerAcceptsMoneyForTruce'){
    if (GalaxyEventData(counter,1)==t_Transport){
    player_robs=player_robs+1;}}
    }
    if (GalaxyEventDate(counter)<CurTurn()){counter=0;}
    counter=counter-1;}
    player_transport_kills=ShipStatistic(Player(),4);
    player_pirate_kills=ShipStatistic(Player(),1);
    player_warrior_kills=ShipStatistic(Player(),5);
    player_ranger_kills=ShipStatistic(Player(),6);
    relation_shift=-30*ShipInPirateClan(Player())+agent_counter*20-min(5,GetShipPirateRank(Player()))*10;
    relation_shift=relation_shift+2*player_pirate_kills+4*player_helps;
    relation_shift=relation_shift-1*player_robs-4*player_transport_kills-8*player_warrior_kills-4*player_ranger_kills;
    max_relation=(1-player_hate)*(100+relation_shift);
    //max_relation=100;//;
  }
  if(!invite_for_third_mission && shu_extra_mission && (quest_status==10) && (max_relation>=10) && (GetShipPirateRank(Player())<6) && (GetShipPirateRank(Player())<=2*agent_counter) && (ControlledSystems(0)>15)) {
    invite_for_third_mission=1;
    Ether(0,'87CD50AA-F668-4D8A-BF1F-4EE4FB365E44',Format(CT("Script.PC_fem_rangers.250"),"<0>",shu_name));
  }
  if((quest_status==11) || (quest_status==13)) {
    if(CoalitionDefeated()) {
      quest_status=12;
      Ether(5,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',CT("Script.PC_fem_rangers.336"));
    }
    if(player_hate && !CoalitionDefeated()) {
      quest_status=12;
      Ether(5,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',CT("Script.PC_fem_rangers.127"));
    }
  }
  if((GetShipPirateRank(Player())>=6) && ((quest_status==11) || (quest_status==13))) {
    quest_status=12;
    Ether(4,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',Format(CT("Script.PC_fem_rangers.301"),"<0>",Player()));
  }
  if(shu_state==1) {
    shu_state=2;
    quest_planet=PlanetPirateClan();
    if (!quest_planet) quest_planet=FindPlanetByAdvancement(100);
    if (!quest_planet) quest_planet=FindPlanetByAdvancement(100,2);
    if (!quest_planet) quest_planet=FindPlanetByAdvancement(100,1);
    planet_owner=PlanetOwner(quest_planet,7);
    planet_race=PlanetRace(quest_planet,shu_race);
    quest_ship=BuyPirate(quest_planet,300);
    shu_id=Id(quest_ship);
    if (FindBonusByName(CT("Script.PC_fem_rangers.304"))>-1){
    SpecialToEquipment(FindBonusByName(CT("Script.PC_fem_rangers.304")),ShipItems(quest_ship,0));
    NoDropItem(ShipItems(quest_ship,0),1);
    Chameleon(quest_ship);
    }
    for(counter=1;counter<30;counter=counter+1) ShipRefit(quest_ship,500,1000000);
    ShipImproveItems(quest_ship,30);
    PlanetOwner(quest_planet,planet_owner);
    PlanetRace(quest_planet,planet_race);
    ShipFace(quest_ship,shu_face);
    SetName(quest_ship,shu_name);
    ShipSkill(quest_ship,0,6);
    ShipSkill(quest_ship,1,6);
    ShipSkill(quest_ship,2,6);
    while (GetShipPirateRank(quest_ship)<4){RaisePirateRank(quest_ship);}
    NoTargetToShip(quest_ship,2);
    OrderLock(quest_ship,1);
    MakeShipEnterStar(quest_ship,ShipStar(Player()),StarNearbyStars(ShipStar(quest_ship),GalaxyStars()-1),10);
    ShipJoin(GroupOriginalShu,quest_ship);
    for(counter=1;counter<ShipItems(quest_ship);counter=counter+1){
    quest_item=ShipItems(quest_ship,counter);
    ItemSize(quest_item,7*ItemSize(quest_item)/10);
    }
  }
  if(quest_status==11) {
    if((StarOwner(PlanetToStar(IdToPlanet(planet_supply)))==1) && !GroupCount(GroupSupply)) {
      quest_status=12;
      Ether(5,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',Format(CT("Script.PC_fem_rangers.274"),"<0>",Name(PlanetToStar(IdToPlanet(planet_supply)))));
    }
  }
  if((shu_state==2) && !GroupCount(GroupOriginalShu)) {
    shu_state=3;
    counter2=GalaxyEvents()-1;
    while (counter2>=0){
    if (GalaxyEventType(counter2)=='PlayerKillsShip'){
    if (GalaxyEventData(counter2,2)==shu_id){
    player_kills_shu=1;}}
    if (GalaxyEventType(counter2)=='PlayerAssistKillsShip'){
    if (GalaxyEventData(counter2,2)==shu_id){
    player_kills_shu=1;}}
    if (GalaxyEventType(counter2)=='PlayerCompanionKillsShip'){
    if ((GalaxyEventData(counter2,2)==shu_id) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
    player_kills_shu=1;}}
    if (GalaxyEventType(counter2)=='PlayerCompanionAssistKillsShip'){
    if ((GalaxyEventData(counter2,2)==shu_id) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
    player_kills_shu=1;}}
    if (GalaxyEventType(counter2)=='PlayerTranclucatorKillsShip'){
    if ((GalaxyEventData(counter2,2)==shu_id) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
    player_kills_shu=1;}}
    if (GalaxyEventDate(counter2)<CurTurn()-2){counter2=0;}
    counter2=counter2-1;}
    if (player_kills_shu){
    GetAchievementSHU();
    }
  }
  if(quest_status==11) {
    if((CurTurn()>(30+last_start)) && !GroupCount(GroupSupply)) {
      last_start=CurTurn();
      quest_planet=FindPlanetByAdvancement(100);
      if (!quest_planet){quest_planet=FindPlanetByAdvancement(100,2);}
      if (!quest_planet){quest_planet=FindPlanetByAdvancement(100,1);}
      quest_ship=BuyTransport(quest_planet,0,300);
      TransferShip(quest_ship,IdToPlanet(planet_supply));
      ShipJoin(GroupSupply,quest_ship);
    }
  }
  if((quest_status==9) && !gov_message3 && (CurTurn()>(investigation_start_date+30))) {
    gov_planet=0;
    counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),1,255);
    if (counter){
    counter=StarListToTransitPlanetList(locations,ShipStar(Player()),ShipStar(Player()),60,150,200,15,90,75);}
    if (counter){gov_planet=Id(locations[0]);}
    if(gov_planet) {
      gov_message3=1;
      Ether(3,'8645F2EC-6934-4D2F-9BBA-AA0EA936E400',Format(CT("Script.PC_fem_rangers.248"),"<0>",ShipName(Player()),"<1>",Name(IdToPlanet(gov_planet)),"<2>",Name(PlanetToStar(IdToPlanet(gov_planet)))));
    }
  }
  if(GroupCount(GroupShuCenter) && (quest_status==13)) {
    quest_ship=GroupToShip(GroupShuCenter);
    if(!ShipInNormalSpace(quest_ship) && BK_enters_BH) {
      BK_enters_BH=2;
      if (!GetShipPlanet(quest_ship) && (ShipOrderData1(quest_ship)<=1)){TransferShip(quest_ship,FindPlanet(ShipStar(quest_ship),'NotMaloc,NotPeleng,NotPeople,NotFei,NotGaal,NotPirateClan',0,100));}
      quest_hole=0;
      counter=0;
      while (counter<StarHoles(ShipStar(quest_ship))){
      if (Id(StarHoles(ShipStar(quest_ship),counter))==hole_id){
      if (HoleTurnCreate(StarHoles(ShipStar(quest_ship),counter))==hole_create_turn){
      quest_hole=StarHoles(ShipStar(quest_ship),counter);}}
      counter=counter+1;}
      if(ShipInHyperSpace(Player()) && (ShipOrderObj(Player())==quest_hole) && (quest_status==13)) {
        if (GABStatus==0){
        if (!GetShipPlanet(quest_ship)){TransferShip(quest_ship,FindPlanet(ShipStar(quest_ship),'NotMaloc,NotPeleng,NotPeople,NotFei,NotGaal,NotPirateClan',0,100));}
        ConvertToABShip(quest_ship);
        //CreateABShip('Ruins.BK',0,1000,150);
        CreateABShip('Ship.Peleng.PirateClan',0,100,150);
        CreateABShip('Ship.Peleng.PirateClan',0,100,150);
        CreateABShip('Ship.Peleng.PirateClan',0,100,150);
        ab_starts=1;
        StartAB('ABMap.map_2');//1-15
        }
      }
    }
  }
  if((quest_status>=5) && (quest_status<=9) && (quest_status!=6)) {
    if(player_hate && !CoalitionDefeated()) {
      quest_status=6;
      Ether(5,'FCDE615A-FE54-42CF-81DE-3A8BBE79E500',CT("Script.PC_fem_rangers.127"));
    }
    if(CoalitionDefeated()) {
      quest_status=6;
      Ether(5,'FCDE615A-FE54-42CF-81DE-3A8BBE79E500',CT("Script.PC_fem_rangers.336"));
    }
  }
  if(quest_status==13 && !BK_enters_BH && !GroupCount(GroupShuCenter)) {
    GABStatus=0;
    ab_starts=0;
    gov_planet=0;
    shu_center_destroyed=1;
    quest_status=14;
    Ether(4,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',CT("Script.PC_fem_rangers.130"));
  }
  if(quest_status==13 && (BK_enters_BH==2) && !GroupCount(GroupShuCenter) && !ab_starts) {
    quest_status=12;
    Ether(5,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',CT("Script.PC_fem_rangers.320"));
  }
  if(ab_starts && (GABStatus>1)) {
    GABStatus=0;
    ab_starts=0;
    gov_planet=0;
    shu_center_destroyed=1;
    quest_status=14;
    Ether(4,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',CT("Script.PC_fem_rangers.130"));
  }
  if((quest_status==14) && !gov_message4) {
    gov_planet=0;
    counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),1,255);
    if (counter){
    counter=StarListToTransitPlanetList(locations,ShipStar(Player()),ShipStar(Player()),60,150,200,15,90,75);}
    if (counter){gov_planet=Id(locations[0]);}
    if(gov_planet) {
      gov_message4=1;
      Ether(3,'0456DBA7-C65F-4C32-97F0-BC2DFB15BCF8',Format(CT("Script.PC_fem_rangers.303"),"<0>",ShipName(Player()),"<1>",Name(IdToPlanet(gov_planet)),"<2>",Name(PlanetToStar(IdToPlanet(gov_planet)))));
    }
  }
  if((quest_status==5) && !GroupCount(GroupDiplo)) {
    counter2=GalaxyEvents()-1;
    while (counter2>=0){
    if (GalaxyEventType(counter2)=='PlayerKillsShip'){
    if (GalaxyEventData(counter2,2)==diplo_id){
    player_kills_diplo=1;}}
    if (GalaxyEventType(counter2)=='PlayerAssistKillsShip'){
    if (GalaxyEventData(counter2,2)==diplo_id){
    player_kills_diplo=1;}}
    if (GalaxyEventType(counter2)=='PlayerCompanionKillsShip'){
    if ((GalaxyEventData(counter2,2)==diplo_id) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
    player_kills_diplo=1;}}
    if (GalaxyEventType(counter2)=='PlayerCompanionAssistKillsShip'){
    if ((GalaxyEventData(counter2,2)==diplo_id) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
    player_kills_diplo=1;}}
    if (GalaxyEventType(counter2)=='PlayerTranclucatorKillsShip'){
    if ((GalaxyEventData(counter2,2)==diplo_id) && (GalaxyEventData(counter2,2)==Id(ShipStar(Player())))){
    player_kills_diplo=1;}}
    if (GalaxyEventDate(counter2)<CurTurn()-2){counter2=0;}
    counter2=counter2-1;}
    if(!player_kills_diplo) {
      if(suspicious_ship_id==0) {
        quest_status=7;
        gov_message2=0;
        gov_planet=0;
      }
      if(suspicious_ship_id!=0) {
        quest_status=8;
        Ether(0,'016511F7-BF28-4A5F-A0F3-B652CAD8033F',CT("Script.PC_fem_rangers.206"));
        Ether(3,'FCDE615A-FE54-42CF-81DE-3A8BBE79E500',CT("Script.PC_fem_rangers.205"));
      }
    }
    if(player_kills_diplo) {
      quest_status=6;
      Ether(5,'FCDE615A-FE54-42CF-81DE-3A8BBE79E500',CT("Script.PC_fem_rangers.202"));
    }
  }
  if((quest_status==7) && !gov_message2) {
    gov_planet=0;
    counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),1,255);
    if (counter){
    counter=StarListToTransitPlanetList(locations,ShipStar(Player()),ShipStar(Player()),60,150,200,15,90,75);}
    if (counter){gov_planet=Id(locations[0]);}
    if(gov_planet) {
      gov_message2=1;
      Ether(3,'893E0C91-12CA-4122-9E09-7ED869591471',Format(CT("Script.PC_fem_rangers.182"),"<0>",Name(IdToPlanet(gov_planet))));
    }
  }
  if(quest_status==1) {
    if(GetShipPlanet(Player())) {
      quest_planet=GetShipPlanet(Player());
      planet_num=0;
      counter=1;
      while (counter<ArrayDim(planet_list)){
      if (Id(quest_planet)==planet_list[counter]){planet_num=counter;}
      counter=counter+1;}
      if(planet_num) {
        if(planet_statuses[planet_num]=='') {
          if(ItemIn(BeaconContainer,Player())) {
            beacons_placed=beacons_placed+1;
            planet_statuses[planet_num]=CT("Script.PC_fem_rangers.133");
            while (IsFilm()){1;}
            Sound('Sound.ProbeSignal6');
            if(beacons_placed<num_planets) {
              Ether(3,'972FE886-AE50-4231-98BB-5DE80FD5B374',Format(CT("Script.PC_fem_rangers.313"),"<0>",Name(IdToPlanet(planet_list[1])),"<1>",Name(PlanetToStar(IdToPlanet(planet_list[1]))),"<2>",planet_statuses[1],"<3>",Name(IdToPlanet(planet_list[2])),"<4>",Name(PlanetToStar(IdToPlanet(planet_list[2]))),"<5>",planet_statuses[2],"<6>",Name(IdToPlanet(planet_list[3])),"<7>",Name(PlanetToStar(IdToPlanet(planet_list[3]))),"<8>",planet_statuses[3],"<9>",Name(IdToPlanet(planet_list[4])),"<10>",Name(PlanetToStar(IdToPlanet(planet_list[4]))),"<11>",planet_statuses[4],"<12>",Name(IdToPlanet(planet_list[5])),"<13>",Name(PlanetToStar(IdToPlanet(planet_list[5]))),"<14>",planet_statuses[5],"<15>",Name(IdToPlanet(planet_list[6])),"<16>",Name(PlanetToStar(IdToPlanet(planet_list[6]))),"<17>",planet_statuses[6],"<18>",Name(IdToPlanet(planet_list[7])),"<19>",Name(PlanetToStar(IdToPlanet(planet_list[7]))),"<20>",planet_statuses[7],"<21>",Name(IdToPlanet(planet_list[8])),"<22>",Name(PlanetToStar(IdToPlanet(planet_list[8]))),"<23>",planet_statuses[8],"<24>",GameDateTxtByTurn(beacon_quest_deadline)));
              if(beacons_placed==1) {
                Ether(0,'3BDF2C95-D0A1-45F7-A278-04ADAFEB9A6C',Format(CT("Script.PC_fem_rangers.312"),"<0>",Name(GetShipPlanet(Player())),"<1>",num_planets-beacons_placed));
              }
              if(beacons_placed>1) {
                Ether(0,'3BDF2C95-D0A1-45F7-A278-04ADAFEB9A6C',Format(CT("Script.PC_fem_rangers.131"),"<0>",Name(GetShipPlanet(Player())),"<1>",num_planets-beacons_placed));
              }
            }
            if(beacons_placed>=num_planets) {
              quest_status=3;
              FreeItem(GetItemFromShip(Player(),FindItemInShip(Player(),BeaconContainer)));
              Ether(4,'972FE886-AE50-4231-98BB-5DE80FD5B374',CT("Script.PC_fem_rangers.130"));
            }
          }
        }
      }
    }
  }
  if(quest_status==1) {
    if(!ItemExist(BeaconContainer)) {
      Ether(5,'972FE886-AE50-4231-98BB-5DE80FD5B374',CT("Script.PC_fem_rangers.129"));
      quest_status=4;
    }
    if(ItemExist(BeaconContainer)) {
      if(CurTurn()>beacon_quest_deadline) {
        Ether(5,'972FE886-AE50-4231-98BB-5DE80FD5B374',CT("Script.PC_fem_rangers.128"));
        ReleaseItemFromScript(BeaconContainer);
        quest_status=4;
      }
      if(CurTurn()<=beacon_quest_deadline) {
        if(player_hate && !CoalitionDefeated()) {
          ReleaseItemFromScript(BeaconContainer);
          quest_status=4;
          Ether(5,'972FE886-AE50-4231-98BB-5DE80FD5B374',CT("Script.PC_fem_rangers.127"));
        }
        if(CoalitionDefeated()) {
          ReleaseItemFromScript(BeaconContainer);
          quest_status=4;
          Ether(5,'972FE886-AE50-4231-98BB-5DE80FD5B374',CT("Script.PC_fem_rangers.336"));
        }
      }
    }
  }
  if((quest_status==3) && !gov_message1) {
    gov_planet=0;
    counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),1,255);
    if (counter){
    counter=StarListToTransitPlanetList(locations,ShipStar(Player()),ShipStar(Player()),60,150,200,15,90,75);}
    if (counter){gov_planet=Id(locations[0]);}
    if(gov_planet) {
      gov_message1=1;
      Ether(3,'65D73EBF-55DA-4895-9D1D-DDF17E60BDF0',Format(CT("Script.PC_fem_rangers.137"),"<0>",ShipName(Player()),"<1>",Name(IdToPlanet(gov_planet)),"<2>",Name(PlanetToStar(IdToPlanet(gov_planet)))));
    }
  }
>>>
DialogBegin=<<<
  if((max_relation>=10) && (quest_status==10) && !third_mission_refused && GetTalkShip()) {
    counter=0;
    quest_ship=0;
    while (counter<GroupCount(GroupFem)){
    if (GetTalkShip()==GroupShip(GroupFem,counter)){quest_ship=GetTalkShip();}
    counter=counter+1;}
    if(quest_ship) {
      if(!TalkByAI()) {
        if(ShipIsPartner(quest_ship)!=Player()) {
          if(shu_extra_mission) {
            AddDialogInject('DialogNextMission','', CT("Script.PC_fem_rangers.251"),1);
          }
          if(!shu_extra_mission) {
            AddDialogInject('DialogNextMission','', CT("Script.PC_fem_rangers.261"),1);
          }
        }
      }
    }
  }
  if((max_relation<10) && GetTalkShip()) {
    counter=0;
    quest_ship=0;
    while (counter<GroupCount(GroupFem)){
    if (GetTalkShip()==GroupShip(GroupFem,counter)){quest_ship=GetTalkShip();}
    counter=counter+1;}
    if(quest_ship) {
      AddDialogOverride('DialogHate',10);
    }
  }
  if((max_relation>=10) && (quest_status==3) && !second_mission_refused && GetTalkShip() && !TalkByAI() &&  (gov_reward1==1)) {
    counter=0;
    quest_ship=0;
    while (counter<GroupCount(GroupFem)){
    if (GetTalkShip()==GroupShip(GroupFem,counter)){quest_ship=GetTalkShip();}
    counter=counter+1;}
    if(quest_ship) {
      if(ShipIsPartner(quest_ship)!=Player()) {
        AddDialogInject('DialogNextMission','',CT("Script.PC_fem_rangers.164"),1);
      }
    }
  }
  if((max_relation>=10) && (quest_status==8) && GetTalkShip() && !TalkByAI()) {
    counter=0;
    quest_ship=0;
    while (counter<GroupCount(GroupFem)){
    if (GetTalkShip()==GroupShip(GroupFem,counter)){quest_ship=GetTalkShip();}
    counter=counter+1;}
    if(quest_ship) {
      if(ShipIsPartner(quest_ship)!=Player()) {
        AddDialogOverride('DialogReport',10);
      }
    }
  }
  if(GetShipPlanet(Player())>0) {
    if(Id(GetShipPlanet(Player()))==gov_planet) {
      if((quest_status==14) && !gov_reward2) {
        AddDialogOverride('DialogStoryComplete',15);
      }
      if(quest_status==9) {
        if(!report_failed) {
          AddDialogOverride('DialogPlanetSuccess',15);
        }
        if(report_failed) {
          AddDialogOverride('DialogPlanetFail',15);
        }
      }
      if(quest_status==7) {
        if((diplo_try>0) || (ControlledSystems(0)<=1)) {
          AddDialogOverride('DialogSuccess2',15);
        }
        if((diplo_try==0) && (ControlledSystems(0)>1)) {
          AddDialogOverride('DialogPlanetRepeat',15);
        }
      }
      if((quest_status==3) && !gov_reward1) {
        AddDialogOverride('DialogPlanet1',15);
      }
    }
  }
  if(GetShipRuins(Player())>0) {
    if(ShipType(GetShipRuins(Player()))=='PB') {
      if(pirate_side_chosen==1) {
        AddDialogOverride('DialogPB',15);
      }
    }
  }
  if((max_relation>=10) && (second_try==1) && GetTalkShip() && !CoalitionDefeated()) {
    counter=0;
    quest_ship=0;
    while (counter<GroupCount(GroupFem)){
    if (GetTalkShip()==GroupShip(GroupFem,counter)){quest_ship=GetTalkShip();}
    counter=counter+1;}
    if(quest_ship) {
      if(!TalkByAI()) {
        if((max_relation>=10) && !StarOwner(ShipStar(Player())) && (GetShipPirateRank(Player())<6) && (RelationToRanger(quest_ship,Player())>=30)) {
          AddDialogOverride('DialogSecondTry',10);
        }
      }
    }
  }
>>>
States ~{
    StateNew ~{
        Type=None
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            counter=0;
            counter2=0;
            while (counter<GroupCount(GroupFem)){
            if (RelationToRanger(GroupShip(GroupFem,counter),Player())>max(max_relation,10)){
            RelationToRanger(GroupShip(GroupFem,counter),Player(),max(max_relation,10));}
            if (ShipIsPartner(GroupShip(GroupFem,counter))==Player()){counter2=counter2+1;}
            counter=counter+1;}
            if (counter2>=3){GetAchievementGIRLSHIRE();}
        >>>
    }
    StateCreate ~{
        Type=Free
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            if(ShipIsTakeoff(CurShip)) {
              //BuildListOfMMByPriority(bonus_mm,100-5*GalaxyTechLevel(),80-10*GalaxyTechLevel());
              //ArrayRandomize(50,bonus_mm);
              //counter=0;
              //while (counter<(GalaxyTechLevel()-1)){
              //AddItemToShip(CurShip,CreateMM(bonus_mm[counter]));
              //counter=counter+1;}
              ChangeState(2);
              exit;
            }
        >>>
    }
    StateTakeoffWithItems ~{
        Type=Follow
        Object=GroupNew
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            if(ShipInNormalSpace(CurShip)) {
              //OrderMove(CurShip,CoordX(CurShip)+Rnd(-50,50),CoordY(CurShip)+Rnd(-50,50))
              ShipFreeFlight(CurShip);
              ChangeState(3);
              exit;
            }
        >>>
    }
    StateFree ~{
        Type=Free
        Attack ~{
            0=GroupEnemies
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            if(ShipInNormalSpace(CurShip)) {
              ShipStatus(CurShip,0,70+Id(CurShip)%11);
              ShipStatus(CurShip,1,0);
              ShipStatus(CurShip,2,30-Id(CurShip)%11);
              RelationToRanger(PlanetPirateClan(),CurShip,100-pirate_side_chosen*50);
              if (pirate_side_chosen==2){
              if (GetShipPlanet(CurShip)){
              if (PlanetOwner(GetShipPlanet(CurShip))==7){
              OrderNone(CurShip);
              OrderLock(CurShip,1);
              ShipDestroy(CurShip);
              }}}
              quest_star=ShipStar(CurShip);
              counter=0;
              while (counter<StarPlanets(quest_star)){
              quest_planet=StarPlanets(quest_star,counter);
              if (PlanetOwner(quest_planet)<5){
              RelationToRanger(quest_planet,CurShip,100);}
              counter=counter+1;}
              counter=0;
              while (counter<StarShips(quest_star)){
              quest_ship=StarShips(quest_star,counter);
              if (ShipOwner(quest_ship)<5){
              if (ShipTypeN(quest_ship)<4){
              if (RelationToRanger(quest_ship,CurShip)>=10){
              if (ShipGetBad(quest_ship)!=CurShip){
              RelationToRanger(quest_ship,CurShip,100);}}}}
              counter=counter+1;}
              if (ShipStar(Player())!=ShipStar(CurShip)){
              HullHP(CurShip,min(HullHP(CurShip)+5,ItemSize(ShipItems(CurShip,0))));}
              quest_ship=ShipGetBad(CurShip);
              if((ShipIsPartner(CurShip)==Player()) && (max_relation<10) && ShipInNormalSpace(Player()) && ShipInNormalSpace(CurShip) && (ShipStar(Player())==ShipStar(CurShip))) {
                ShipSetPartner(CurShip,0,0);
                Dialog(DialogPartnershipBreak,CurShip);
              }
              if(quest_ship) {
                truce_flag=0;
                counter=0;
                while (fem_id[counter]!=Id(CurShip)){counter=counter+1;}
                ship_num=counter;
                counter=0;
                while (counter<GroupCount(GroupFem)){
                if (quest_ship==GroupShip(GroupFem,counter)){
                truce_flag=1;
                if ((ShipGetBad(Player())==quest_ship) || (ShipGetBad(quest_ship)==Player())){ 
                if (ShipIsPartner(CurShip)==Player()){
                if (ShipInNormalSpace(Player()) && ShipInNormalSpace(CurShip) && (ShipStar(Player())==ShipStar(CurShip))){
                counter2=0;
                ShipSetPartner(CurShip,0,0);
                Sound('Sound.QuestCancel');
                ether_id='5D04B425-74E2-45C2-BDA1-541D7148C36';
                ether_id=ether_id+ship_num;
                Ether(1,ether_id,Format(CT("Script.PC_fem_rangers.333"),"<0>",Name(CurShip),"<1>",Name(quest_ship)));
                }}}
                }
                counter=counter+1;}
                if (truce_flag){
                if ((ShipIsPartner(quest_ship)!=Player()) || ((ShipIsPartner(CurShip)==Player()) && (ShipIsPartner(quest_ship)==Player()))){
                RelationToRanger(CurShip,quest_ship,100);
                RelationToRanger(quest_ship,CurShip,100);
                TruceBetweenShips(CurShip,quest_ship);}}
              }
            }
            if(GetShipPlanet(CurShip)) {
              quest_planet=GetShipPlanet(CurShip);
              if(PlanetOwner(quest_planet)<5) {
                if(!((Id(CurShip)+CurTurn()/10)%3)) {
                  if(!ShipIsPartner(CurShip)) {
                    quest_star=ShipStar(CurShip);
                    if(!StarBattle(quest_star)) {
                      counter=0;
                      while (fem_id[counter]!=Id(CurShip)){counter=counter+1;}
                      ship_num=counter;
                      quest_ship=0;
                      ship_to_guard=0;
                      counter=0;
                      while (counter<StarShips(quest_star)){
                      quest_ship=StarShips(quest_star,counter);
                      if ((GetShipPlanet(quest_ship)==quest_planet) || (ShipInNormalSpace(quest_ship) && (Dist(quest_ship,CurShip)<500) && (HullDamage(quest_ship)<25))){
                      if (ShipTypeN(quest_ship)==t_Transport){
                      if (ShipGetBad(quest_ship)!=CurShip){
                      if (!ShipInScript(quest_ship)){
                      if (ShipSpeed(CurShip)>(150+ShipSpeed(quest_ship))){
                      ship_to_guard=quest_ship;}}}}}
                      counter=counter+1;}
                      if (!ship_to_guard){
                      if (!Rnd(0,20)){
                      ship_to_guard=BuyTransport(quest_planet);
                      }}
                      if(!ship_to_guard) {
                        quest_planet=0;
                        if (BuildListOfQuestPossibleLocations(locations,ShipStar(CurShip),13+GalaxyTechLevel()*2,40+GalaxyTechLevel()*4)){
                        counter=0;
                        safety_dist=-2;
                        while (counter<ArrayDim(locations)){
                        if (DistToNearestEnemySystem(locations[counter])>safety_dist){
                        quest_planet=FindPlanet(locations[counter],'NotNone',0,100);
                        safety_dist=DistToNearestEnemySystem(locations[counter]);}
                        counter=counter+1;}}
                        if(quest_planet) {
                          ShipRefuel(CurShip);
                          ShipRepairEq(CurShip);
                          OrderTakeOff(CurShip);
                          OrderLock(CurShip,1);
                          quest_data1[ship_num]=Id(quest_planet);
                          quest_data2[ship_num]=Id(GetShipPlanet(CurShip));
                          quest_item=CreateQuestItem(item_names[Rnd(1,1000)%ArrayDim(item_names)]);
                          if (ShipFreeSpace(CurShip)<ItemSize(quest_item)){ItemSize(ShipItems(CurShip,0),ItemSize(ShipItems(CurShip,0))+ItemSize(quest_item)-ShipFreeSpace(CurShip));}
                          AddItemToShip(CurShip,quest_item);
                          ChangeState(9,CurShip);
                          exit;
                        }
                      }
                      if(ship_to_guard) {
                        ShipRefuel(ship_to_guard);
                        ShipRepairEq(ship_to_guard);
                        quest_data1[ship_num]=Id(ship_to_guard);
                        quest_data2[ship_num]=CurTurn()+100;
                        ShipRefuel(CurShip);
                        ShipRepairEq(CurShip);
                        OrderNone(CurShip);
                        OrderLock(CurShip,1);
                        temp_curship=CurShip;
                        ShipJoin(GroupTransports,ship_to_guard);
                        ChangeState(6,temp_curship);
                        exit;
                      }
                    }
                  }
                }
              }
            }
        >>>
    }
    StateFree ~{
        Type=Free
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            counter=0;
            ship_under_prot=0;
            while (counter<max_num){
            if (quest_data1[counter]==Id(CurShip)){ship_under_prot=1;}
            counter=counter+1;}
            if(!ship_under_prot) {
              OrderLock(CurShip,0);
              ShipOut(CurShip);
            }
        >>>
    }
    StateFree ~{
        Type=Free
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            ship_is_enemy=0;
            counter=0;
            while (counter<GroupCount(GroupFem)){
            if (ShipGetBad(CurShip)==GroupShip(GroupFem,counter)){ship_is_enemy=1;}
            counter=counter+1;}
            counter=0;
            while (counter<GroupCount(GroupTransports)){
            if (ShipGetBad(CurShip)==GroupShip(GroupTransports,counter)){ship_is_enemy=1;}
            if (CurShip==ShipGetBad(GroupShip(GroupTransports,counter))){ship_is_enemy=1;}
            counter=counter+1;}
            if(!ship_is_enemy) {
              counter=ArrayDim(enemy_id)-1;
              while (counter>0){
              if (enemy_id[counter]==Id(CurShip)){ArrayDelete(enemy_id,counter);}
              counter=counter-1;}
              ShipOut(CurShip);}
            }
        >>>
    }
    GuardShip ~{
        Type=None
        Attack ~{
            0=GroupEnemies
        }
        TakeItem=
        TakeAll=False
        OutMsg=DialogMission
        InMsg=DialogMission
        Ether=
        Code=<<<
            if(!switch_state) {
              player_is_enemy=0;
              counter=0;
              while (fem_id[counter]!=Id(CurShip)){counter=counter+1;}
              ship_num=counter;
              ship_to_guard=0;
              counter=0;
              while (counter<GroupCount(GroupTransports)){
              if (quest_data1[ship_num]==Id(GroupShip(GroupTransports,counter))){ship_to_guard=GroupShip(GroupTransports,counter);}
              counter=counter+1;}
              if(!ship_to_guard) {
                if (ShipInNormalSpace(CurShip)){
                OrderMove(CurShip,CoordX(CurShip)+Rnd(-50,50),CoordY(CurShip)+Rnd(-50,50));}
                quest_data1[ship_num]=0;
                quest_data2[ship_num]=0;
                OrderLock(CurShip,0);
                temp_curship=CurShip;
                ShipFreeFlight(CurShip);
                ChangeState(3,temp_curship);
                exit;
              }
              if(ship_to_guard) {
                if(CurTurn()>=quest_data2[ship_num]) {
                  OrderLock(ship_to_guard,0);
                  ShipOut(ship_to_guard);
                  quest_data1[ship_num]=0;
                  quest_data2[ship_num]=0;
                  OrderLock(CurShip,0);
                  if (ShipInNormalSpace(CurShip)){
                  OrderMove(CurShip,CoordX(CurShip)+Rnd(-50,50),CoordY(CurShip)+Rnd(-50,50));
                  if (PlanetOwner(NearCivilPlanet(CurShip))<5){OrderLanding(CurShip,NearCivilPlanet(CurShip),1);}
                  }
                  ChangeState(7,CurShip);
                  exit;
                }
                if(CurTurn()<quest_data2[ship_num]) {
                  if(GetShipPlanet(CurShip)) {
                    ShipRefuel(CurShip);
                    ShipRepairEq(CurShip);
                    OrderTakeOff(CurShip);
                    if (GetShipPlanet(ship_to_guard)){
                    OrderLock(ship_to_guard,0);
                    ShipRefuel(ship_to_guard);
                    ShipRepairEq(ship_to_guard);
                    OrderTakeOff(ship_to_guard);}
                  }
                  if(ShipInNormalSpace(CurShip)) {
                    if((RelationToRanger(ship_to_guard,CurShip)<10) || (ShipGetBad(CurShip)==ship_to_guard)) {
                      OrderLock(ship_to_guard,0);
                      ShipOut(ship_to_guard);
                      OrderNone(CurShip);
                      quest_data1[ship_num]=0;
                      quest_data2[ship_num]=0;
                      OrderLock(CurShip,0);
                      temp_curship=CurShip;
                      ShipFreeFlight(CurShip);
                      ChangeState(3,temp_curship);
                      exit;
                    }
                    if((RelationToRanger(ship_to_guard,CurShip)>=10) && (ShipGetBad(CurShip)!=ship_to_guard)) {
                      if(ShipInFear(CurShip) && (HullDamage(CurShip)>50)) {
                        OrderLock(ship_to_guard,0);
                        ShipOut(ship_to_guard);
                        OrderNone(CurShip);
                        quest_data1[ship_num]=0;
                        quest_data2[ship_num]=0;
                        OrderLock(CurShip,0);
                        temp_curship=CurShip;
                        ShipFreeFlight(CurShip);
                        ChangeState(3,temp_curship);
                        exit;
                      }
                      if(!ShipInFear(CurShip) || (HullDamage(CurShip)<=50)) {
                        if(ShipStar(CurShip)==ShipStar(ship_to_guard)) {
                          if(GetShipPlanet(ship_to_guard)) {
                            OrderNone(ship_to_guard);
                            OrderLock(ship_to_guard,1);
                            ShipRefuel(ship_to_guard);
                            ShipRepairEq(ship_to_guard);
                            OrderLanding(CurShip,GetShipPlanet(ship_to_guard),1);
                          }
                          if(ShipInNormalSpace(ship_to_guard)) {
                            if((ShipOrder(ship_to_guard)!=3) || (ShipTurnBeforeEndOrder(ship_to_guard)>1)) {
                              OrderFollowShip(CurShip,ship_to_guard,0,1);
                            }
                            if((ShipOrder(ship_to_guard)==3) && (ShipTurnBeforeEndOrder(ship_to_guard)<2)) {
                              OrderJump(CurShip,ShipOrderObj(ship_to_guard),1);
                            }
                          }
                        }
                        if(ShipStar(CurShip)!=ShipStar(ship_to_guard)) {
                          OrderJump(CurShip,ShipStar(ship_to_guard),1);
                        }
                        counter=0;
                        ArrayClear(new_enemies);
                        while (counter<StarShips(ShipStar(CurShip))){
                        quest_ship=StarShips(ShipStar(CurShip),counter);
                        if ((!ShipInScript(quest_ship)) &&  (quest_ship!=Player())){
                        ship_is_enemy=0;
                        if (ShipGetBad(quest_ship)==CurShip){ship_is_enemy=1;}
                        if (ShipGetBad(quest_ship)==ship_to_guard){ship_is_enemy=1;}
                        if (ShipGetBad(ship_to_guard)==quest_ship){ship_is_enemy=1;}
                        if (ship_is_enemy){
                        ArrayAdd(new_enemies,quest_ship);
                        }}
                        counter=counter+1;}
                        temp_curship=CurShip;
                        while(ArrayDim(new_enemies)>1) {
                          ArrayAdd(enemy_id,Id(new_enemies[1]));
                          ShipJoin(GroupEnemies,new_enemies[1]);
                          ArrayDelete(new_enemies,1);
                        }
                        if(!player_is_enemy) {
                          if((RelationToRanger(temp_curship,Player())<10) || (ShipGetBad(Player())==temp_curship) || (ShipGetBad(Player())==ship_to_guard) || (ShipGetBad(ship_to_guard)==Player())) {
                            switch_state=1;
                            ChangeState(8,temp_curship);
                            exit;
                          }
                        }
                        if(player_is_enemy) {
                          if((RelationToRanger(temp_curship,Player())>9) && (ShipGetBad(Player())!=temp_curship) && (ShipGetBad(Player())!=ship_to_guard) && (ShipGetBad(ship_to_guard)!=Player())) {
                            switch_state=1;
                            ChangeState(6,temp_curship);
                            exit;
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            if(switch_state) {
              switch_state=0;
            }
        >>>
    }
    StateFreeGetReward ~{
        Type=Free
        Attack ~{
            0=GroupEnemies
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            if(ShipInNormalSpace(CurShip)) {
              ShipStatus(CurShip,0,70+Id(CurShip)%11);
              ShipStatus(CurShip,1,0);
              ShipStatus(CurShip,2,30-Id(CurShip)%11);
              RelationToRanger(PlanetPirateClan(),CurShip,100-pirate_side_chosen*50);
              if (pirate_side_chosen==2){
              if (GetShipPlanet(CurShip)){
              if (PlanetOwner(GetShipPlanet(CurShip))==7){
              OrderNone(CurShip);
              OrderLock(CurShip,1);
              ShipDestroy(CurShip);
              }}}
              quest_star=ShipStar(CurShip);
              counter=0;
              while (counter<StarPlanets(quest_star)){
              quest_planet=StarPlanets(quest_star,counter);
              if (PlanetOwner(quest_planet)<5){
              RelationToRanger(quest_planet,CurShip,100);}
              counter=counter+1;}
              counter=0;
              while (counter<StarShips(quest_star)){
              quest_ship=StarShips(quest_star,counter);
              if (ShipOwner(quest_ship)<5){
              if (ShipTypeN(quest_ship)<4){
              if (RelationToRanger(quest_ship,CurShip)>=10){
              if (ShipGetBad(quest_ship)!=CurShip){
              RelationToRanger(quest_ship,CurShip,100);}}}}
              counter=counter+1;}
              if (ShipStar(Player())!=ShipStar(CurShip)){
              HullHP(CurShip,min(HullHP(CurShip)+5,ItemSize(ShipItems(CurShip,0))));}
              quest_ship=ShipGetBad(CurShip);
              if((ShipIsPartner(CurShip)==Player()) && (max_relation<10) && ShipInNormalSpace(Player()) && ShipInNormalSpace(CurShip) && (ShipStar(Player())==ShipStar(CurShip))) {
                ShipSetPartner(CurShip,0,0);
                Dialog(DialogPartnershipBreak,CurShip);
              }
              if(quest_ship) {
                truce_flag=0;
                counter=0;
                while (fem_id[counter]!=Id(CurShip)){counter=counter+1;}
                ship_num=counter;
                counter=0;
                while (counter<GroupCount(GroupFem)){
                if (quest_ship==GroupShip(GroupFem,counter)){
                truce_flag=1;
                if ((ShipGetBad(Player())==quest_ship) || (ShipGetBad(quest_ship)==Player())){ 
                if (ShipIsPartner(CurShip)==Player()){
                if (ShipInNormalSpace(Player()) && ShipInNormalSpace(CurShip) && (ShipStar(Player())==ShipStar(CurShip))){
                counter2=0;
                ShipSetPartner(CurShip,0,0);
                Sound('Sound.QuestCancel');
                ether_id='5D04B425-74E2-45C2-BDA1-541D7148C36';
                ether_id=ether_id+ship_num;
                Ether(1,ether_id,Format(CT("Script.PC_fem_rangers.333"),"<0>",Name(CurShip),"<1>",Name(quest_ship)));
                }}}
                }
                counter=counter+1;}
                if (truce_flag){
                if ((ShipIsPartner(quest_ship)!=Player()) || ((ShipIsPartner(CurShip)==Player()) && (ShipIsPartner(quest_ship)==Player()))){
                RelationToRanger(CurShip,quest_ship,100);
                RelationToRanger(quest_ship,CurShip,100);
                TruceBetweenShips(CurShip,quest_ship);}}
              }
            }
            if(GetShipPlanet(CurShip)) {
              if(PlanetOwner(GetShipPlanet(CurShip))<5) {
                roll=((CurTurn()+Id(CurShip)+Id(GetShipPlanet(CurShip)))/30)%1000;
                if(roll<500) {
                  ShipMoney(CurShip,ShipMoney(CurShip)+GalaxyMoney(4));
                  ChangeState(2);
                  exit;
                }
                if((roll>=500) && (roll<900)) {
                  BuildListOfMMByPriority(bonus_mm,100-5*GalaxyTechLevel(),80-10*GalaxyTechLevel());
                  counter=0;
                  AddItemToShip(CurShip,CreateMM(bonus_mm[((CurTurn()+Id(CurShip))/31)%ArrayDim(bonus_mm)]));
                  ChangeState(2);
                  exit;
                }
                if(roll>=900) {
                  AddItemToShip(CurShip,CreateArt(bonus_arts[((CurTurn()+Id(CurShip))/23)%ArrayDim(bonus_arts)],PlanetRace(GetShipPlanet(CurShip))));
                  ChangeState(2);
                  exit;
                }
              }
            }
        >>>
    }
    GuardVsPlayer ~{
        Type=None
        Attack ~{
            0=GroupEnemies
            1=GroupNew
        }
        TakeItem=
        TakeAll=False
        OutMsg=DialogMission
        InMsg=DialogMission
        Ether=
        Code=<<<
            if(!switch_state) {
              player_is_enemy=1;
              counter=0;
              while (fem_id[counter]!=Id(CurShip)){counter=counter+1;}
              ship_num=counter;
              ship_to_guard=0;
              counter=0;
              while (counter<GroupCount(GroupTransports)){
              if (quest_data1[ship_num]==Id(GroupShip(GroupTransports,counter))){ship_to_guard=GroupShip(GroupTransports,counter);}
              counter=counter+1;}
              if(!ship_to_guard) {
                if (ShipInNormalSpace(CurShip)){
                OrderMove(CurShip,CoordX(CurShip)+Rnd(-50,50),CoordY(CurShip)+Rnd(-50,50));}
                quest_data1[ship_num]=0;
                quest_data2[ship_num]=0;
                OrderLock(CurShip,0);
                temp_curship=CurShip;
                ShipFreeFlight(CurShip);
                ChangeState(3,temp_curship);
                exit;
              }
              if(ship_to_guard) {
                if(CurTurn()>=quest_data2[ship_num]) {
                  OrderLock(ship_to_guard,0);
                  ShipOut(ship_to_guard);
                  quest_data1[ship_num]=0;
                  quest_data2[ship_num]=0;
                  OrderLock(CurShip,0);
                  if (ShipInNormalSpace(CurShip)){
                  OrderMove(CurShip,CoordX(CurShip)+Rnd(-50,50),CoordY(CurShip)+Rnd(-50,50));
                  if (PlanetOwner(NearCivilPlanet(CurShip))<5){OrderLanding(CurShip,NearCivilPlanet(CurShip),1);}
                  }
                  ChangeState(7,CurShip);
                  exit;
                }
                if(CurTurn()<quest_data2[ship_num]) {
                  if(GetShipPlanet(CurShip)) {
                    ShipRefuel(CurShip);
                    ShipRepairEq(CurShip);
                    OrderTakeOff(CurShip);
                    if (GetShipPlanet(ship_to_guard)){
                    OrderLock(ship_to_guard,0);
                    ShipRefuel(ship_to_guard);
                    ShipRepairEq(ship_to_guard);
                    OrderTakeOff(ship_to_guard);}
                  }
                  if(ShipInNormalSpace(CurShip)) {
                    if((RelationToRanger(ship_to_guard,CurShip)<10) || (ShipGetBad(CurShip)==ship_to_guard)) {
                      OrderLock(ship_to_guard,0);
                      ShipOut(ship_to_guard);
                      OrderNone(CurShip);
                      quest_data1[ship_num]=0;
                      quest_data2[ship_num]=0;
                      OrderLock(CurShip,0);
                      temp_curship=CurShip;
                      ShipFreeFlight(CurShip);
                      ChangeState(3,temp_curship);
                      exit;
                    }
                    if((RelationToRanger(ship_to_guard,CurShip)>=10) && (ShipGetBad(CurShip)!=ship_to_guard)) {
                      if(ShipInFear(CurShip) && (HullDamage(CurShip)>50)) {
                        OrderLock(ship_to_guard,0);
                        ShipOut(ship_to_guard);
                        OrderNone(CurShip);
                        quest_data1[ship_num]=0;
                        quest_data2[ship_num]=0;
                        OrderLock(CurShip,0);
                        temp_curship=CurShip;
                        ShipFreeFlight(CurShip);
                        ChangeState(3,temp_curship);
                        exit;
                      }
                      if(!ShipInFear(CurShip) || (HullDamage(CurShip)<=50)) {
                        if(ShipStar(CurShip)==ShipStar(ship_to_guard)) {
                          if(GetShipPlanet(ship_to_guard)) {
                            OrderNone(ship_to_guard);
                            OrderLock(ship_to_guard,1);
                            ShipRefuel(ship_to_guard);
                            ShipRepairEq(ship_to_guard);
                            OrderLanding(CurShip,GetShipPlanet(ship_to_guard),1);
                          }
                          if(ShipInNormalSpace(ship_to_guard)) {
                            if((ShipOrder(ship_to_guard)!=3) || (ShipTurnBeforeEndOrder(ship_to_guard)>1)) {
                              OrderFollowShip(CurShip,ship_to_guard,0,1);
                            }
                            if((ShipOrder(ship_to_guard)==3) && (ShipTurnBeforeEndOrder(ship_to_guard)<2)) {
                              OrderJump(CurShip,ShipOrderObj(ship_to_guard),1);
                            }
                          }
                        }
                        if(ShipStar(CurShip)!=ShipStar(ship_to_guard)) {
                          OrderJump(CurShip,ShipStar(ship_to_guard),1);
                        }
                        counter=0;
                        ArrayClear(new_enemies);
                        while (counter<StarShips(ShipStar(CurShip))){
                        quest_ship=StarShips(ShipStar(CurShip),counter);
                        if ((!ShipInScript(quest_ship)) &&  (quest_ship!=Player())){
                        ship_is_enemy=0;
                        if (ShipGetBad(quest_ship)==CurShip){ship_is_enemy=1;}
                        if (ShipGetBad(quest_ship)==ship_to_guard){ship_is_enemy=1;}
                        if (ShipGetBad(ship_to_guard)==quest_ship){ship_is_enemy=1;}
                        if (ship_is_enemy){
                        ArrayAdd(new_enemies,quest_ship);
                        }}
                        counter=counter+1;}
                        temp_curship=CurShip;
                        while(ArrayDim(new_enemies)>1) {
                          ArrayAdd(enemy_id,Id(new_enemies[1]));
                          ShipJoin(GroupEnemies,new_enemies[1]);
                          ArrayDelete(new_enemies,1);
                        }
                        if(!player_is_enemy) {
                          if((RelationToRanger(temp_curship,Player())<10) || (ShipGetBad(Player())==temp_curship) || (ShipGetBad(Player())==ship_to_guard) || (ShipGetBad(ship_to_guard)==Player())) {
                            switch_state=1;
                            ChangeState(8,temp_curship);
                            exit;
                          }
                        }
                        if(player_is_enemy) {
                          if((RelationToRanger(temp_curship,Player())>9) && (ShipGetBad(Player())!=temp_curship) && (ShipGetBad(Player())!=ship_to_guard) && (ShipGetBad(ship_to_guard)!=Player())) {
                            switch_state=1;
                            ChangeState(6,temp_curship);
                            exit;
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            if(switch_state) {
              switch_state=0;
            }
        >>>
    }
    Delivery ~{
        Type=None
        Attack ~{
            0=GroupEnemies
        }
        TakeItem=
        TakeAll=False
        OutMsg=DialogMission
        InMsg=DialogMission
        Ether=
        Code=<<<
            if(!switch_state) {
              player_is_enemy=0;
              counter=0;
              while (fem_id[counter]!=Id(CurShip)){counter=counter+1;}
              ship_num=counter;
              if(GetShipPlanet(CurShip)) {
                ShipRefuel(CurShip);
                ShipRepairEq(CurShip);
                OrderTakeOff(CurShip);
                if(Id(GetShipPlanet(CurShip))==quest_data1[ship_num]) {
                  quest_data1[ship_num]=0;
                  quest_data2[ship_num]=0;
                  OrderLock(CurShip,0);
                  counter=ShipItems(CurShip)-1;
                  while (counter>0){
                  if (ItemType(ShipItems(CurShip,counter))==t_UselessItem){FreeItem(GetItemFromShip(CurShip,counter));}
                  counter=counter-1;}
                  roll=((CurTurn()+Id(CurShip)+Id(GetShipPlanet(CurShip)))/30)%1000;
                  if(roll<500) {
                    ShipMoney(CurShip,ShipMoney(CurShip)+GalaxyMoney(4));
                    ChangeState(2);
                    exit;
                  }
                  if((roll>=500) && (roll<900)) {
                    BuildListOfMMByPriority(bonus_mm,100-5*GalaxyTechLevel(),80-10*GalaxyTechLevel());
                    counter=0;
                    AddItemToShip(CurShip,CreateMM(bonus_mm[((CurTurn()+Id(CurShip))/31)%ArrayDim(bonus_mm)]));
                    ChangeState(2);
                    exit;
                  }
                  if(roll>=900) {
                    AddItemToShip(CurShip,CreateArt(bonus_arts[((CurTurn()+Id(CurShip))/23)%ArrayDim(bonus_arts)],PlanetRace(GetShipPlanet(CurShip))));
                    ChangeState(2);
                    exit;
                  }
                }
              }
              if((!StarOwner(PlanetToStar(IdToPlanet(quest_data1[ship_num])))) && (!StarOwner(ShipStar(CurShip)))) {
                if(ShipInNormalSpace(CurShip)) {
                  OrderForsage(CurShip,ShipInFear(CurShip));
                  if(ShipStar(CurShip)==PlanetToStar(IdToPlanet(quest_data1[ship_num]))) {
                    OrderLanding(CurShip,IdToPlanet(quest_data1[ship_num]),1);
                  }
                  if(ShipStar(CurShip)!=PlanetToStar(IdToPlanet(quest_data1[ship_num]))) {
                    if(ShipFuelLow(CurShip)) {
                      OrderLanding(CurShip,NearCivilPlanet(CurShip),1);
                    }
                    if(!ShipFuelLow(CurShip)) {
                      quest_star=PlanetToStar(IdToPlanet(quest_data1[ship_num]));
                      prev_dist=Dist(quest_star,ShipStar(CurShip));
                      prev_dist2=prev_dist;
                      cycle_flag=0;
                      if (!ShipCanJump(CurShip,quest_star,ShipStar(CurShip))){cycle_flag=1;}
                      while (cycle_flag){
                      counter=BuildListOfQuestPossibleLocations(locations,ShipStar(CurShip),1,255);
                      if (counter){counter=StarListToTransitPlanetList(locations,ShipStar(CurShip),quest_star,255);}
                      quest_star=0;
                      if (counter){quest_star=PlanetToStar(locations[0]);}
                      if (quest_star){if ((Dist(quest_star,ShipStar(CurShip))>=prev_dist) || (Dist(quest_star,PlanetToStar(IdToPlanet(quest_data1[ship_num])))>=prev_dist2)){quest_star=0;}}
                      if (quest_star){prev_dist=Dist(quest_star,ShipStar(CurShip));
                      if (ShipCanJump(CurShip,quest_star,ShipStar(CurShip))){cycle_flag=0;}}
                      if (!quest_star){cycle_flag=0;}
                      }
                      if(quest_star) {
                        OrderJump(CurShip,quest_star,1);
                      }
                      if(!quest_star) {
                        counter=ShipItems(CurShip)-1;
                        while (counter>0){
                        if (ItemType(ShipItems(CurShip,counter))==t_UselessItem){FreeItem(GetItemFromShip(CurShip,counter));}
                        counter=counter-1;}
                        quest_data1[ship_num]=0;
                        quest_data2[ship_num]=0;
                        OrderLock(CurShip,0);
                        temp_curship=CurShip;
                        ShipFreeFlight(CurShip);
                        ChangeState(3,temp_curship);
                        exit;
                      }
                    }
                  }
                  counter=0;
                  ArrayClear(new_enemies);
                  while (counter<StarShips(ShipStar(CurShip))){
                  quest_ship=StarShips(ShipStar(CurShip),counter);
                  if (!ShipInScript(quest_ship) &&  (quest_ship!=Player())){
                  if (ShipGetBad(quest_ship)==CurShip){
                  ArrayAdd(new_enemies,quest_ship);
                  }}
                  counter=counter+1;}
                  temp_curship=CurShip;
                  while(ArrayDim(new_enemies)>1) {
                    ArrayAdd(enemy_id,Id(new_enemies[1]));
                    ShipJoin(GroupEnemies,new_enemies[1]);
                    ArrayDelete(new_enemies,1);
                  }
                  if(!player_is_enemy) {
                    if((RelationToRanger(temp_curship,Player())<10) || (ShipGetBad(Player())==temp_curship)) {
                      switch_state=1;
                      ChangeState(10,temp_curship);
                      player_is_enemy=0;
                      exit;
                    }
                  }
                  if(player_is_enemy) {
                    if((RelationToRanger(temp_curship,Player())>=10) && (ShipGetBad(Player())!=temp_curship)) {
                      switch_state=1;
                      ChangeState(9,temp_curship);
                      player_is_enemy=1;
                      exit;
                    }
                  }
                }
              }
              if((StarOwner(PlanetToStar(IdToPlanet(quest_data1[ship_num])))) || (StarOwner(ShipStar(CurShip)))) {
                counter=ShipItems(CurShip)-1;
                while (counter>0){
                if (ItemType(ShipItems(CurShip,counter))==t_UselessItem){FreeItem(GetItemFromShip(CurShip,counter));}
                counter=counter-1;}
                quest_data1[ship_num]=0;
                quest_data2[ship_num]=0;
                OrderLock(CurShip,0);
                temp_curship=CurShip;
                ShipFreeFlight(CurShip);
                ChangeState(3,temp_curship);
                exit;
              }
            }
            if(switch_state) {
              switch_state=0;
            }
        >>>
    }
    DeliveryVsPlayer ~{
        Type=None
        Attack ~{
            0=GroupEnemies
            1=GroupNew
        }
        TakeItem=
        TakeAll=False
        OutMsg=DialogMission
        InMsg=DialogMission
        Ether=
        Code=<<<
            if(!switch_state) {
              player_is_enemy=1;
              counter=0;
              while (fem_id[counter]!=Id(CurShip)){counter=counter+1;}
              ship_num=counter;
              if(GetShipPlanet(CurShip)) {
                ShipRefuel(CurShip);
                ShipRepairEq(CurShip);
                OrderTakeOff(CurShip);
                if(Id(GetShipPlanet(CurShip))==quest_data1[ship_num]) {
                  quest_data1[ship_num]=0;
                  quest_data2[ship_num]=0;
                  OrderLock(CurShip,0);
                  counter=ShipItems(CurShip)-1;
                  while (counter>0){
                  if (ItemType(ShipItems(CurShip,counter))==t_UselessItem){FreeItem(GetItemFromShip(CurShip,counter));}
                  counter=counter-1;}
                  roll=((CurTurn()+Id(CurShip)+Id(GetShipPlanet(CurShip)))/30)%1000;
                  if(roll<500) {
                    ShipMoney(CurShip,ShipMoney(CurShip)+GalaxyMoney(4));
                    ChangeState(2);
                    exit;
                  }
                  if((roll>=500) && (roll<900)) {
                    BuildListOfMMByPriority(bonus_mm,100-5*GalaxyTechLevel(),80-10*GalaxyTechLevel());
                    counter=0;
                    AddItemToShip(CurShip,CreateMM(bonus_mm[((CurTurn()+Id(CurShip))/31)%ArrayDim(bonus_mm)]));
                    ChangeState(2);
                    exit;
                  }
                  if(roll>=900) {
                    AddItemToShip(CurShip,CreateArt(bonus_arts[((CurTurn()+Id(CurShip))/23)%ArrayDim(bonus_arts)],PlanetRace(GetShipPlanet(CurShip))));
                    ChangeState(2);
                    exit;
                  }
                }
              }
              if((!StarOwner(PlanetToStar(IdToPlanet(quest_data1[ship_num])))) && (!StarOwner(ShipStar(CurShip)))) {
                if(ShipInNormalSpace(CurShip)) {
                  OrderForsage(CurShip,ShipInFear(CurShip));
                  if(ShipStar(CurShip)==PlanetToStar(IdToPlanet(quest_data1[ship_num]))) {
                    OrderLanding(CurShip,IdToPlanet(quest_data1[ship_num]),1);
                  }
                  if(ShipStar(CurShip)!=PlanetToStar(IdToPlanet(quest_data1[ship_num]))) {
                    if(ShipFuelLow(CurShip)) {
                      OrderLanding(CurShip,NearCivilPlanet(CurShip),1);
                    }
                    if(!ShipFuelLow(CurShip)) {
                      quest_star=PlanetToStar(IdToPlanet(quest_data1[ship_num]));
                      prev_dist=Dist(quest_star,ShipStar(CurShip));
                      prev_dist2=prev_dist;
                      cycle_flag=0;
                      if (!ShipCanJump(CurShip,quest_star,ShipStar(CurShip))){cycle_flag=1;}
                      while (cycle_flag){
                      counter=BuildListOfQuestPossibleLocations(locations,ShipStar(CurShip),1,255);
                      if (counter){counter=StarListToTransitPlanetList(locations,ShipStar(CurShip),quest_star,255);}
                      quest_star=0;
                      if (counter){quest_star=PlanetToStar(locations[0]);}
                      if (quest_star){if ((Dist(quest_star,ShipStar(CurShip))>=prev_dist) || (Dist(quest_star,PlanetToStar(IdToPlanet(quest_data1[ship_num])))>=prev_dist2)){quest_star=0;}}
                      if (quest_star){prev_dist=Dist(quest_star,ShipStar(CurShip));
                      if (ShipCanJump(CurShip,quest_star,ShipStar(CurShip))){cycle_flag=0;}}
                      if (!quest_star){cycle_flag=0;}
                      }
                      if(quest_star) {
                        OrderJump(CurShip,quest_star,1);
                      }
                      if(!quest_star) {
                        counter=ShipItems(CurShip)-1;
                        while (counter>0){
                        if (ItemType(ShipItems(CurShip,counter))==t_UselessItem){FreeItem(GetItemFromShip(CurShip,counter));}
                        counter=counter-1;}
                        quest_data1[ship_num]=0;
                        quest_data2[ship_num]=0;
                        OrderLock(CurShip,0);
                        temp_curship=CurShip;
                        ShipFreeFlight(CurShip);
                        ChangeState(3,temp_curship);
                        exit;
                      }
                    }
                  }
                  counter=0;
                  ArrayClear(new_enemies);
                  while (counter<StarShips(ShipStar(CurShip))){
                  quest_ship=StarShips(ShipStar(CurShip),counter);
                  if (!ShipInScript(quest_ship) &&  (quest_ship!=Player())){
                  if (ShipGetBad(quest_ship)==CurShip){
                  ArrayAdd(new_enemies,quest_ship);
                  }}
                  counter=counter+1;}
                  temp_curship=CurShip;
                  while(ArrayDim(new_enemies)>1) {
                    ArrayAdd(enemy_id,Id(new_enemies[1]));
                    ShipJoin(GroupEnemies,new_enemies[1]);
                    ArrayDelete(new_enemies,1);
                  }
                  if(!player_is_enemy) {
                    if((RelationToRanger(temp_curship,Player())<10) || (ShipGetBad(Player())==temp_curship)) {
                      switch_state=1;
                      ChangeState(10,temp_curship);
                      player_is_enemy=0;
                      exit;
                    }
                  }
                  if(player_is_enemy) {
                    if((RelationToRanger(temp_curship,Player())>=10) && (ShipGetBad(Player())!=temp_curship)) {
                      switch_state=1;
                      ChangeState(9,temp_curship);
                      player_is_enemy=1;
                      exit;
                    }
                  }
                }
              }
              if((StarOwner(PlanetToStar(IdToPlanet(quest_data1[ship_num])))) || (StarOwner(ShipStar(CurShip)))) {
                counter=ShipItems(CurShip)-1;
                while (counter>0){
                if (ItemType(ShipItems(CurShip,counter))==t_UselessItem){FreeItem(GetItemFromShip(CurShip,counter));}
                counter=counter-1;}
                quest_data1[ship_num]=0;
                quest_data2[ship_num]=0;
                OrderLock(CurShip,0);
                temp_curship=CurShip;
                ShipFreeFlight(CurShip);
                ChangeState(3,temp_curship);
                exit;
              }
            }
            if(switch_state) {
              switch_state=0;
            }
        >>>
    }
    StateFree ~{
        Type=Free
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            if(quest_status==5) {
              if(RelationToRanger(CurShip,Player())<10) {
                //mission fail
                quest_status=6;
                counter=0;
                while (counter<StarPlanets(ShipStar(CurShip))){
                quest_planet=StarPlanets(ShipStar(CurShip),counter);
                if (PlanetOwner(quest_planet)<5){RelationToRanger(quest_planet,Player(),0);}
                counter=counter+1;}
                Ether(5,'FCDE615A-FE54-42CF-81DE-3A8BBE79E500',Format(CT("Script.PC_fem_rangers.176"),"<0>",observe_days,"<1>",GameDateTxtByTurn(observe_start),"<2>",Name(GroupToShip(GroupDiplo))),GroupToShip(GroupDiplo));
                Ether(1,'35E26C81-78DE-4932-BED8-05A537F347A8',Format(CT("Script.PC_fem_rangers.247"),"<0>",Name(CurShip),"<1>",ShipName(Player())),CurShip,Player());
              }
              if(last_turn_diplo<CurTurn()) {
                if(last_turn_in_space && GetShipPlanet(CurShip)) {
                  ArrayAdd(visited_planets_list,Id(GetShipPlanet(CurShip)));
                }
                if(GetShipPlanet(CurShip)) {
                  ShipRefuel(CurShip);
                  ShipRepairEq(CurShip);
                }
                if(Id(ShipStar(CurShip))!=last_star) {
                  last_star=Id(ShipStar(CurShip));
                  if (ArrayFind(visited_stars_list,last_star)<0){ArrayAdd(visited_stars_list,last_star);}
                  if (ArrayFind(nearby_stars_list,last_star)<0){ArrayAdd(nearby_stars_list,last_star);}
                  counter=1;
                  while (counter<6){
                  quest_star=StarNearbyStars(ShipStar(CurShip),counter);
                  if (StarOwner(quest_star)==0){
                  if (ArrayFind(nearby_stars_list,Id(quest_star))<0){
                  ArrayAdd(nearby_stars_list,Id(quest_star));}}
                  counter=counter+1;}
                }
                if(ShipStar(CurShip)==ShipStar(Player())) {
                  turns_without_player=0;
                  turns_under_surv=turns_under_surv+1;
                  if(ShipInNormalSpace(CurShip) && ShipInNormalSpace(Player())) {
                    counter=0;
                    ArrayClear(nearby_ships_list);
                    while (counter<StarShips(ShipStar(CurShip))){
                    quest_ship=StarShips(ShipStar(CurShip),counter);
                    if (ShipInNormalSpace(quest_ship)){
                    if (Dist(quest_ship,CurShip)<3000){
                    if (Name(quest_ship)!=suspicious_ship_name){
                    if ((ShipTypeN(quest_ship)==t_Transport) || (ShipTypeN(quest_ship)==t_Pirate)){
                    if ((ShipGetBad(CurShip)!=quest_ship) && (ShipGetBad(quest_ship)!=CurShip)){
                    if (ShipIsPartner(quest_ship)!=Player()){
                    if (!ShipInScript(quest_ship)){
                    if (!ShipInFear(quest_ship) || (HullDamage(quest_ship)<50)){
                    ArrayAdd(nearby_ships_list,quest_ship);}}}}}}}
                    }
                    counter=counter+1;}
                    counter=1;
                    while (counter<ArrayDim(nearby_ships_list)){
                    if (ArrayFind(suspicious_ships_list,Name(nearby_ships_list[counter]))==-1){
                    ArrayAdd(suspicious_ships_list,Name(nearby_ships_list[counter]));}
                    counter=counter+1;}
                    if((suspicious_ship_id==0)&& (ArrayDim(nearby_ships_list)>1) && ((Rnd(1,25)+ArrayDim(nearby_ships_list)+(CurTurn()-observe_start-observe_days/2))>50)) {
                      quest_ship=nearby_ships_list[1+Rnd(1,1000)%(ArrayDim(nearby_ships_list)-1)];
                      suspicious_ship_id=Id(quest_ship);
                      suspicious_ship_name=Name(quest_ship);
                      if (ArrayFind(suspicious_ships_list,suspicious_ship_name)>=0){
                      ArrayDelete(suspicious_ships_list,ArrayFind(suspicious_ships_list,suspicious_ship_name));}
                      Ether(1,'65537A69-9A2C-4801-A5A6-9E66188E9A07',Format(CT("Script.PC_fem_rangers.334"),"<0>",Name(quest_ship),"<1>",Name(CurShip),"<2>",Name(CurShip),"<3>",Name(quest_ship),"<4>",Name(quest_ship),"<5>",Name(CurShip),"<6>",Name(CurShip),"<7>",Name(quest_ship),"<8>",Name(quest_ship),"<9>",Name(CurShip),"<10>",Name(CurShip),"<11>",Name(quest_ship)),CurShip,quest_ship);
                    }
                    if((Dist(CurShip,Player())<500) && !(ShipGetBad(CurShip) && (ShipGetBad(CurShip)==ShipGetBad(Player())))) {
                      turns_near_player=turns_near_player+1;
                      if((turns_near_player>=5) && !diplo_annoy) {
                        Dialog(DialogDiploSuspects,CurShip);
                      }
                      if((turns_near_player>=3) && (diplo_annoy==1)) {
                        Dialog(DialogDiploAngry,CurShip);
                      }
                      if((turns_near_player>=3) && (diplo_annoy>=1)) {
                        quest_status=6;
                        counter=0;
                        while (counter<StarPlanets(ShipStar(CurShip))){
                        quest_planet=StarPlanets(ShipStar(CurShip),counter);
                        if (PlanetOwner(quest_planet)<5){RelationToRanger(quest_planet,Player(),0);}
                        counter=counter+1;}
                        Ether(5,'FCDE615A-FE54-42CF-81DE-3A8BBE79E500',Format(CT("Script.PC_fem_rangers.176"),"<0>",observe_days,"<1>",GameDateTxtByTurn(observe_start),"<2>",Name(GroupToShip(GroupDiplo))),GroupToShip(GroupDiplo));
                        Ether(1,'E29AAD39-D684-40B3-BF11-DACE22FC82CF',Format(CT("Script.PC_fem_rangers.246"),"<0>",Name(CurShip),"<1>",ShipName(Player())),CurShip,Player());
                      }
                    }
                    if((Dist(CurShip,Player())>=500) || (ShipGetBad(CurShip) && (ShipGetBad(CurShip)==ShipGetBad(Player())))) {
                      turns_near_player=0;
                    }
                  }
                }
                if((ShipInNormalSpace(CurShip) || !ShipInNormalSpace(Player())) && (CurTurn()>observe_start+observe_days)) {
                  quest_status=8;
                  Ether(0,'84B929AB-9806-4D6E-B5FA-F63DD9D67063',CT("Script.PC_fem_rangers.204"));
                  Ether(3,'FCDE615A-FE54-42CF-81DE-3A8BBE79E500',Format(CT("Script.PC_fem_rangers.203"),"<0>",Name(CurShip)));
                }
                if(ShipStar(CurShip)!=ShipStar(Player())) {
                  turns_without_player=turns_without_player+1;
                  if((turns_without_player>15) && (suspicious_ship_id==0)) {
                    suspicious_ship_id=-1;
                    report_failed=1;
                  }
                }
                last_turn_in_space=ShipInNormalSpace(CurShip);
                last_turn_diplo=CurTurn();
                if (RelationToRanger(CurShip,Player())>50-diplo_annoy*10){RelationToRanger(CurShip,Player(),50-diplo_annoy*10);}
              }
            }
            if((quest_status!=5) && (ShipStar(CurShip)!=ShipStar(Player())) && GetShipPlanet(CurShip)) {
              ShipDestroy(CurShip);
              OrderLock(CurShip,1);
              OrderNone(CurShip);
            }
        >>>
    }
    StateInit ~{
        Type=None
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            NoTargetToShip(CurShip,2);
            OrderLock(CurShip,1);
            OrderTakeOff(CurShip);
            goods_type=5+Rnd(1,1000)%3;
            GoodsAdd(CurShip,goods_type,ShipFreeSpace(CurShip));
            turns_near_player=0;
            supply_annoy=0;
            counter=2;
            quest_star=StarNearbyStars(ShipStar(CurShip),1);
            while ((counter<GalaxyStars()) && ShipCanJump(CurShip,ShipStar(CurShip),quest_star)  && 
            (StarOwner(quest_star) || !SectorVisible(StarToCon(quest_star)))){
            quest_star=StarNearbyStars(ShipStar(CurShip),counter);
            counter=counter+1;}
            if (counter>=GalaxyStars()){quest_star=0;}
            if (quest_star){
            if (!ShipCanJump(CurShip,ShipStar(CurShip),quest_star)){quest_star=0;}}
            if(quest_star) {
              star_dest=Id(quest_star);
              ChangeState(13);
              exit;
            }
            if(!quest_star) {
              quest_status=12;
              NoTargetToShip(CurShip,0);
              OrderLock(CurShip,0);
              ShipOut(CurShip);
              ShipFreeFlight(CurShip);
              Ether(5,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',CT("Script.PC_fem_rangers.309"));
            }
        >>>
    }
    StateFirstJump ~{
        Type=Free
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=DialogSupply
        InMsg=DialogSupply
        Ether=
        Code=<<<
            if(ShipInNormalSpace(CurShip)) {
              if(ShipStar(CurShip)==GalaxyStar(star_dest-1)) {
                if(StarOwner(ShipStar(CurShip))==0) {
                  OrderLanding(CurShip,NearCivilPlanet(CurShip),1);
                }
              }
            }
            if(GetShipPlanet(CurShip)) {
              if(Id(GetShipPlanet(CurShip))!=planet_supply) {
                ShipRefuel(CurShip);
                ShipRepairEq(CurShip);
                if(ShipStar(CurShip)!=ShipStar(Player())) {
                  OrderNone(CurShip);
                  ShipDestroy(CurShip);
                }
                if(ShipStar(CurShip)==ShipStar(Player())) {
                  star_prev=star_dest;
                  counter=2;
                  quest_star=StarNearbyStars(ShipStar(CurShip),1);
                  while ((counter<GalaxyStars()) && ShipCanJump(CurShip,ShipStar(CurShip),quest_star)  && ((Dist(ShipStar(CurShip),GalaxyStar(supply_system-1))>Dist(quest_star,GalaxyStar(supply_system-1))) || StarOwner(quest_star) || !SectorVisible(StarToCon(quest_star)))){
                  quest_star=StarNearbyStars(ShipStar(CurShip),counter);
                  counter=counter+1;}
                  if (counter>=GalaxyStars()){quest_star=0;}
                  if (!ShipCanJump(CurShip,ShipStar(CurShip),quest_star)){quest_star=0;}
                  if (!quest_star){
                  counter=2;
                  quest_star=StarNearbyStars(ShipStar(CurShip),1);
                  while ((counter<GalaxyStars()) && ShipCanJump(CurShip,ShipStar(CurShip),quest_star)  && ((1>Dist(quest_star,GalaxyStar(supply_system-1))) || StarOwner(quest_star) || !SectorVisible(StarToCon(quest_star)))){
                  quest_star=StarNearbyStars(ShipStar(CurShip),counter);
                  counter=counter+1;}
                  if (counter>=GalaxyStars()){quest_star=0;}
                  if (!ShipCanJump(CurShip,ShipStar(CurShip),quest_star)){quest_star=0;}
                  }
                  if (!quest_star){
                  counter=2;
                  quest_star=StarNearbyStars(ShipStar(CurShip),1);
                  while ((counter<GalaxyStars()) && ShipCanJump(CurShip,ShipStar(CurShip),quest_star)  && (StarOwner(quest_star) || !SectorVisible(StarToCon(quest_star)))){
                  quest_star=StarNearbyStars(ShipStar(CurShip),counter);
                  counter=counter+1;}
                  if (counter>=GalaxyStars()){quest_star=0;}
                  if (!ShipCanJump(CurShip,ShipStar(CurShip),quest_star)){quest_star=0;}
                  }
                  if(!quest_star) {
                    NoTargetToShip(CurShip,0);
                    OrderLock(CurShip,0);
                    OrderTakeOff(CurShip);
                    GoodsAdd(CurShip,5,-GoodsCount(CurShip,5));
                    GoodsAdd(CurShip,6,-GoodsCount(CurShip,6));
                    GoodsAdd(CurShip,7,-GoodsCount(CurShip,7));
                    ShipOut(CurShip);
                    if((ShipStar(CurShip)==ShipStar(Player())) && (quest_status!=12)) {
                      Ether(0,'8067CE23-4AF1-4DF8-81B3-4A76095AB632',Format(CT("Script.PC_fem_rangers.310"),"<0>",ShipName(Player()),"<1>",Name(GetShipPlanet(CurShip)),"<2>",Name(CurShip)));
                    }
                  }
                  if(quest_star) {
                    star_dest=Id(quest_star);
                    OrderTakeOff(CurShip);
                    GoodsAdd(CurShip,0,-GoodsCount(CurShip,0));
                    GoodsAdd(CurShip,1,-GoodsCount(CurShip,1));
                    GoodsAdd(CurShip,2,-GoodsCount(CurShip,2));
                    GoodsAdd(CurShip,3,-GoodsCount(CurShip,3));
                    GoodsAdd(CurShip,4,-GoodsCount(CurShip,4));
                    GoodsAdd(CurShip,5,-GoodsCount(CurShip,5));
                    GoodsAdd(CurShip,6,-GoodsCount(CurShip,6));
                    GoodsAdd(CurShip,7,-GoodsCount(CurShip,7));
                    GoodsAdd(CurShip,goods_type,ShipFreeSpace(CurShip));
                    ChangeState(14);
                    exit;
                  }
                }
              }
              if(Id(GetShipPlanet(CurShip))==planet_supply) {
                ShipRefuel(CurShip);
                ShipRepairEq(CurShip);
                OrderTakeOff(CurShip);
              }
            }
            if(!GroupCount(GroupShuCenter)) {
              if(ShipInNormalSpace(CurShip)) {
                if(ShipStar(CurShip)==GalaxyStar(star_dest-1)) {
                  if(StarOwner(ShipStar(CurShip))!=0) {
                    NoTargetToShip(CurShip,0);
                    OrderLock(CurShip,0);
                    OrderMove(CurShip,CoordX(CurShip)+Rnd(-50,50),CoordY(CurShip)+Rnd(-50,50));
                    ShipOut(CurShip);
                    if((ShipStar(CurShip)==ShipStar(Player())) && ShipInNormalSpace(Player()) && (quest_status!=12)) {
                      Ether(0,'E15FBDD1-2481-4609-B42D-872F115E5FE1',Format(CT("Script.PC_fem_rangers.287"),"<0>",Name(ShipStar(CurShip))));
                    }
                  }
                }
                if(ShipStar(CurShip)!=GalaxyStar(star_dest-1)) {
                  OrderJump(CurShip,GalaxyStar(star_dest-1),1);
                  ShipOrderData1(CurShip,ShipOrderData1(CurShip)+1);
                }
              }
              if(ShipStar(CurShip)==ShipStar(Player())) {
                if(ShipInNormalSpace(CurShip) && ShipInNormalSpace(Player()) && (quest_status==11)) {
                  if(RelationToRanger(CurShip,Player())<10) {
                    quest_status=12;
                    RelationToRanger(CurShip,Player(),0);
                    NoTargetToShip(CurShip,0);
                    OrderLock(CurShip,0);
                    ShipOut(CurShip);
                    ShipFreeFlight(CurShip);
                    Ether(5,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',CT("Script.PC_fem_rangers.324"));
                  }
                  if((Dist(CurShip,Player())<500) && !(ShipGetBad(CurShip) && (ShipGetBad(CurShip)==ShipGetBad(Player())))) {
                    turns_near_player=turns_near_player+1;
                    if(supply_annoy && (turns_near_player>=3)) {
                      quest_status=12;
                      RelationToRanger(CurShip,Player(),0);
                      NoTargetToShip(CurShip,0);
                      OrderLock(CurShip,0);
                      //OrderNone(CurShip,0);
                      ShipOut(CurShip);
                      ShipFreeFlight(CurShip);
                      Ether(5,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',CT("Script.PC_fem_rangers.323"));
                    }
                    if(!supply_annoy && (turns_near_player>=5)) {
                      Dialog(DialogWarningSupply,CurShip);
                    }
                  }
                  if((Dist(CurShip,Player())>=500) || (ShipGetBad(CurShip) && (ShipGetBad(CurShip)==ShipGetBad(Player())))) {
                    turns_near_player=0;
                  }
                }
              }
            }
        >>>
    }
    StateSecondJump ~{
        Type=Free
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=DialogSupply
        InMsg=DialogSupply
        Ether=
        Code=<<<
            if(!GroupCount(GroupShuCenter)) {
              if(ShipInNormalSpace(CurShip)) {
                if(ShipStar(CurShip)==GalaxyStar(star_dest-1)) {
                  if(StarOwner(ShipStar(CurShip))!=0) {
                    NoTargetToShip(CurShip,0);
                    OrderLock(CurShip,0);
                    OrderMove(CurShip,CoordX(CurShip)+Rnd(-50,50),CoordY(CurShip)+Rnd(-50,50));
                    ShipOut(CurShip);
                    if((ShipStar(CurShip)==ShipStar(Player())) && ShipInNormalSpace(Player()) && (quest_status!=12)) {
                      Ether(0,'E15FBDD1-2481-4609-B42D-872F115E5FE1',Format(CT("Script.PC_fem_rangers.287"),"<0>",Name(ShipStar(CurShip))));
                    }
                  }
                }
                if(ShipStar(CurShip)!=GalaxyStar(star_dest-1)) {
                  OrderJump(CurShip,GalaxyStar(star_dest-1),1);
                  ShipOrderData1(CurShip,ShipOrderData1(CurShip)+1);
                }
              }
              if(ShipStar(CurShip)==ShipStar(Player())) {
                if(ShipInNormalSpace(CurShip) && ShipInNormalSpace(Player()) && (quest_status==11)) {
                  if(RelationToRanger(CurShip,Player())<10) {
                    quest_status=12;
                    RelationToRanger(CurShip,Player(),0);
                    NoTargetToShip(CurShip,0);
                    OrderLock(CurShip,0);
                    ShipOut(CurShip);
                    ShipFreeFlight(CurShip);
                    Ether(5,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',CT("Script.PC_fem_rangers.324"));
                  }
                  if((Dist(CurShip,Player())<500) && !(ShipGetBad(CurShip) && (ShipGetBad(CurShip)==ShipGetBad(Player())))) {
                    turns_near_player=turns_near_player+1;
                    if(supply_annoy && (turns_near_player>=3)) {
                      quest_status=12;
                      RelationToRanger(CurShip,Player(),0);
                      NoTargetToShip(CurShip,0);
                      OrderLock(CurShip,0);
                      //OrderNone(CurShip,0);
                      ShipOut(CurShip);
                      ShipFreeFlight(CurShip);
                      Ether(5,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',CT("Script.PC_fem_rangers.323"));
                    }
                    if(!supply_annoy && (turns_near_player>=5)) {
                      Dialog(DialogWarningSupply,CurShip);
                    }
                  }
                  if((Dist(CurShip,Player())>=500) || (ShipGetBad(CurShip) && (ShipGetBad(CurShip)==ShipGetBad(Player())))) {
                    turns_near_player=0;
                  }
                }
              }
            }
            if(ShipStar(CurShip)==GalaxyStar(star_dest-1)) {
              if(ShipInNormalSpace(CurShip)) {
                if(GroupCount(GroupShuCenter)) {
                  OrderLanding(CurShip,GroupToShip(GroupShuCenter),1);
                  if(quest_status==12) {
                    OrderNone(CurShip);
                    OrderLock(CurShip,0);
                    NoTargetToShip(CurShip,0);
                    ShipOut(CurShip);
                    ShipFreeFlight(CurShip);
                  }
                }
                if(!GroupCount(GroupShuCenter)) {
                  if((ShipStar(Player())==GalaxyStar(star_dest-1)) && ShipInHyperSpace(Player()) && (StarOwner(ShipStar(CurShip))==0 ) && (quest_status!=12)) {
                    if((quest_status==13) || (quest_status==14)) {
                      OrderNone(CurShip);
                      OrderLock(CurShip,0);
                      NoTargetToShip(CurShip,0);
                      ShipOut(CurShip);
                      ShipFreeFlight(CurShip);
                    }
                    if((quest_status!=13) && (quest_status!=14)) {
                      OrderNone(CurShip);
                      quest_ship=BuildRuins(GalaxyStar(star_dest-1),t_BK);
                      if (ShipFreeSpace(quest_ship)<200){ItemSize(ShipItems(quest_ship,0),ItemSize(ShipItems(quest_ship,0))+200-ShipFreeSpace(quest_ship));}
                      AddItemToShip(quest_ship,CreateEquipment(t_Weapon10,40,GalaxyTechLevel(),2));
                      AddItemToShip(quest_ship,CreateEquipment(t_Weapon10,40,GalaxyTechLevel(),2));
                      AddItemToShip(quest_ship,CreateEquipment(t_Weapon10,40,GalaxyTechLevel(),2));
                      AddItemToShip(quest_ship,CreateEquipment(t_Weapon10,40,GalaxyTechLevel(),2));
                      AddItemToShip(quest_ship,CreateEquipment(t_Weapon10,40,GalaxyTechLevel(),2));
                      NoLanding(quest_ship,1);
                      quest_status=13;
                      MakeShipEnterStar(quest_ship,GalaxyStar(star_dest-1),GalaxyStar(star_prev-1),1);
                      TransferShip(quest_ship,GalaxyStar(star_dest-1));
                      ShipSetCoords(quest_ship,(8*CoordX(quest_ship))/10,(8*CoordY(quest_ship))/10);
                      quest_hole=HoleCreate2(GalaxyStar(star_dest-1),GalaxyStar(star_dest-1));
                      HoleX1(quest_hole,CoordX(quest_ship));
                      HoleY1(quest_hole,100+CoordY(quest_ship));
                      HoleX2(quest_hole,HoleX1(quest_hole));
                      HoleY2(quest_hole,HoleY1(quest_hole));
                      HoleMap(quest_hole,'SkipAB');
                      hole_id=Id(quest_hole);
                      hole_create_turn=HoleTurnCreate(quest_hole);
                      ShipJoin(GroupShuCenter,quest_ship);
                      Ether(0,'216A96C2-7664-4D85-97BE-C345E191351E',Format(CT("Script.PC_fem_rangers.321"),"<0>",Name(GroupToShip(GroupShuCenter))),GroupToShip(GroupShuCenter));
                    }
                  }
                  if((ShipStar(Player())!=GalaxyStar(star_dest-1)) || !ShipInHyperSpace(Player()) || !(StarOwner(ShipStar(CurShip))==0 ) || (quest_status==12)) {
                    OrderNone(CurShip);
                    ShipDestroy(CurShip);
                  }
                }
              }
              if(ShipInHyperSpace(CurShip)) {
                if((ShipStar(Player())==GalaxyStar(star_dest-1)) && !GroupCount(GroupShuCenter)) {
                  if(ShipInHyperSpace(Player()) && (StarOwner(ShipStar(CurShip))==0 ) && (quest_status!=12)) {
                    if((quest_status!=13) && (quest_status!=14)) {
                      quest_ship=BuildRuins(GalaxyStar(star_dest-1),t_BK);
                      if (ShipFreeSpace(quest_ship)<200){ItemSize(ShipItems(quest_ship,0),ItemSize(ShipItems(quest_ship,0))+200-ShipFreeSpace(quest_ship));}
                      AddItemToShip(quest_ship,CreateEquipment(t_Weapon10,40,GalaxyTechLevel(),2));
                      AddItemToShip(quest_ship,CreateEquipment(t_Weapon10,40,GalaxyTechLevel(),2));
                      AddItemToShip(quest_ship,CreateEquipment(t_Weapon10,40,GalaxyTechLevel(),2));
                      AddItemToShip(quest_ship,CreateEquipment(t_Weapon10,40,GalaxyTechLevel(),2));
                      AddItemToShip(quest_ship,CreateEquipment(t_Weapon10,40,GalaxyTechLevel(),2));
                      NoLanding(quest_ship,1);
                      quest_status=13;
                      MakeShipEnterStar(quest_ship,GalaxyStar(star_dest-1),GalaxyStar(star_prev-1),1);
                      TransferShip(quest_ship,GalaxyStar(star_dest-1));
                      ShipSetCoords(quest_ship,(8*CoordX(quest_ship))/10,(8*CoordY(quest_ship))/10);
                      quest_hole=HoleCreate2(GalaxyStar(star_dest-1),GalaxyStar(star_dest-1));
                      HoleX1(quest_hole,CoordX(quest_ship));
                      HoleY1(quest_hole,100+CoordY(quest_ship));
                      HoleX2(quest_hole,HoleX1(quest_hole));
                      HoleY2(quest_hole,HoleY1(quest_hole));
                      HoleMap(quest_hole,'SkipAB');
                      hole_id=Id(quest_hole);
                      hole_create_turn=HoleTurnCreate(quest_hole);
                      ShipJoin(GroupShuCenter,quest_ship);
                      Ether(0,'216A96C2-7664-4D85-97BE-C345E191351E',Format(CT("Script.PC_fem_rangers.321"),"<0>",Name(GroupToShip(GroupShuCenter))),GroupToShip(GroupShuCenter));
                    }
                  }
                  if(!ShipInHyperSpace(Player())) {
                    TransferShip(CurShip,IdToPlanet(planet_supply));
                    OrderNone(CurShip);
                    ShipDestroy(CurShip);
                  }
                }
              }
              if(GetShipRuins(CurShip)) {
                OrderNone(CurShip);
                ShipDestroy(CurShip);
              }
            }
        >>>
    }
    StateWait ~{
        Type=Free
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            quest_hole=0;
            counter=0;
            while (counter<StarHoles(GalaxyStar(star_dest-1))){
            if (Id(StarHoles(GalaxyStar(star_dest-1),counter))==hole_id){
            if (HoleTurnCreate(StarHoles(GalaxyStar(star_dest-1),counter))==hole_create_turn){
            quest_hole=StarHoles(GalaxyStar(star_dest-1),counter);}}
            counter=counter+1;}
            if(quest_hole) {
              if(!ShipInHyperSpace(Player()) || (ShipOrderObj(Player())!=quest_hole)) {
                HoleTurnCreate(quest_hole,CurTurn());
                hole_create_turn=CurTurn();
                if(!GroupCount(GroupSupply)) {
                  OrderLock(CurShip,1);
                  BK_enters_BH=1;
                  ChangeState(16);
                  exit;
                }
                if(!center_warning && ShipInNormalSpace(CurShip) && ShipInNormalSpace(Player()) && (ShipStar(CurShip)==ShipStar(Player())) && (Dist(CurShip,Player())<500)) {
                  Dialog(DialogCenterWarning,CurShip);
                }
              }
              if(ShipInHyperSpace(Player()) && (ShipOrderObj(Player())==quest_hole)) {
                quest_hole=HoleCreate2(GalaxyStar(star_dest-1),GalaxyStar(star_dest-1));
                HoleX1(quest_hole,Rnd(-100,100)+CoordX(CurShip));
                HoleY1(quest_hole,Rnd(-100,100)+CoordY(CurShip));
                HoleX2(quest_hole,HoleX1(quest_hole));
                HoleY2(quest_hole,HoleY1(quest_hole));
                HoleMap(quest_hole,'SkipAB');
                hole_id=Id(quest_hole);
                hole_create_turn=HoleTurnCreate(quest_hole);
                if(center_warning) {
                  player_intruder=1;
                }
              }
            }
            if(!quest_hole) {
              quest_hole=HoleCreate2(GalaxyStar(star_dest-1),GalaxyStar(star_dest-1));
              HoleX1(quest_hole,Rnd(-100,100)+CoordX(CurShip));
              HoleY1(quest_hole,Rnd(-100,100)+CoordY(CurShip));
              HoleX2(quest_hole,HoleX1(quest_hole));
              HoleY2(quest_hole,HoleY1(quest_hole));
              HoleMap(quest_hole,'SkipAB');
              hole_id=Id(quest_hole);
              hole_create_turn=HoleTurnCreate(quest_hole);
            }
            if(player_intruder) {
              ChangeState(18);
              exit;
            }
        >>>
    }
    StateJump ~{
        Type=None
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            quest_hole=0;
            counter=0;
            while (counter<StarHoles(ShipStar(CurShip))){
            if (Id(StarHoles(ShipStar(CurShip),counter))==hole_id){
            if (HoleTurnCreate(StarHoles(ShipStar(CurShip),counter))==hole_create_turn){
            quest_hole=StarHoles(ShipStar(CurShip),counter);}}
            counter=counter+1;}
            if(quest_hole) {
              if(ShipInNormalSpace(CurShip)) {
                if(ShipInHyperSpace(Player()) && (ShipOrderObj(Player())==quest_hole)) {
                  OrderLock(CurShip,0);
                  OrderNone(CurShip);
                  BK_enters_BH=0;
                  ChangeState(15);
                  exit;
                }
                if(!ShipInHyperSpace(Player()) || !(ShipOrderObj(Player())==quest_hole)) {
                  OrderJumpHole(CurShip,quest_hole);
                  ShipOrderData1(CurShip,5);
                }
              }
            }
            if(!quest_hole) {
              ShipDestroy(CurShip);
            }
            if(player_intruder) {
              ChangeState(19);
              exit;
            }
        >>>
    }
    StateRevenge ~{
        Type=None
        Attack ~{
            0=GroupNew
        }
        TakeItem=
        TakeAll=False
        OutMsg=DialogShu
        InMsg=DialogShu
        Ether=
        Code=<<<
            if((!GetShipPlanet(Player()) && !GetShipRuins(Player())) || ShipIsTakeoff(Player())) {
              if((GetShipPlanet(CurShip) && !ShipInPrison(CurShip)) || GetShipRuins(CurShip)) {
                ShipRefuel(CurShip);
                ShipRepairEq(CurShip);
                OrderTakeOff(CurShip);
              }
              if(ShipInPrison(CurShip)) {
                OrderNone(CurShip);
              }
              if(ShipInNormalSpace(CurShip)) {
                if(ShipStar(CurShip)==ShipStar(Player())) {
                  OrderFollowShip(CurShip,Player(),1,1);
                  //ShipSetBad(CurShip,Player());
                  RelationToRanger(CurShip,Player(),0);
                }
                if(ShipStar(CurShip)!=ShipStar(Player())) {
                  if(ShipCanJump(CurShip,ShipStar(Player()),ShipStar(CurShip))) {
                    OrderJump(CurShip,ShipStar(Player()));
                  }
                  if(!ShipCanJump(CurShip,ShipStar(Player()),ShipStar(CurShip))) {
                    if(ShipFuelLow(CurShip)) {
                      if((StarOwner(ShipStar(CurShip))!=1) && (StarCustomFaction(ShipStar(CurShip))=='')) {
                        OrderLanding(CurShip,NearCivilPlanet(CurShip),1);
                      }
                      if((StarOwner(ShipStar(CurShip))==1) || (StarCustomFaction(ShipStar(CurShip))!='')) {
                        MakeShipEnterStar(CurShip,ShipStar(Player()),ShipStar(CurShip),10);
                      }
                    }
                    if(!ShipFuelLow(CurShip)) {
                      quest_star=0;
                      counter=BuildListOfQuestPossibleLocations(locations,ShipStar(CurShip),1,255);
                      if (counter){counter=StarListToTransitPlanetList(locations,ShipStar(CurShip),ShipStar(Player()),255);}
                      if (counter){quest_star=PlanetToStar(locations[0]);}
                      if(!quest_star) {
                        MakeShipEnterStar(CurShip,ShipStar(Player()),ShipStar(CurShip),10);
                      }
                      if(quest_star) {
                        OrderJump(CurShip,quest_star);
                      }
                    }
                  }
                }
              }
            }
            if((GetShipPlanet(Player()) || GetShipRuins(Player())) && !ShipIsTakeoff(Player())) {
              OrderLock(CurShip,0);
              if (ShipInPrison(CurShip)){
              OrderNone(CurShip);}
              ShipFreeFlight(CurShip);
              ChangeState(20);
              exit;
            }
        >>>
    }
    StateWaitAttack ~{
        Type=None
        Attack ~{
            0=GroupNew
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            quest_hole=0;
            counter=0;
            while (counter<StarHoles(GalaxyStar(star_dest-1))){
            if (Id(StarHoles(GalaxyStar(star_dest-1),counter))==hole_id){
            if (HoleTurnCreate(StarHoles(GalaxyStar(star_dest-1),counter))==hole_create_turn){
            quest_hole=StarHoles(GalaxyStar(star_dest-1),counter);}}
            counter=counter+1;}
            if(quest_hole) {
              if(!ShipInHyperSpace(Player()) || (ShipOrderObj(Player())!=quest_hole)) {
                HoleTurnCreate(quest_hole,CurTurn());
                hole_create_turn=CurTurn();
                if(!GroupCount(GroupSupply)) {
                  OrderLock(CurShip,1);
                  BK_enters_BH=1;
                  ChangeState(16);
                  exit;
                }
                if(!center_warning && ShipInNormalSpace(CurShip) && ShipInNormalSpace(Player()) && (ShipStar(CurShip)==ShipStar(Player())) && (Dist(CurShip,Player())<500)) {
                  Dialog(DialogCenterWarning,CurShip);
                }
              }
              if(ShipInHyperSpace(Player()) && (ShipOrderObj(Player())==quest_hole)) {
                quest_hole=HoleCreate2(GalaxyStar(star_dest-1),GalaxyStar(star_dest-1));
                HoleX1(quest_hole,Rnd(-100,100)+CoordX(CurShip));
                HoleY1(quest_hole,Rnd(-100,100)+CoordY(CurShip));
                HoleX2(quest_hole,HoleX1(quest_hole));
                HoleY2(quest_hole,HoleY1(quest_hole));
                HoleMap(quest_hole,'SkipAB');
                hole_id=Id(quest_hole);
                hole_create_turn=HoleTurnCreate(quest_hole);
                if(center_warning) {
                  player_intruder=1;
                }
              }
            }
            if(!quest_hole) {
              quest_hole=HoleCreate2(GalaxyStar(star_dest-1),GalaxyStar(star_dest-1));
              HoleX1(quest_hole,Rnd(-100,100)+CoordX(CurShip));
              HoleY1(quest_hole,Rnd(-100,100)+CoordY(CurShip));
              HoleX2(quest_hole,HoleX1(quest_hole));
              HoleY2(quest_hole,HoleY1(quest_hole));
              HoleMap(quest_hole,'SkipAB');
              hole_id=Id(quest_hole);
              hole_create_turn=HoleTurnCreate(quest_hole);
            }
        >>>
    }
    StateJumpAttack ~{
        Type=None
        Attack ~{
            0=GroupNew
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            quest_hole=0;
            counter=0;
            while (counter<StarHoles(ShipStar(CurShip))){
            if (Id(StarHoles(ShipStar(CurShip),counter))==hole_id){
            if (HoleTurnCreate(StarHoles(ShipStar(CurShip),counter))==hole_create_turn){
            quest_hole=StarHoles(ShipStar(CurShip),counter);}}
            counter=counter+1;}
            if(quest_hole) {
              if(ShipInNormalSpace(CurShip)) {
                if(ShipInHyperSpace(Player()) && (ShipOrderObj(Player())==quest_hole)) {
                  OrderLock(CurShip,0);
                  OrderNone(CurShip);
                  BK_enters_BH=0;
                  ChangeState(15);
                  exit;
                }
                if(!ShipInHyperSpace(Player()) || !(ShipOrderObj(Player())==quest_hole)) {
                  OrderJumpHole(CurShip,quest_hole);
                  ShipOrderData1(CurShip,5);
                }
              }
            }
            if(!quest_hole) {
              ShipDestroy(CurShip);
            }
        >>>
    }
    StateShuFree ~{
        Type=Free
        Attack ~{
        }
        TakeItem=
        TakeAll=False
        OutMsg=
        InMsg=
        Ether=
        Code=<<<
            if((!GetShipPlanet(Player()) && !GetShipRuins(Player())) || ShipIsTakeoff(Player())) {
              OrderLock(CurShip,1);
              ChangeState(17);
              exit;
            }
        >>>
    }
}
Dialogs ~{
    DialogHate ~{
        Code=<<<
            if(TalkByAI()) {
              if((GetTalkType()!=TalkMoney) && (GetTalkType()!=TalkGoods) && (GetTalkType()!=TalkTruce) && (GetTalkType()!=TalkAttack)) {
                if(RelationToRanger(CurShip,Player())>=10) {
                  if(player_hate) {
                    DChange(139);
                    exit;
                  }
                  if(!player_hate) {
                    DChange(140);
                    exit;
                  }
                }
                if(RelationToRanger(CurShip,Player())<10) {
                  if(player_hate) {
                    DChange(0);
                    exit;
                  }
                  if(!player_hate) {
                    DChange(138);
                    exit;
                  }
                }
              }
              if((GetTalkType()==TalkTruce)) {
                money_truce=GalaxyMoney(1);
                if(((Id(GetTalkShip())+CurTurn())%2)==0) {
                  DChange(134);
                  exit;
                }
                if(((Id(GetTalkShip())+CurTurn())%2)==1) {
                  DChange(133);
                  exit;
                }
              }
              if((GetTalkType()==TalkMoney) || (GetTalkType()==TalkGoods)) {
                if(((Id(GetTalkShip())+CurTurn())%3)==0) {
                  DChange(137);
                  exit;
                }
                if(((Id(GetTalkShip())+CurTurn())%3)==1) {
                  DChange(136);
                  exit;
                }
                if(((Id(GetTalkShip())+CurTurn())%3)==2) {
                  DChange(135);
                  exit;
                }
              }
              if((GetTalkType()==TalkAttack)) {
                if((RelationToRanger(CurShip,Player())>=10) && (ShipOrderObj(CurShip)!=0)) {
                  DChange(141);
                  exit;
                }
                if((RelationToRanger(CurShip,Player())<10) || (ShipOrderObj(CurShip)==0)) {
                  DChange(132);
                  exit;
                }
              }
            }
            if(!TalkByAI()) {
              if(RelationToRanger(CurShip,Player())>=10) {
                if(player_hate) {
                  DChange(139);
                  exit;
                }
                if(!player_hate) {
                  DChange(140);
                  exit;
                }
              }
              if(RelationToRanger(CurShip,Player())<10) {
                if(player_hate) {
                  DChange(0);
                  exit;
                }
                if(!player_hate) {
                  DChange(138);
                  exit;
                }
              }
            }
        >>>
    }
    DialogMission ~{
        Code=<<<
            if(max_relation<10) {
              if(TalkByAI()) {
                if((GetTalkType()!=TalkMoney) && (GetTalkType()!=TalkGoods) && (GetTalkType()!=TalkTruce) && (GetTalkType()!=TalkAttack)) {
                  if(RelationToRanger(CurShip,Player())>=10) {
                    if(player_hate) {
                      DChange(139);
                      exit;
                    }
                    if(!player_hate) {
                      DChange(140);
                      exit;
                    }
                  }
                  if(RelationToRanger(CurShip,Player())<10) {
                    if(player_hate) {
                      DChange(0);
                      exit;
                    }
                    if(!player_hate) {
                      DChange(138);
                      exit;
                    }
                  }
                }
                if((GetTalkType()==TalkTruce)) {
                  money_truce=GalaxyMoney(1);
                  if(((Id(GetTalkShip())+CurTurn())%2)==0) {
                    DChange(134);
                    exit;
                  }
                  if(((Id(GetTalkShip())+CurTurn())%2)==1) {
                    DChange(133);
                    exit;
                  }
                }
                if((GetTalkType()==TalkMoney) || (GetTalkType()==TalkGoods)) {
                  if(((Id(GetTalkShip())+CurTurn())%3)==0) {
                    DChange(137);
                    exit;
                  }
                  if(((Id(GetTalkShip())+CurTurn())%3)==1) {
                    DChange(136);
                    exit;
                  }
                  if(((Id(GetTalkShip())+CurTurn())%3)==2) {
                    DChange(135);
                    exit;
                  }
                }
                if((GetTalkType()==TalkAttack)) {
                  if((RelationToRanger(CurShip,Player())>=10) && (ShipOrderObj(CurShip)!=0)) {
                    DChange(141);
                    exit;
                  }
                  if((RelationToRanger(CurShip,Player())<10) || (ShipOrderObj(CurShip)==0)) {
                    DChange(132);
                    exit;
                  }
                }
              }
              if(!TalkByAI()) {
                if(RelationToRanger(CurShip,Player())>=10) {
                  if(player_hate) {
                    DChange(139);
                    exit;
                  }
                  if(!player_hate) {
                    DChange(140);
                    exit;
                  }
                }
                if(RelationToRanger(CurShip,Player())<10) {
                  if(player_hate) {
                    DChange(0);
                    exit;
                  }
                  if(!player_hate) {
                    DChange(138);
                    exit;
                  }
                }
              }
            }
            if(max_relation>=10) {
              cur_relation=min(max(0,max_relation),RelationToRanger(CurShip,Player()));
              cur_relation_type=0;
              if (cur_relation>=10){cur_relation_type=1;}
              if (cur_relation>=30){cur_relation_type=2;}
              if (cur_relation>=60){cur_relation_type=3;}
              if (cur_relation>=80){cur_relation_type=4;}
              roll=((Id(CurShip)+CurTurn())/20)%2;
              if(StateIs(CurShip,'GuardVsPlayer') || StateIs(CurShip,'DeliveryVsPlayer')) {
                DChange(63);
                exit;
              }
              if(!StateIs(CurShip,'GuardVsPlayer') && !StateIs(CurShip,'DeliveryVsPlayer')) {
                if((second_try!=1)) {
                  if(cur_relation_type==0) {
                    if(roll) {
                      DChange(1);
                      exit;
                    }
                    if(!roll) {
                      DChange(2);
                      exit;
                    }
                  }
                  if(cur_relation_type==1) {
                    if(roll) {
                      DChange(3);
                      exit;
                    }
                    if(!roll) {
                      DChange(4);
                      exit;
                    }
                  }
                  if(cur_relation_type==2) {
                    if(roll) {
                      DChange(5);
                      exit;
                    }
                    if(!roll) {
                      DChange(6);
                      exit;
                    }
                  }
                  if(cur_relation_type==3) {
                    if(roll) {
                      DChange(7);
                      exit;
                    }
                    if(!roll) {
                      DChange(8);
                      exit;
                    }
                  }
                  if(cur_relation_type==4) {
                    if(roll) {
                      DChange(9);
                      exit;
                    }
                    if(!roll) {
                      DChange(10);
                      exit;
                    }
                  }
                }
                if(second_try==1) {
                  if(ShipIsPartner(CurShip) || StarOwner(ShipStar(Player())) || (GetShipPirateRank(Player())>=6) || (((GetShipPirateRank(Player())-agent_counter)>2)) || (RelationToRanger(quest_ship,Player())<30)) {
                    if(cur_relation_type==0) {
                      if(roll) {
                        DChange(1);
                        exit;
                      }
                      if(!roll) {
                        DChange(2);
                        exit;
                      }
                    }
                    if(cur_relation_type==1) {
                      if(roll) {
                        DChange(3);
                        exit;
                      }
                      if(!roll) {
                        DChange(4);
                        exit;
                      }
                    }
                    if(cur_relation_type==2) {
                      if(roll) {
                        DChange(5);
                        exit;
                      }
                      if(!roll) {
                        DChange(6);
                        exit;
                      }
                    }
                    if(cur_relation_type==3) {
                      if(roll) {
                        DChange(7);
                        exit;
                      }
                      if(!roll) {
                        DChange(8);
                        exit;
                      }
                    }
                    if(cur_relation_type==4) {
                      if(roll) {
                        DChange(9);
                        exit;
                      }
                      if(!roll) {
                        DChange(10);
                        exit;
                      }
                    }
                  }
                  if(!ShipIsPartner(CurShip) && !StarOwner(ShipStar(Player())) && (GetShipPirateRank(Player())<6) && (((GetShipPirateRank(Player())-agent_counter)<=2)) && (RelationToRanger(quest_ship,Player())>=30)) {
                    DChange(39);
                    exit;
                  }
                }
              }
            }
        >>>
    }
    DialogPB ~{
        Code=<<<
            reward_item=CT("Script.PC_fem_rangers.305");
            AddItemToShip(Player(),CreateArt(t_ArtefactBomb,None));
            AddItemToShip(Player(),CreateArt(t_ArtefactBomb,None));
            pirate_side_chosen=2;
            DChange(31);
            exit;
        >>>
    }
    DialogPlanet1 ~{
        Code=<<<
            quest_item=CreateArt(t_ArtefactTranclucator,None);
            reward_item=ItemFullName(quest_item);
            AddItemToStorage(GetShipPlanet(Player()),quest_item);
            gov_reward1=1;
            Ether(4,'65D73EBF-55DA-4895-9D1D-DDF17E60BDF0',Format(CT("Script.PC_fem_rangers.137"),"<0>",ShipName(Player()),"<1>",Name(IdToPlanet(gov_planet)),"<2>",Name(PlanetToStar(IdToPlanet(gov_planet)))));
            DChange(33);
            exit;
        >>>
    }
    DialogSecondTry ~{
        Code=<<<
            DChange(39);
            exit;
        >>>
    }
    DialogPartnershipBreak ~{
        Code=<<<
            DChange(64);
            exit;
        >>>
    }
    DialogNextMission ~{
        Code=<<<
            cur_talk_ship=GetTalkShip();
            cur_relation=min(max(0,max_relation),RelationToRanger(cur_talk_ship,Player()));
            cur_relation_type=0;
            if (cur_relation>=10){cur_relation_type=1;}
            if (cur_relation>=30){cur_relation_type=2;}
            if (cur_relation>=60){cur_relation_type=3;}
            if (cur_relation>=80){cur_relation_type=4;}
            if(cur_relation_type>=2) {
              if((GetShipPirateRank(Player())<6) && ((GetShipPirateRank(Player())-agent_counter)<=2)) {
                if(StarOwner(ShipStar(Player()))==0) {
                  counter=0;
                  quest_ship=0;
                  while (counter<GroupCount(GroupEnemies)){
                  if (ShipInNormalSpace(GroupShip(GroupEnemies,counter)) && (ShipStar(cur_talk_ship)==ShipStar(GroupShip(GroupEnemies,counter)))){
                  if ((ShipGetBad(cur_talk_ship)==GroupShip(GroupEnemies,counter)) || (cur_talk_ship==ShipGetBad(GroupShip(GroupEnemies,counter)))){
                  if (Dist(cur_talk_ship,GroupShip(GroupEnemies,counter))<500){quest_ship=GroupShip(GroupEnemies,counter);}
                  }}
                  counter=counter+1;}
                  if (ShipGetBad(cur_talk_ship)){
                  if (ShipStar(ShipGetBad(cur_talk_ship))==ShipStar(cur_talk_ship)){
                  if (Dist(cur_talk_ship,ShipGetBad(cur_talk_ship))<500){
                  quest_ship=ShipGetBad(cur_talk_ship);
                  }}}
                  if(!quest_ship) {
                    if(quest_status==10) {
                      if(shu_extra_mission) {
                        quest_planet=0;
                        quest_star=0;
                        supply_system_value=3;
                        supply_system=0;
                        counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),1,255);
                        if (counter){
                        counter=0;
                        while (counter<(ArrayDim(locations))){
                        counter2=0;
                        counter3=0;
                        supply_system_value2=0;
                        while (counter2<(ArrayDim(locations))){
                        if (Dist(locations[counter2],locations[counter])<(16+3*GalaxyTechLevel())){counter3=counter3+1;}
                        if (Dist(locations[counter2],locations[counter])<(32+6*GalaxyTechLevel())){supply_system_value2=supply_system_value2+1;}
                        counter2=counter2+1;}
                        if ((counter3==supply_system_value) && (supply_system_value2>6)){ 
                        if (abs(Dist(supply_system,ShipStar(Player()))-60)>abs(Dist(locations[counter],ShipStar(Player()))-60)){
                        supply_system=locations[counter];}}
                        if ((counter3>supply_system_value) && (supply_system_value2>6)){
                        supply_system=locations[counter];
                        supply_system_value=counter3;}
                        counter=counter+1;}
                        }
                        if (supply_system_value>3){quest_star=supply_system;
                        quest_planet=FindPlanet(quest_star,'NotMaloc,NotPeleng,NotPeople,NotFei,NotGaal,NotPirateClan',0,100);}
                        if(!quest_planet) {
                          DChange(131);
                          exit;
                        }
                        if(quest_planet) {
                          DChange(106);
                          exit;
                        }
                      }
                      if(!shu_extra_mission) {
                        DChange(105);
                        exit;
                      }
                    }
                    if(quest_status!=10) {
                      if(ShipRank(Player())<3) {
                        DChange(86);
                        exit;
                      }
                      if(ShipRank(Player())>=3) {
                        if(PlayerQuestInProgress()) {
                          DChange(67);
                          exit;
                        }
                        if(!PlayerQuestInProgress()) {
                          if(ControlledSystems(0)>=15) {
                            counter=1;
                            counter2=0;
                            quest_star=0;
                            while (counter<20){
                            if (StarOwner(StarNearbyStars(ShipStar(Player()),counter))==0){
                            quest_star=StarNearbyStars(ShipStar(Player()),counter);
                            counter2=counter2+1;}
                            counter=counter+1;}
                            if(counter2>=10) {
                              DChange(68);
                              exit;
                            }
                            if(counter2<10) {
                              DChange(87);
                              exit;
                            }
                          }
                          if(ControlledSystems(0)<15) {
                            DChange(88);
                            exit;
                          }
                        }
                      }
                    }
                  }
                  if(quest_ship) {
                    if(ShipGetBad(quest_ship)==cur_talk_ship) {
                      DChange(84);
                      exit;
                    }
                    if(ShipGetBad(quest_ship)!=cur_talk_ship) {
                      DChange(85);
                      exit;
                    }
                  }
                }
                if(StarOwner(ShipStar(Player()))==1) {
                  DChange(81);
                  exit;
                }
                if(StarOwner(ShipStar(Player()))==2) {
                  DChange(82);
                  exit;
                }
              }
              if((GetShipPirateRank(Player())>=6) || ((GetShipPirateRank(Player())-agent_counter)>2)) {
                if(GetShipPirateRank(Player())>agent_counter*2) {
                  if(cur_relation_type==0) {
                    DChange(53);
                    exit;
                  }
                  if(cur_relation_type==1) {
                    DChange(54);
                    exit;
                  }
                  if(cur_relation_type==2) {
                    DChange(55);
                    exit;
                  }
                  if(cur_relation_type==3) {
                    DChange(56);
                    exit;
                  }
                  if(cur_relation_type==4) {
                    DChange(57);
                    exit;
                  }
                }
                if(GetShipPirateRank(Player())<=agent_counter*2) {
                  if(cur_relation_type==0) {
                    DChange(58);
                    exit;
                  }
                  if(cur_relation_type==1) {
                    DChange(59);
                    exit;
                  }
                  if(cur_relation_type==2) {
                    DChange(60);
                    exit;
                  }
                  if(cur_relation_type==3) {
                    DChange(61);
                    exit;
                  }
                  if(cur_relation_type==4) {
                    DChange(62);
                    exit;
                  }
                }
              }
            }
            if(cur_relation_type<2) {
              DChange(83);
              exit;
            }
        >>>
    }
    DialogDiploSuspects ~{
        Code=<<<
            DChange(73);
            exit;
        >>>
    }
    DialogDiploAngry ~{
        Code=<<<
            DChange(75);
            exit;
        >>>
    }
    DialogPlanetRepeat ~{
        Code=<<<
            quest_status=5;
            diplo_annoy=0;
            turns_near_player=0;
            turns_without_player=0;
            turns_under_surv=0;
            observe_start=CurTurn()+1;
            counter=GalaxyStars()-1;
            quest_star=0;
            while (counter>0){
            if (StarOwner(StarNearbyStars(ShipStar(Player()),counter))==0){
            quest_star=StarNearbyStars(ShipStar(Player()),counter);}
            counter=counter-1;}
            quest_ship=BuyTransport(FindPlanetByAdvancement(100),2,300);
            diplo_id=Id(quest_ship);
            diplo_name=Name(quest_ship);
            NoTargetToShip(quest_ship,2);
            MakeShipEnterStar(quest_ship,ShipStar(Player()),quest_star,2);
            ShipJoin(GroupDiplo,quest_ship);
            ArrayClear(visited_stars_list);
            visited_stars_list[0]=Id(ShipStar(Player()));
            ArrayClear(visited_planets_list);
            visited_planets_list[0]=0;
            ArrayClear(nearby_stars_list);
            nearby_stars_list[0]=Id(ShipStar(Player()));
            counter=1;
            while (counter<5){
            ArrayAdd(nearby_stars_list,Id(StarNearbyStars(ShipStar(Player()),counter)));
            counter=counter+1;}
            ArrayClear(nearby_ships_list);
            nearby_ships_list[0]=0;
            ArrayClear(suspicious_ships_list);
            suspicious_ships_list[0]='';
            Ether(4,'893E0C91-12CA-4122-9E09-7ED869591471',Format(CT("Script.PC_fem_rangers.182"),"<0>",Name(IdToPlanet(gov_planet))));
            Ether(3,'FCDE615A-FE54-42CF-81DE-3A8BBE79E500',Format(CT("Script.PC_fem_rangers.311"),"<0>",observe_days,"<1>",GameDateTxtByTurn(observe_start),"<2>",Name(GroupToShip(GroupDiplo))),GroupToShip(GroupDiplo));
            DChange(77);
            exit;
        >>>
    }
    DialogPlanetSuccess ~{
        Code=<<<
            quest_item=CreateEquipment(t_Weapon7,20,8,2);
            reward_item=ItemFullName(quest_item);
            AddItemToStorage(GetShipPlanet(Player()),quest_item);
            quest_status=10;
            Ether(4,'8645F2EC-6934-4D2F-9BBA-AA0EA936E400',CT("Script.PC_fem_rangers.242"));
            DChange(78);
            exit;
        >>>
    }
    DialogPlanetFail ~{
        Code=<<<
            quest_status=6;
            Ether(5,'8645F2EC-6934-4D2F-9BBA-AA0EA936E400',CT("Script.PC_fem_rangers.243"));
            DChange(79);
            exit;
        >>>
    }
    DialogSuccess2 ~{
        Code=<<<
            quest_status=10;
            Ether(4,'893E0C91-12CA-4122-9E09-7ED869591471',Format(CT("Script.PC_fem_rangers.182"),"<0>",Name(IdToPlanet(gov_planet))));
            DChange(80);
            exit;
        >>>
    }
    DialogReport ~{
        Code=<<<
            report_stars=newarray(1);
            report_stars[0]=nearby_stars_list[0];
            ArrayDelete(nearby_stars_list,0);
            ArraySort(nearby_stars_list);
            ArrayAdd(nearby_stars_list,0);
            counter=0;
            DChange(90);
            exit;
        >>>
    }
    DialogWarningSupply ~{
        Code=<<<
            DChange(114);
            exit;
        >>>
    }
    DialogSupply ~{
        Code=<<<
            DChange(116);
            exit;
        >>>
    }
    DialogCenterWarning ~{
        Code=<<<
            DChange(117);
            exit;
        >>>
    }
    DialogShu ~{
        Code=<<<
            if((CurTurn()%4)==0) {
              DChange(121);
              exit;
            }
            if((CurTurn()%4)==1) {
              DChange(122);
              exit;
            }
            if((CurTurn()%4)==2) {
              DChange(123);
              exit;
            }
            if((CurTurn()%4)==3) {
              DChange(124);
              exit;
            }
        >>>
    }
    DialogStoryComplete ~{
        Code=<<<
            quest_item=CreateEquipment(t_RepairRobot,20,8,2);
            bon=FindBonusByCustomTag('A1D1M1');
            if (bon>-1){SpecialToEquipment(bon,quest_item);}
            LinkItemToScript(quest_item,HybridDroid);
            reward_item=Format(ItemFullName(quest_item),'<color=255,167,84>','');
            bon=FindBonusByName(CT("Script.PC_fem_rangers.361"));
            if (bon>-1){ModuleToEquipment(bon,quest_item);}
            ItemImprovement(quest_item,2);
            AddItemToStorage(GetShipPlanet(Player()),quest_item);
            gov_reward2=1;
            att_bonus=300;
            def_bonus=300;
            mov_bonus=300;
            points_a=newarray(1);
            points_d=newarray(1);
            points_m=newarray(1);
            points_bonus=newarray(1);
            mode_name=newarray(1);
            ArrayAdd(points_a,100);
            ArrayAdd(points_d,0);
            ArrayAdd(points_m,0);
            ArrayAdd(points_bonus,'A3');
            ArrayAdd(mode_name,CT("Script.PC_fem_rangers.332"));
            ArrayAdd(points_a,0);
            ArrayAdd(points_d,100);
            ArrayAdd(points_m,0);
            ArrayAdd(points_bonus,'D3');
            ArrayAdd(mode_name,CT("Script.PC_fem_rangers.331"));
            ArrayAdd(points_a,0);
            ArrayAdd(points_d,0);
            ArrayAdd(points_m,100);
            ArrayAdd(points_bonus,'M3');
            ArrayAdd(mode_name,CT("Script.PC_fem_rangers.330"));
            ArrayAdd(points_a,45);
            ArrayAdd(points_d,45);
            ArrayAdd(points_m,10);
            ArrayAdd(points_bonus,'A2D2');
            ArrayAdd(mode_name,CT("Script.PC_fem_rangers.329"));
            ArrayAdd(points_a,45);
            ArrayAdd(points_d,10);
            ArrayAdd(points_m,45);
            ArrayAdd(points_bonus,'A2M2');
            ArrayAdd(mode_name,CT("Script.PC_fem_rangers.328"));
            ArrayAdd(points_a,10);
            ArrayAdd(points_d,45);
            ArrayAdd(points_m,45);
            ArrayAdd(points_bonus,'D2M2');
            ArrayAdd(mode_name,CT("Script.PC_fem_rangers.327"));
            ArrayAdd(points_a,33);
            ArrayAdd(points_d,33);
            ArrayAdd(points_m,33);
            ArrayAdd(points_bonus,'A1D1M1');
            ArrayAdd(mode_name,CT("Script.PC_fem_rangers.326"));
            ArrayDelete(points_a,0);
            ArrayDelete(points_d,0);
            ArrayDelete(points_m,0);
            ArrayDelete(points_bonus,0);
            ArrayDelete(mode_name,0);
            shu_state=1;
            GetAchievementGIRLSQUEST();
            Ether(4,'0456DBA7-C65F-4C32-97F0-BC2DFB15BCF8',Format(CT("Script.PC_fem_rangers.303"),"<0>",ShipName(Player()),"<1>",Name(IdToPlanet(gov_planet)),"<2>",Name(PlanetToStar(IdToPlanet(gov_planet)))));
            DChange(120);
            exit;
        >>>
    }
}
DialogMsgs ~{
    0 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.33"),"<0>",ShipName(Player())));    DAdd(0);

        >>>
    }
    1 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.33"),"<0>",ShipName(Player())));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    2 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.34"),"<0>",ShipName(Player())));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    3 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.35"),"<0>",ShipName(Player())));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    4 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.23"));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    5 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.36"),"<0>",ShipName(Player())));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    6 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.25"));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    7 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.37"),"<0>",ShipName(Player())));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    8 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.27"));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    9 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.38"),"<0>",ShipName(Player())));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    10 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.39"),"<0>",ShipName(Player())));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    11 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.40"),"<0>",ShipName(Player())));    DAdd(45);

        >>>
    }
    12 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.41"));    DAdd(45);

        >>>
    }
    13 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.42"));    DAdd(3);

        >>>
    }
    14 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.43"),"<0>",ShipName(Player())));    DAdd(3);

        >>>
    }
    15 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.44"),"<0>",ShipName(Player())));    DAdd(3);

        >>>
    }
    16 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.45"));    DAdd(43);

        >>>
    }
    17 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.46"));    DAdd(43);

        >>>
    }
    18 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.47"),"<0>",ShipName(Player())));    DAdd(4);

        >>>
    }
    19 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.48"),"<0>",ShipName(Player())));    DAdd(4);

        >>>
    }
    20 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.49"),"<0>",ShipName(Player())));    DAdd(4);

        >>>
    }
    21 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.50"),"<0>",ShipName(Player())));    DAdd(44);

        >>>
    }
    22 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.51"));    DAdd(44);

        >>>
    }
    23 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.52"));    DAdd(5);

        >>>
    }
    24 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.53"));    DAdd(5);

        >>>
    }
    25 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.54"),"<0>",ShipName(Player())));    DAdd(5);

        >>>
    }
    26 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.55"));    DAdd(6);

        >>>
    }
    27 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.56"));    DAdd(7);

        >>>
    }
    28 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.57"),"<0>",ShipName(CurShip)));    DAdd(8);
            DAdd(9);

        >>>
    }
    29 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.58"));    DAdd(10);

        >>>
    }
    30 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.59"));    DAdd(11);
            DAdd(12);
            DAdd(13);

        >>>
    }
    31 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.306"),"<0>",ShipName(Player()),"<1>",reward_item));    DAdd(14);

        >>>
    }
    32 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.138"),"<0>",ShipName(Player())));    DAdd(23);

        >>>
    }
    33 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.63"),"<0>",ShipName(Player()),"<1>",reward_item));    DAdd(15);

        >>>
    }
    34 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.78"),"<0>",ShipName(Player())));    DAdd(16);

        >>>
    }
    35 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.79"));    DAdd(17);
            DAdd(18);
            DAdd(21);

        >>>
    }
    36 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.80"),"<0>",ShipName(Player())));    DAdd(19);

        >>>
    }
    37 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.360"),"<0>",Name(quest_planet),"<1>",beacon_quest_duration));    DAdd(20);

        >>>
    }
    38 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.139"),"<0>",ShipName(Player())));    DAdd(22);

        >>>
    }
    39 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.95"),"<0>",ShipName(Player())));    second_try=2;
            DAdd(24);
            DAdd(25);

        >>>
    }
    40 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.98"));    if(money_truce>1) {
              DAdd(30);
            }
            if(money_truce<ShipMoney(Player())) {
              DAdd(31);
            }
            if(ShipMoney(Player())==0) {
              DAdd(37);
            }
            if(ShipMoney(Player())>0) {
              DAdd(32);
              DAdd(38);
            }

        >>>
    }
    41 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.99"));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    42 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.100"));    RelationToRanger(CurShip,Player(),max(0,RelationToRanger(CurShip,Player())-10));
            cur_relation=min(max(0,max_relation),RelationToRanger(CurShip,Player()));
            cur_relation_type=0;
            if (cur_relation>=10){cur_relation_type=1;}
            if (cur_relation>=30){cur_relation_type=2;}
            if (cur_relation>=60){cur_relation_type=3;}
            if (cur_relation>=80){cur_relation_type=4;}
            //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    43 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.110"));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    44 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.111"));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    45 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.112"));    TruceBetweenShips(Player(),CurShip);
            cur_relation=min(max(0,max_relation),RelationToRanger(CurShip,Player()));
            cur_relation_type=0;
            if (cur_relation>=10){cur_relation_type=1;}
            if (cur_relation>=30){cur_relation_type=2;}
            if (cur_relation>=60){cur_relation_type=3;}
            if (cur_relation>=80){cur_relation_type=4;}
            //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    46 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.113"));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    47 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.114"));    ShipMoney(Player(),ShipMoney(Player())-money_truce);
            ShipMoney(CurShip,ShipMoney(CurShip)+money_truce);
            Sound('Sound.Buy');
            TruceBetweenShips(Player(),CurShip);
            cur_relation=min(max(0,max_relation),RelationToRanger(CurShip,Player()));
            cur_relation_type=0;
            if (cur_relation>=10){cur_relation_type=1;}
            if (cur_relation>=30){cur_relation_type=2;}
            if (cur_relation>=60){cur_relation_type=3;}
            if (cur_relation>=80){cur_relation_type=4;}
            //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    48 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.115"),"<0>",Name(ship_to_guard)));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    49 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.119"));    DAdd(39);
            DAdd(40);

        >>>
    }
    50 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.134"));    DAdd(39);
            DAdd(40);

        >>>
    }
    51 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.140"),"<0>",ShipName(Player())));    DAdd(22);

        >>>
    }
    52 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.141"));    DAdd(23);

        >>>
    }
    53 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.40"),"<0>",ShipName(Player())));    DAdd(41);

        >>>
    }
    54 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.41"));    DAdd(41);

        >>>
    }
    55 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.144"));    DAdd(41);

        >>>
    }
    56 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.145"),"<0>",ShipName(Player())));    DAdd(41);

        >>>
    }
    57 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.146"),"<0>",ShipName(Player())));    DAdd(41);

        >>>
    }
    58 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.50"),"<0>",ShipName(Player())));    DAdd(42);

        >>>
    }
    59 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.51"));    DAdd(42);

        >>>
    }
    60 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.147"),"<0>",ShipName(Player())));    DAdd(42);

        >>>
    }
    61 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.148"),"<0>",ShipName(Player())));    DAdd(42);

        >>>
    }
    62 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.149"),"<0>",ShipName(Player())));    DAdd(42);

        >>>
    }
    63 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.150"),"<0>",ShipName(Player())));    //roll=0;
            if(!CoalitionDefeated()) {
              if((max_relation>=10) && (quest_status==10) && !third_mission_refused) {
                if(shu_extra_mission) {
                  DAdd(96);
                }
                if(!shu_extra_mission) {
                  DAdd(94);
                }
              }
              if((max_relation>=10) && (quest_status==3) && !second_mission_refused && (gov_reward1==1)) {
                DAdd(48);
              }
              if((max_relation>=10) && (quest_status==8)) {
                DAdd(105);
              }
              if(ShipInPirateClan(Player()) && (!player_hate) && (!quest_status) && (!second_try)) {
                DAdd(2);
              }
            }
            if(cur_relation_type==0) {
              DAdd(26);
            }
            DAdd(33);
            DAdd(34);
            if(cur_relation_type==0) {
              DAdd(35);
              DAdd(36);
            }
            if(cur_relation_type>0) {
              DAdd(27);
              DAdd(28);
              DAdd(29);
            }
            DAdd(1);

        >>>
    }
    64 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.152"));    DAdd(46);

        >>>
    }
    65 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.155"),"<0>",ShipName(Player())));    DAdd(47);

        >>>
    }
    66 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.156"));    DAdd(47);

        >>>
    }
    67 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.158"),"<0>",ShipName(Player())));    DAdd(49);

        >>>
    }
    68 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.159"),"<0>",ShipName(Player())));    DAdd(50);
            DAdd(51);

        >>>
    }
    69 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.160"));    DAdd(52);

        >>>
    }
    70 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.161"));    DAdd(52);

        >>>
    }
    71 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.162"),"<0>",ShipName(Player()),"<1>",observe_days));    DAdd(53);
            DAdd(54);

        >>>
    }
    72 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.322"),"<0>",ShipName(quest_ship),"<1>",Name(quest_star)));    DAdd(55);

        >>>
    }
    73 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.172"));    DAdd(56);

        >>>
    }
    74 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.173"));    DAdd(57);

        >>>
    }
    75 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.174"),"<0>",ShipName(Player())));    DAdd(58);

        >>>
    }
    76 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.175"));    DAdd(59);

        >>>
    }
    77 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.207"),"<0>",ShipName(Player()),"<1>",Name(quest_ship)));    DAdd(60);

        >>>
    }
    78 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.307"),"<0>",ShipName(Player()),"<1>",reward_item));    DAdd(61);

        >>>
    }
    79 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.249"),"<0>",ShipName(Player())));    DAdd(62);

        >>>
    }
    80 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.191"),"<0>",ShipName(Player())));    DAdd(63);

        >>>
    }
    81 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.139"),"<0>",ShipName(Player())));    DAdd(64);

        >>>
    }
    82 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.193"),"<0>",ShipName(Player())));    DAdd(64);

        >>>
    }
    83 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.194"),"<0>",ShipName(Player())));    DAdd(65);

        >>>
    }
    84 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.155"),"<0>",ShipName(Player())));    DAdd(66);

        >>>
    }
    85 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.195"),"<0>",ShipName(Player())));    DAdd(66);

        >>>
    }
    86 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.196"));    DAdd(67);

        >>>
    }
    87 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.362"));    DAdd(68);

        >>>
    }
    88 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.198"));    DAdd(69);

        >>>
    }
    89 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.212"));    counter=1;
            DAddText('<clr>');
            DAddText(Name(GalaxyStar(report_stars[0]-1)));
            DAddText('<clrEnd>');
            while (counter<ArrayDim(report_stars)){
            DAddText(', ');
            DAddText('<clr>');
            DAddText(Name(GalaxyStar(report_stars[counter]-1)));
            DAddText('<clrEnd>');
            counter=counter+1;}
            DAddText(CT("Script.PC_fem_rangers.211"));
            if((ArrayDim(nearby_stars_list)-1-num_page*5)>0) {
              DAdd(77);
            }
            if((ArrayDim(nearby_stars_list)-1-num_page*5)>1) {
              DAdd(76);
            }
            if((ArrayDim(nearby_stars_list)-1-num_page*5)>2) {
              DAdd(75);
            }
            if((ArrayDim(nearby_stars_list)-1-num_page*5)>3) {
              DAdd(74);
            }
            if((ArrayDim(nearby_stars_list)-1-num_page*5)>4) {
              DAdd(73);
            }
            if(ArrayDim(nearby_stars_list)>6) {
              DAdd(72);
            }
            DAdd(71);

        >>>
    }
    90 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.209"),"<0>",ShipName(Player()),"<1>",diplo_name));    DAdd(70);

        >>>
    }
    91 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.220"),"<0>",Name(report_planet1),"<1>",Name(PlanetToStar(report_planet1))));    DAdd(78);
            DAdd(79);
            DAdd(80);
            DAdd(81);

        >>>
    }
    92 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.221"),"<0>",Name(report_planet1),"<1>",Name(PlanetToStar(report_planet1))));    DAdd(78);
            DAdd(79);
            DAdd(80);
            DAdd(81);

        >>>
    }
    93 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.222"),"<0>",Name(report_planet1),"<1>",Name(PlanetToStar(report_planet1))));    DAdd(78);
            DAdd(79);
            DAdd(80);
            DAdd(81);

        >>>
    }
    94 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.223"),"<0>",Name(report_planet1),"<1>",Name(PlanetToStar(report_planet1))));    DAdd(78);
            DAdd(79);
            DAdd(80);
            DAdd(81);

        >>>
    }
    95 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.224"),"<0>",Name(report_planet1),"<1>",Name(PlanetToStar(report_planet1))));    DAdd(78);
            DAdd(79);
            DAdd(80);
            DAdd(81);

        >>>
    }
    96 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.225"),"<0>",Name(report_planet2),"<1>",Name(PlanetToStar(report_planet2))));    DAdd(82);
            DAdd(83);
            DAdd(84);
            DAdd(85);

        >>>
    }
    97 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.226"),"<0>",Name(report_planet2),"<1>",Name(PlanetToStar(report_planet2))));    DAdd(82);
            DAdd(83);
            DAdd(84);
            DAdd(85);

        >>>
    }
    98 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.227"),"<0>",Name(report_planet2),"<1>",Name(PlanetToStar(report_planet2))));    DAdd(82);
            DAdd(83);
            DAdd(84);
            DAdd(85);

        >>>
    }
    99 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.228"),"<0>",Name(report_planet2),"<1>",Name(PlanetToStar(report_planet2))));    DAdd(82);
            DAdd(83);
            DAdd(84);
            DAdd(85);

        >>>
    }
    100 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.229"),"<0>",Name(report_planet2),"<1>",Name(PlanetToStar(report_planet2))));    DAdd(82);
            DAdd(83);
            DAdd(84);
            DAdd(85);

        >>>
    }
    101 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.230"),"<0>",Name(report_planet2),"<1>",Name(PlanetToStar(report_planet2))));    DAdd(82);
            DAdd(83);
            DAdd(84);
            DAdd(85);

        >>>
    }
    102 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.236"));    DAdd(86);
            DAdd(87);

        >>>
    }
    103 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.237"));    DAdd(89);
            if(ArrayDim(suspicious_ships_list)>1) {
              DAdd(90);
            }
            if(ArrayDim(suspicious_ships_list)>2) {
              DAdd(91);
            }
            if(ArrayDim(suspicious_ships_list)>3) {
              DAdd(92);
            }
            if(ArrayDim(suspicious_ships_list)>4) {
              DAdd(93);
            }

        >>>
    }
    104 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.316"),"<0>",ShipName(Player()),"<1>",30));    DAdd(88);

        >>>
    }
    105 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.252"));    DAdd(95);

        >>>
    }
    106 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.253"),"<0>",ShipName(Player()),"<1>",shu_name,"<2>",shu_name));    if((shu_extra_mission%2)==0) {
              DAdd(97);
            }
            if((shu_extra_mission%2)==1) {
              DAdd(98);
            }

        >>>
    }
    107 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.254"));    DAdd(99);

        >>>
    }
    108 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.255"));    DAdd(100);
            DAdd(101);
            DAdd(106);

        >>>
    }
    109 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.256"));    DAdd(100);
            DAdd(101);

        >>>
    }
    110 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.257"));    DAdd(102);
            DAdd(106);

        >>>
    }
    111 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.270"),"<0>",Name(quest_planet),"<1>",Name(PlanetToStar(quest_planet))));    DAdd(103);

        >>>
    }
    112 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.271"),"<0>",Name(quest_planet),"<1>",Name(PlanetToStar(quest_planet))));    DAdd(103);

        >>>
    }
    113 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.260"));    DAdd(104);

        >>>
    }
    114 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.276"),"<0>",ShipName(Player())));    DAdd(107);

        >>>
    }
    115 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.277"));    DAdd(108);

        >>>
    }
    116 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.302"),"<0>",ShipName(Player())));    DAdd(109);

        >>>
    }
    117 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.282"));    DAdd(110);

        >>>
    }
    118 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.364"));    DAdd(112);

        >>>
    }
    119 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.284"));    DAdd(111);

        >>>
    }
    120 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.335"),"<0>",reward_item));    DAdd(114);

        >>>
    }
    121 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.289"));    DAdd(115);
            DAdd(116);

        >>>
    }
    122 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.290"),"<0>",ShipName(Player())));    DAdd(115);
            DAdd(116);

        >>>
    }
    123 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.291"));    DAdd(115);
            DAdd(116);

        >>>
    }
    124 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.292"));    DAdd(115);
            DAdd(116);

        >>>
    }
    125 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.293"));    DAdd(113);

        >>>
    }
    126 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.294"));    DAdd(113);

        >>>
    }
    127 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.295"));    DAdd(113);

        >>>
    }
    128 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.296"));    DAdd(113);

        >>>
    }
    129 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.297"));    DAdd(113);

        >>>
    }
    130 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.298"));    DAdd(113);

        >>>
    }
    131 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.308"),"<0>",ShipName(Player())));    DAdd(117);

        >>>
    }
    132 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.337"),"<0>",ShipName(Player())));    DAdd(124);

        >>>
    }
    133 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.347"),"<0>",ShipName(Player()),"<1>",money_truce));    DAdd(121);
            DAdd(122);

        >>>
    }
    134 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.348"),"<0>",ShipName(Player()),"<1>",money_truce));    DAdd(119);
            DAdd(120);

        >>>
    }
    135 ~{
        Name=
        Code=<<<
            DText(CT("Script.PC_fem_rangers.343"));    DAdd(118);

        >>>
    }
    136 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.363"),"<0>",ShipName(Player())));    DAdd(118);

        >>>
    }
    137 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.345"),"<0>",ShipName(Player())));    DAdd(118);

        >>>
    }
    138 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.346"),"<0>",ShipName(Player())));    DAdd(0);

        >>>
    }
    139 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.354"),"<0>",ShipName(Player())));    DAdd(123);

        >>>
    }
    140 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.355"),"<0>",ShipName(Player())));    DAdd(123);

        >>>
    }
    141 ~{
        Name=
        Code=<<<
            DText(Format(CT("Script.PC_fem_rangers.356"),"<0>",ShipName(Player()),"<1>",Name(ShipOrderObj(CurShip))));    DAdd(125);
            DAdd(126);

        >>>
    }
}
DialogAnswers ~{
    0 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.64"));
        Code=
    }
    1 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.30"));
        Code=
    }
    2 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.31"));
        Code=<<<
            if((GetShipPirateRank(Player())<6) && ((GetShipPirateRank(Player())-agent_counter)<=2)) {
              req_complete=0;
              if (ShipRank(Player())>=2){req_complete=req_complete+1;}
              if (cur_relation>=80){req_complete=req_complete+1;}
              if (2*agent_counter>=GetShipPirateRank(Player())){req_complete=req_complete+1;}
              //req_complete=3;//;
              if(req_complete==0) {
                if(cur_relation_type==0) {
                  DChange(11);
                  exit;
                }
                if(cur_relation_type==1) {
                  DChange(12);
                  exit;
                }
                if(cur_relation_type==2) {
                  DChange(13);
                  exit;
                }
                if(cur_relation_type==3) {
                  DChange(14);
                  exit;
                }
                if(cur_relation_type==4) {
                  DChange(15);
                  exit;
                }
              }
              if(req_complete==1) {
                if(cur_relation_type==0) {
                  DChange(16);
                  exit;
                }
                if(cur_relation_type==1) {
                  DChange(17);
                  exit;
                }
                if(cur_relation_type==2) {
                  DChange(18);
                  exit;
                }
                if(cur_relation_type==3) {
                  DChange(19);
                  exit;
                }
                if(cur_relation_type==4) {
                  DChange(20);
                  exit;
                }
              }
              if(req_complete==2) {
                if(cur_relation_type==0) {
                  DChange(21);
                  exit;
                }
                if(cur_relation_type==1) {
                  DChange(22);
                  exit;
                }
                if(cur_relation_type==2) {
                  DChange(23);
                  exit;
                }
                if(cur_relation_type==3) {
                  DChange(24);
                  exit;
                }
                if(cur_relation_type==4) {
                  DChange(25);
                  exit;
                }
              }
              if(req_complete==3) {
                if(StarOwner(ShipStar(Player()))==0) {
                  counter=0;
                  quest_ship=0;
                  while (counter<GroupCount(GroupEnemies)){
                  if (ShipInNormalSpace(GroupShip(GroupEnemies,counter)) && (ShipStar(CurShip)==ShipStar(GroupShip(GroupEnemies,counter)))){
                  if ((ShipGetBad(CurShip)==GroupShip(GroupEnemies,counter)) || (CurShip==ShipGetBad(GroupShip(GroupEnemies,counter)))){
                  if (Dist(CurShip,GroupShip(GroupEnemies,counter))<500){quest_ship=GroupShip(GroupEnemies,counter);}
                  }}
                  counter=counter+1;}
                  if(!quest_ship) {
                    if(planet_list_created) {
                      //try to find new locations
                      req_dist=25;
                      num_planets=8;
                      best_dist=1000;
                      counter=0;
                      while (counter<ArrayDim(planet_list2)){
                      planet_list2[counter]=0;
                      counter=counter+1;}
                      counter=0;
                      planet_list2[0]=StarPlanets(ShipStar(Player()),0);
                      while ((counter<num_planets) && (planet_list2[counter]!=0)){
                      counter=counter+1;
                      counter2=1;
                      min_dist=0;
                      quest_planet=0;
                      while (counter2<GalaxyStars()){
                      temp_planet=0;
                      quest_star=StarNearbyStars(ShipStar(Player()),counter2);
                      if (SectorVisible(StarToCon(quest_star))){
                      temp_planet=FindPlanet(quest_star,'NotMaloc,NotPeleng,NotPeople,NotFei,NotGaal,NotKling,NotPirateClan',0,100);}
                      if (Terron && temp_planet) {
                      if (ShipStar(Terron)==PlanetToStar(temp_planet)){temp_planet=0;}}
                      if (temp_planet){
                      counter3=0;
                      cur_dist=1000;
                      while (counter3<counter){
                      if (Dist(quest_star,PlanetToStar(planet_list2[counter3]))<cur_dist){cur_dist=Dist(quest_star,PlanetToStar(planet_list2[counter3]));}
                      counter3=counter3+1;}
                      cur_dist=cur_dist+StarOwner(quest_star)*3;
                      if (min_dist<cur_dist){
                      min_dist=cur_dist;
                      quest_planet=temp_planet;}
                      }
                      counter2=counter2+1;}
                      if (best_dist>min_dist){
                      best_dist=min_dist;}
                      planet_list2[counter]=quest_planet;
                      }
                      if(planet_list2[num_planets] && (best_dist>=req_dist)) {
                        counter=0;
                        while (counter<ArrayDim(planet_list)){
                        planet_list[counter]=0;
                        if (planet_list2[counter]){
                        planet_list[counter]=Id(planet_list2[counter]);}
                        counter=counter+1;}
                        DChange(26);
                        exit;
                      }
                      if(!planet_list2[num_planets] || (best_dist<req_dist)) {
                        DChange(26);
                        exit;
                      }
                    }
                    if(!planet_list_created) {
                      //try to find locations
                      req_dist=25;
                      num_planets=8;
                      best_dist=1000;
                      counter=0;
                      while (counter<ArrayDim(planet_list)){
                      planet_list[counter]=0;
                      counter=counter+1;}
                      counter=0;
                      planet_list[0]=StarPlanets(ShipStar(Player()),0);
                      while ((counter<num_planets) && (planet_list[counter]!=0)){
                      counter=counter+1;
                      counter2=1;
                      min_dist=0;
                      quest_planet=0;
                      while (counter2<GalaxyStars()){
                      temp_planet=0;
                      quest_star=StarNearbyStars(ShipStar(Player()),counter2);
                      if (SectorVisible(StarToCon(quest_star))){
                      temp_planet=FindPlanet(quest_star,'NotMaloc,NotPeleng,NotPeople,NotFei,NotGaal,NotKling,NotPirateClan',0,100);}
                      if (Terron && temp_planet) {
                      if (ShipStar(Terron)==PlanetToStar(temp_planet)){temp_planet=0;}}
                      if (temp_planet){
                      counter3=0;
                      cur_dist=1000;
                      while (counter3<counter){
                      if (Dist(quest_star,PlanetToStar(planet_list[counter3]))<cur_dist){cur_dist=Dist(quest_star,PlanetToStar(planet_list[counter3]));}
                      counter3=counter3+1;}
                      cur_dist=cur_dist+StarOwner(quest_star)*3;
                      if (min_dist<cur_dist){
                      min_dist=cur_dist;
                      quest_planet=temp_planet;}
                      }
                      counter2=counter2+1;}
                      if (best_dist>min_dist){
                      best_dist=min_dist;}
                      planet_list[counter]=quest_planet;
                      }
                      if(planet_list[num_planets] && (best_dist>=req_dist)) {
                        counter=0;
                        while (counter<ArrayDim(planet_list)){
                        if (planet_list[counter]){planet_list[counter]=Id(planet_list[counter]);}
                        counter=counter+1;}
                        DChange(26);
                        exit;
                      }
                      if(!planet_list[num_planets] || (best_dist<req_dist)) {
                        if((Id(CurShip)%2)==0) {
                          DChange(32);
                          exit;
                        }
                        if((Id(CurShip)%2)==1) {
                          DChange(52);
                          exit;
                        }
                      }
                    }
                  }
                  if(quest_ship) {
                    if(ShipGetBad(quest_ship)==CurShip) {
                      DChange(65);
                      exit;
                    }
                    if(ShipGetBad(quest_ship)!=CurShip) {
                      DChange(66);
                      exit;
                    }
                  }
                }
                if(StarOwner(ShipStar(Player()))==1) {
                  DChange(38);
                  exit;
                }
                if(StarOwner(ShipStar(Player()))==2) {
                  DChange(51);
                  exit;
                }
              }
            }
            if((GetShipPirateRank(Player())>=6) || ((GetShipPirateRank(Player())-agent_counter)>2)) {
              if(GetShipPirateRank(Player())>agent_counter*2) {
                if(cur_relation_type==0) {
                  DChange(53);
                  exit;
                }
                if(cur_relation_type==1) {
                  DChange(54);
                  exit;
                }
                if(cur_relation_type==2) {
                  DChange(55);
                  exit;
                }
                if(cur_relation_type==3) {
                  DChange(56);
                  exit;
                }
                if(cur_relation_type==4) {
                  DChange(57);
                  exit;
                }
              }
              if(GetShipPirateRank(Player())<=agent_counter*2) {
                if(cur_relation_type==0) {
                  DChange(58);
                  exit;
                }
                if(cur_relation_type==1) {
                  DChange(59);
                  exit;
                }
                if(cur_relation_type==2) {
                  DChange(60);
                  exit;
                }
                if(cur_relation_type==3) {
                  DChange(61);
                  exit;
                }
                if(cur_relation_type==4) {
                  DChange(62);
                  exit;
                }
              }
            }
        >>>
    }
    3 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.65"));
        Code=
    }
    4 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.66"));
        Code=
    }
    5 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.67"));
        Code=
    }
    6 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.68"));
        Code=<<<
            DChange(27);
            exit;
        >>>
    }
    7 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.69"));
        Code=<<<
            DChange(28);
            exit;
        >>>
    }
    8 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.70"));
        Code=
    }
    9 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.71"));
        Code=<<<
            DChange(29);
            exit;
        >>>
    }
    10 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.72"));
        Code=<<<
            DChange(30);
            exit;
        >>>
    }
    11 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.73"));
        Code=<<<
            DChange(34);
            exit;
        >>>
    }
    12 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.74"));
        Code=<<<
            second_try=1;
        >>>
    }
    13 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.75"));
        Code=<<<
            //betrayal
            AutoBattle(CurShip);
            player_hate=1;
            pirate_side_chosen=1;
        >>>
    }
    14 ~{
        Command=restart
        Answer=DAnswer('restart~'+CT("Script.PC_fem_rangers.76"));
        Code=
    }
    15 ~{
        Command=planet
        Answer=DAnswer('planet~'+CT("Script.PC_fem_rangers.77"));
        Code=
    }
    16 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.82"));
        Code=<<<
            DChange(35);
            exit;
        >>>
    }
    17 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.85"));
        Code=<<<
            beacon_quest_duration=300+20*GalaxyTechLevel();
            beacon_quest_deadline=CurTurn()+beacon_quest_duration;
            quest_status=1;
            quest_item=CreateQuestItem('Usl_BeaconBox');
            quest_planet=NearCivilPlanet(Player());
            AddItemToStorage(quest_planet,quest_item);
            LinkItemToScript(quest_item,BeaconContainer);
            counter=0;
            while (counter<ArrayDim(planet_statuses)){
            planet_statuses[counter]='';
            counter=counter+1;}
            Ether(3,'972FE886-AE50-4231-98BB-5DE80FD5B374',Format(CT("Script.PC_fem_rangers.317"),"<0>",Name(quest_planet),"<1>",Name(IdToPlanet(planet_list[1])),"<2>",Name(PlanetToStar(IdToPlanet(planet_list[1]))),"<3>",planet_statuses[1],"<4>",Name(IdToPlanet(planet_list[2])),"<5>",Name(PlanetToStar(IdToPlanet(planet_list[2]))),"<6>",planet_statuses[2],"<7>",Name(IdToPlanet(planet_list[3])),"<8>",Name(PlanetToStar(IdToPlanet(planet_list[3]))),"<9>",planet_statuses[3],"<10>",Name(IdToPlanet(planet_list[4])),"<11>",Name(PlanetToStar(IdToPlanet(planet_list[4]))),"<12>",planet_statuses[4],"<13>",Name(IdToPlanet(planet_list[5])),"<14>",Name(PlanetToStar(IdToPlanet(planet_list[5]))),"<15>",planet_statuses[5],"<16>",Name(IdToPlanet(planet_list[6])),"<17>",Name(PlanetToStar(IdToPlanet(planet_list[6]))),"<18>",planet_statuses[6],"<19>",Name(IdToPlanet(planet_list[7])),"<20>",Name(PlanetToStar(IdToPlanet(planet_list[7]))),"<21>",planet_statuses[7],"<22>",Name(IdToPlanet(planet_list[8])),"<23>",Name(PlanetToStar(IdToPlanet(planet_list[8]))),"<24>",planet_statuses[8],"<25>",GameDateTxtByTurn(beacon_quest_deadline)));
            DChange(37);
            exit;
        >>>
    }
    18 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.84"));
        Code=<<<
            DChange(36);
            exit;
        >>>
    }
    19 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.83"));
        Code=<<<
            beacon_quest_duration=300+20*GalaxyTechLevel();
            beacon_quest_deadline=CurTurn()+beacon_quest_duration;
            quest_status=1;
            quest_item=CreateQuestItem('Usl_BeaconBox');
            quest_planet=NearCivilPlanet(Player());
            AddItemToStorage(quest_planet,quest_item);
            LinkItemToScript(quest_item,BeaconContainer);
            counter=0;
            while (counter<ArrayDim(planet_statuses)){
            planet_statuses[counter]='';
            counter=counter+1;}
            Ether(3,'972FE886-AE50-4231-98BB-5DE80FD5B374',Format(CT("Script.PC_fem_rangers.317"),"<0>",Name(quest_planet),"<1>",Name(IdToPlanet(planet_list[1])),"<2>",Name(PlanetToStar(IdToPlanet(planet_list[1]))),"<3>",planet_statuses[1],"<4>",Name(IdToPlanet(planet_list[2])),"<5>",Name(PlanetToStar(IdToPlanet(planet_list[2]))),"<6>",planet_statuses[2],"<7>",Name(IdToPlanet(planet_list[3])),"<8>",Name(PlanetToStar(IdToPlanet(planet_list[3]))),"<9>",planet_statuses[3],"<10>",Name(IdToPlanet(planet_list[4])),"<11>",Name(PlanetToStar(IdToPlanet(planet_list[4]))),"<12>",planet_statuses[4],"<13>",Name(IdToPlanet(planet_list[5])),"<14>",Name(PlanetToStar(IdToPlanet(planet_list[5]))),"<15>",planet_statuses[5],"<16>",Name(IdToPlanet(planet_list[6])),"<17>",Name(PlanetToStar(IdToPlanet(planet_list[6]))),"<18>",planet_statuses[6],"<19>",Name(IdToPlanet(planet_list[7])),"<20>",Name(PlanetToStar(IdToPlanet(planet_list[7]))),"<21>",planet_statuses[7],"<22>",Name(IdToPlanet(planet_list[8])),"<23>",Name(PlanetToStar(IdToPlanet(planet_list[8]))),"<24>",planet_statuses[8],"<25>",GameDateTxtByTurn(beacon_quest_deadline)));
            DChange(37);
            exit;
        >>>
    }
    20 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.86"));
        Code=
    }
    21 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.87"));
        Code=<<<
            second_try=1;
            mission_briefing=1;
        >>>
    }
    22 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.142"));
        Code=
    }
    23 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.143"));
        Code=
    }
    24 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.96"));
        Code=<<<
            //try to find new locations
            best_dist=1000;
            counter=0;
            while (counter<ArrayDim(planet_list2)){
            planet_list2[counter]=0;
            counter=counter+1;}
            counter=0;
            planet_list2[0]=StarPlanets(ShipStar(Player()),0);
            while ((counter<num_planets) && (planet_list2[counter]!=0)){
            counter=counter+1;
            counter2=1;
            min_dist=0;
            quest_planet=0;
            while (counter2<GalaxyStars()){
            temp_planet=0;
            quest_star=StarNearbyStars(ShipStar(Player()),counter2);
            if (SectorVisible(StarToCon(quest_star))){
            temp_planet=FindPlanet(quest_star,'NotMaloc,NotPeleng,NotPeople,NotFei,NotGaal,NotKling,NotPirateClan',0,100);}
            if (Terron && temp_planet) {
            if (ShipStar(Terron)==PlanetToStar(temp_planet)){temp_planet=0;}}
            if (temp_planet){
            counter3=0;
            cur_dist=1000;
            while (counter3<counter){
            if (Dist(quest_star,PlanetToStar(planet_list2[counter3]))<cur_dist){cur_dist=Dist(quest_star,PlanetToStar(planet_list2[counter3]));}
            counter3=counter3+1;}
            cur_dist=cur_dist+StarOwner(quest_star)*3;
            if (min_dist<cur_dist){
            min_dist=cur_dist;
            quest_planet=temp_planet;}
            }
            counter2=counter2+1;}
            if (best_dist>min_dist){
            best_dist=min_dist;}
            planet_list2[counter]=quest_planet;
            }
            if(planet_list2[num_planets] && (best_dist>=req_dist)) {
              counter=0;
              while (counter<ArrayDim(planet_list)){
              planet_list[counter]=0;
              if (planet_list2[counter]){
              planet_list[counter]=Id(planet_list2[counter]);}
              counter=counter+1;}
              if(!mission_briefing) {
                DChange(49);
                exit;
              }
              if(mission_briefing) {
                DChange(50);
                exit;
              }
            }
            if(!planet_list2[num_planets] || (best_dist<req_dist)) {
              if(!mission_briefing) {
                DChange(49);
                exit;
              }
              if(mission_briefing) {
                DChange(50);
                exit;
              }
            }
        >>>
    }
    25 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.97"));
        Code=
    }
    26 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.101"));
        Code=<<<
            if(!StateIs(CurShip,'GuardVsPlayer') && !StateIs(CurShip,'GuardShip')) {
              if(!ShipInFear(CurShip)) {
                money_truce=ShipWealth(Player())/50;
                if (!money_truce){money_truce=1;}
                if (ShipMoney(Player())<money_truce){money_truce=ShipMoney(Player());}
                DChange(40);
                exit;
              }
              if(ShipInFear(CurShip)) {
                DChange(45);
                exit;
              }
            }
            if(StateIs(CurShip,'GuardVsPlayer') || StateIs(CurShip,'GuardShip')) {
              counter=0;
              while (fem_id[counter]!=Id(CurShip)){counter=counter+1;}
              ship_num=counter;
              ship_to_guard=0;
              counter=0;
              while (counter<GroupCount(GroupTransports)){
              if (quest_data1[ship_num]==Id(GroupShip(GroupTransports,counter))){ship_to_guard=GroupShip(GroupTransports,counter);}
              counter=counter+1;}
              if(!ship_to_guard) {
                if(!ShipInFear(CurShip)) {
                  money_truce=ShipWealth(Player())/50;
                  if (!money_truce){money_truce=1;}
                  if (ShipMoney(Player())<money_truce){money_truce=ShipMoney(Player());}
                  DChange(40);
                  exit;
                }
                if(ShipInFear(CurShip)) {
                  DChange(45);
                  exit;
                }
              }
              if(ship_to_guard) {
                if(RelationToRanger(ship_to_guard,Player())>=10) {
                  if(!ShipInFear(CurShip)) {
                    money_truce=ShipWealth(Player())/50;
                    if (!money_truce){money_truce=1;}
                    if (ShipMoney(Player())<money_truce){money_truce=ShipMoney(Player());}
                    DChange(40);
                    exit;
                  }
                  if(ShipInFear(CurShip)) {
                    DChange(45);
                    exit;
                  }
                }
                if(RelationToRanger(ship_to_guard,Player())<10) {
                  DChange(48);
                  exit;
                }
              }
            }
        >>>
    }
    27 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.102"));
        Code=<<<
            DChange(41);
            exit;
        >>>
    }
    28 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.103"),"<0>",ShipName(CurShip)));
        Code=<<<
            DChange(41);
            exit;
        >>>
    }
    29 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.104"));
        Code=<<<
            DChange(41);
            exit;
        >>>
    }
    30 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.105"));
        Code=<<<
            money_truce=money_truce/2;
            DChange(40);
            exit;
        >>>
    }
    31 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.106"));
        Code=<<<
            money_truce=money_truce*2;
            if (ShipMoney(Player())<money_truce){money_truce=ShipMoney(Player());}
            DChange(40);
            exit;
        >>>
    }
    32 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.107"),"<0>",money_truce));
        Code=<<<
            if(money_truce*50>=ShipWealth(CurShip)) {
              DChange(47);
              exit;
            }
            if(money_truce*50<ShipWealth(CurShip)) {
              DChange(46);
              exit;
            }
        >>>
    }
    33 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.108"));
        Code=<<<
            DChange(42);
            exit;
        >>>
    }
    34 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.109"));
        Code=<<<
            DChange(42);
            exit;
        >>>
    }
    35 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.103"),"<0>",ShipName(CurShip)));
        Code=<<<
            DChange(43);
            exit;
        >>>
    }
    36 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.104"));
        Code=<<<
            DChange(44);
            exit;
        >>>
    }
    37 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.116"));
        Code=<<<
            cur_relation=min(max(0,max_relation),RelationToRanger(CurShip,Player()));
            cur_relation_type=0;
            if (cur_relation>=10){cur_relation_type=1;}
            if (cur_relation>=30){cur_relation_type=2;}
            if (cur_relation>=60){cur_relation_type=3;}
            if (cur_relation>=80){cur_relation_type=4;}
            roll=((Id(CurShip)+CurTurn())/20)%2;
            if(StateIs(CurShip,'GuardVsPlayer') || StateIs(CurShip,'DeliveryVsPlayer')) {
              DChange(63);
              exit;
            }
            if(!StateIs(CurShip,'GuardVsPlayer') && !StateIs(CurShip,'DeliveryVsPlayer')) {
              if((second_try!=1)) {
                if(cur_relation_type==0) {
                  if(roll) {
                    DChange(1);
                    exit;
                  }
                  if(!roll) {
                    DChange(2);
                    exit;
                  }
                }
                if(cur_relation_type==1) {
                  if(roll) {
                    DChange(3);
                    exit;
                  }
                  if(!roll) {
                    DChange(4);
                    exit;
                  }
                }
                if(cur_relation_type==2) {
                  if(roll) {
                    DChange(5);
                    exit;
                  }
                  if(!roll) {
                    DChange(6);
                    exit;
                  }
                }
                if(cur_relation_type==3) {
                  if(roll) {
                    DChange(7);
                    exit;
                  }
                  if(!roll) {
                    DChange(8);
                    exit;
                  }
                }
                if(cur_relation_type==4) {
                  if(roll) {
                    DChange(9);
                    exit;
                  }
                  if(!roll) {
                    DChange(10);
                    exit;
                  }
                }
              }
              if(second_try==1) {
                if(ShipIsPartner(CurShip) || StarOwner(ShipStar(Player())) || (GetShipPirateRank(Player())>=6) || (((GetShipPirateRank(Player())-agent_counter)>2)) || (RelationToRanger(quest_ship,Player())<30)) {
                  if(cur_relation_type==0) {
                    if(roll) {
                      DChange(1);
                      exit;
                    }
                    if(!roll) {
                      DChange(2);
                      exit;
                    }
                  }
                  if(cur_relation_type==1) {
                    if(roll) {
                      DChange(3);
                      exit;
                    }
                    if(!roll) {
                      DChange(4);
                      exit;
                    }
                  }
                  if(cur_relation_type==2) {
                    if(roll) {
                      DChange(5);
                      exit;
                    }
                    if(!roll) {
                      DChange(6);
                      exit;
                    }
                  }
                  if(cur_relation_type==3) {
                    if(roll) {
                      DChange(7);
                      exit;
                    }
                    if(!roll) {
                      DChange(8);
                      exit;
                    }
                  }
                  if(cur_relation_type==4) {
                    if(roll) {
                      DChange(9);
                      exit;
                    }
                    if(!roll) {
                      DChange(10);
                      exit;
                    }
                  }
                }
                if(!ShipIsPartner(CurShip) && !StarOwner(ShipStar(Player())) && (GetShipPirateRank(Player())<6) && (((GetShipPirateRank(Player())-agent_counter)<=2)) && (RelationToRanger(quest_ship,Player())>=30)) {
                  DChange(39);
                  exit;
                }
              }
            }
        >>>
    }
    38 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.117"));
        Code=<<<
            cur_relation=min(max(0,max_relation),RelationToRanger(CurShip,Player()));
            cur_relation_type=0;
            if (cur_relation>=10){cur_relation_type=1;}
            if (cur_relation>=30){cur_relation_type=2;}
            if (cur_relation>=60){cur_relation_type=3;}
            if (cur_relation>=80){cur_relation_type=4;}
            roll=((Id(CurShip)+CurTurn())/20)%2;
            if(StateIs(CurShip,'GuardVsPlayer') || StateIs(CurShip,'DeliveryVsPlayer')) {
              DChange(63);
              exit;
            }
            if(!StateIs(CurShip,'GuardVsPlayer') && !StateIs(CurShip,'DeliveryVsPlayer')) {
              if((second_try!=1)) {
                if(cur_relation_type==0) {
                  if(roll) {
                    DChange(1);
                    exit;
                  }
                  if(!roll) {
                    DChange(2);
                    exit;
                  }
                }
                if(cur_relation_type==1) {
                  if(roll) {
                    DChange(3);
                    exit;
                  }
                  if(!roll) {
                    DChange(4);
                    exit;
                  }
                }
                if(cur_relation_type==2) {
                  if(roll) {
                    DChange(5);
                    exit;
                  }
                  if(!roll) {
                    DChange(6);
                    exit;
                  }
                }
                if(cur_relation_type==3) {
                  if(roll) {
                    DChange(7);
                    exit;
                  }
                  if(!roll) {
                    DChange(8);
                    exit;
                  }
                }
                if(cur_relation_type==4) {
                  if(roll) {
                    DChange(9);
                    exit;
                  }
                  if(!roll) {
                    DChange(10);
                    exit;
                  }
                }
              }
              if(second_try==1) {
                if(ShipIsPartner(CurShip) || StarOwner(ShipStar(Player())) || (GetShipPirateRank(Player())>=6) || (((GetShipPirateRank(Player())-agent_counter)>2)) || (RelationToRanger(quest_ship,Player())<30)) {
                  if(cur_relation_type==0) {
                    if(roll) {
                      DChange(1);
                      exit;
                    }
                    if(!roll) {
                      DChange(2);
                      exit;
                    }
                  }
                  if(cur_relation_type==1) {
                    if(roll) {
                      DChange(3);
                      exit;
                    }
                    if(!roll) {
                      DChange(4);
                      exit;
                    }
                  }
                  if(cur_relation_type==2) {
                    if(roll) {
                      DChange(5);
                      exit;
                    }
                    if(!roll) {
                      DChange(6);
                      exit;
                    }
                  }
                  if(cur_relation_type==3) {
                    if(roll) {
                      DChange(7);
                      exit;
                    }
                    if(!roll) {
                      DChange(8);
                      exit;
                    }
                  }
                  if(cur_relation_type==4) {
                    if(roll) {
                      DChange(9);
                      exit;
                    }
                    if(!roll) {
                      DChange(10);
                      exit;
                    }
                  }
                }
                if(!ShipIsPartner(CurShip) && !StarOwner(ShipStar(Player())) && (GetShipPirateRank(Player())<6) && (((GetShipPirateRank(Player())-agent_counter)<=2)) && (RelationToRanger(quest_ship,Player())>=30)) {
                  DChange(39);
                  exit;
                }
              }
            }
        >>>
    }
    39 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.135"));
        Code=<<<
            beacon_quest_duration=300+20*GalaxyTechLevel();
            beacon_quest_deadline=CurTurn()+beacon_quest_duration;
            quest_status=1;
            quest_item=CreateQuestItem('Usl_BeaconBox');
            quest_planet=NearCivilPlanet(Player());
            AddItemToStorage(quest_planet,quest_item);
            LinkItemToScript(quest_item,BeaconContainer);
            counter=0;
            while (counter<ArrayDim(planet_statuses)){
            planet_statuses[counter]='';
            counter=counter+1;}
            Ether(3,'972FE886-AE50-4231-98BB-5DE80FD5B374',Format(CT("Script.PC_fem_rangers.317"),"<0>",Name(quest_planet),"<1>",Name(IdToPlanet(planet_list[1])),"<2>",Name(PlanetToStar(IdToPlanet(planet_list[1]))),"<3>",planet_statuses[1],"<4>",Name(IdToPlanet(planet_list[2])),"<5>",Name(PlanetToStar(IdToPlanet(planet_list[2]))),"<6>",planet_statuses[2],"<7>",Name(IdToPlanet(planet_list[3])),"<8>",Name(PlanetToStar(IdToPlanet(planet_list[3]))),"<9>",planet_statuses[3],"<10>",Name(IdToPlanet(planet_list[4])),"<11>",Name(PlanetToStar(IdToPlanet(planet_list[4]))),"<12>",planet_statuses[4],"<13>",Name(IdToPlanet(planet_list[5])),"<14>",Name(PlanetToStar(IdToPlanet(planet_list[5]))),"<15>",planet_statuses[5],"<16>",Name(IdToPlanet(planet_list[6])),"<17>",Name(PlanetToStar(IdToPlanet(planet_list[6]))),"<18>",planet_statuses[6],"<19>",Name(IdToPlanet(planet_list[7])),"<20>",Name(PlanetToStar(IdToPlanet(planet_list[7]))),"<21>",planet_statuses[7],"<22>",Name(IdToPlanet(planet_list[8])),"<23>",Name(PlanetToStar(IdToPlanet(planet_list[8]))),"<24>",planet_statuses[8],"<25>",GameDateTxtByTurn(beacon_quest_deadline)));
            DChange(37);
            exit;
        >>>
    }
    40 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.124"));
        Code=
    }
    41 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.30"));
        Code=
    }
    42 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.30"));
        Code=
    }
    43 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.30"));
        Code=
    }
    44 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.30"));
        Code=
    }
    45 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.30"));
        Code=
    }
    46 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.154"));
        Code=
    }
    47 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.157"));
        Code=
    }
    48 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.164"));
        Code=<<<
            cur_talk_ship=CurShip;
            if(cur_relation_type>=2) {
              if((GetShipPirateRank(Player())<6) && ((GetShipPirateRank(Player())-agent_counter)<=2)) {
                if(StarOwner(ShipStar(Player()))==0) {
                  counter=0;
                  quest_ship=0;
                  while (counter<GroupCount(GroupEnemies)){
                  if (ShipInNormalSpace(GroupShip(GroupEnemies,counter)) && (ShipStar(cur_talk_ship)==ShipStar(GroupShip(GroupEnemies,counter)))){
                  if ((ShipGetBad(cur_talk_ship)==GroupShip(GroupEnemies,counter)) || (cur_talk_ship==ShipGetBad(GroupShip(GroupEnemies,counter)))){
                  if (Dist(cur_talk_ship,GroupShip(GroupEnemies,counter))<500){quest_ship=GroupShip(GroupEnemies,counter);}
                  }}
                  counter=counter+1;}
                  if (ShipGetBad(cur_talk_ship)){
                  if (ShipStar(ShipGetBad(cur_talk_ship))==ShipStar(cur_talk_ship)){
                  if (Dist(cur_talk_ship,ShipGetBad(cur_talk_ship))<500){
                  quest_ship=ShipGetBad(cur_talk_ship);
                  }}}
                  if(!quest_ship) {
                    if(quest_status==10) {
                      if(shu_extra_mission) {
                        quest_planet=0;
                        quest_star=0;
                        supply_system_value=3;
                        supply_system=0;
                        counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),1,255);
                        if (counter){
                        counter=0;
                        while (counter<(ArrayDim(locations))){
                        counter2=0;
                        counter3=0;
                        supply_system_value2=0;
                        while (counter2<(ArrayDim(locations))){
                        if (Dist(locations[counter2],locations[counter])<(16+3*GalaxyTechLevel())){counter3=counter3+1;}
                        if (Dist(locations[counter2],locations[counter])<(32+6*GalaxyTechLevel())){supply_system_value2=supply_system_value2+1;}
                        counter2=counter2+1;}
                        if ((counter3==supply_system_value) && (supply_system_value2>6)){ 
                        if (abs(Dist(supply_system,ShipStar(Player()))-60)>abs(Dist(locations[counter],ShipStar(Player()))-60)){
                        supply_system=locations[counter];}}
                        if ((counter3>supply_system_value) && (supply_system_value2>6)){
                        supply_system=locations[counter];
                        supply_system_value=counter3;}
                        counter=counter+1;}
                        }
                        if (supply_system_value>3){quest_star=supply_system;
                        quest_planet=FindPlanet(quest_star,'NotMaloc,NotPeleng,NotPeople,NotFei,NotGaal,NotPirateClan',0,100);}
                        if(!quest_planet) {
                          DChange(131);
                          exit;
                        }
                        if(quest_planet) {
                          DChange(106);
                          exit;
                        }
                      }
                      if(!shu_extra_mission) {
                        DChange(105);
                        exit;
                      }
                    }
                    if(quest_status!=10) {
                      if(ShipRank(Player())<3) {
                        DChange(86);
                        exit;
                      }
                      if(ShipRank(Player())>=3) {
                        if(PlayerQuestInProgress()) {
                          DChange(67);
                          exit;
                        }
                        if(!PlayerQuestInProgress()) {
                          if(ControlledSystems(0)>=15) {
                            counter=1;
                            counter2=0;
                            quest_star=0;
                            while (counter<20){
                            if (StarOwner(StarNearbyStars(ShipStar(Player()),counter))==0){
                            quest_star=StarNearbyStars(ShipStar(Player()),counter);
                            counter2=counter2+1;}
                            counter=counter+1;}
                            if(counter2>=10) {
                              DChange(68);
                              exit;
                            }
                            if(counter2<10) {
                              DChange(87);
                              exit;
                            }
                          }
                          if(ControlledSystems(0)<15) {
                            DChange(88);
                            exit;
                          }
                        }
                      }
                    }
                  }
                  if(quest_ship) {
                    if(ShipGetBad(quest_ship)==cur_talk_ship) {
                      DChange(84);
                      exit;
                    }
                    if(ShipGetBad(quest_ship)!=cur_talk_ship) {
                      DChange(85);
                      exit;
                    }
                  }
                }
                if(StarOwner(ShipStar(Player()))==1) {
                  DChange(81);
                  exit;
                }
                if(StarOwner(ShipStar(Player()))==2) {
                  DChange(82);
                  exit;
                }
              }
              if((GetShipPirateRank(Player())>=6) || ((GetShipPirateRank(Player())-agent_counter)>2)) {
                if(GetShipPirateRank(Player())>agent_counter*2) {
                  if(cur_relation_type==0) {
                    DChange(53);
                    exit;
                  }
                  if(cur_relation_type==1) {
                    DChange(54);
                    exit;
                  }
                  if(cur_relation_type==2) {
                    DChange(55);
                    exit;
                  }
                  if(cur_relation_type==3) {
                    DChange(56);
                    exit;
                  }
                  if(cur_relation_type==4) {
                    DChange(57);
                    exit;
                  }
                }
                if(GetShipPirateRank(Player())<=agent_counter*2) {
                  if(cur_relation_type==0) {
                    DChange(58);
                    exit;
                  }
                  if(cur_relation_type==1) {
                    DChange(59);
                    exit;
                  }
                  if(cur_relation_type==2) {
                    DChange(60);
                    exit;
                  }
                  if(cur_relation_type==3) {
                    DChange(61);
                    exit;
                  }
                  if(cur_relation_type==4) {
                    DChange(62);
                    exit;
                  }
                }
              }
            }
            if(cur_relation_type<2) {
              DChange(83);
              exit;
            }
        >>>
    }
    49 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.143"));
        Code=
    }
    50 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.165"));
        Code=<<<
            DChange(69);
            exit;
        >>>
    }
    51 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.166"));
        Code=<<<
            DChange(70);
            exit;
        >>>
    }
    52 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.167"));
        Code=<<<
            DChange(71);
            exit;
        >>>
    }
    53 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.168"));
        Code=<<<
            second_mission_refused=1;
        >>>
    }
    54 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.169"));
        Code=<<<
            quest_status=5;
            observe_start=CurTurn()+1;
            visited_stars_list=newarray(1);
            visited_stars_list[0]=Id(ShipStar(Player()));
            visited_planets_list=newarray(1);
            visited_planets_list[0]=0;
            nearby_stars_list=newarray(1);
            nearby_stars_list[0]=Id(ShipStar(Player()));
            counter=1;
            while (counter<5){
            ArrayAdd(nearby_stars_list,Id(StarNearbyStars(ShipStar(Player()),counter)));
            counter=counter+1;}
            nearby_ships_list=newarray(1);
            nearby_ships_list[0]=0;
            suspicious_ships_list=newarray(1);
            suspicious_ships_list[0]='';
            quest_ship=BuyTransport(FindPlanetByAdvancement(100),2,300);
            diplo_id=Id(quest_ship);
            diplo_name=Name(quest_ship);
            NoTargetToShip(quest_ship,2);
            MakeShipEnterStar(quest_ship,ShipStar(Player()),quest_star,2);
            ShipJoin(GroupDiplo,quest_ship);
            Ether(3,'FCDE615A-FE54-42CF-81DE-3A8BBE79E500',Format(CT("Script.PC_fem_rangers.311"),"<0>",observe_days,"<1>",GameDateTxtByTurn(observe_start),"<2>",Name(GroupToShip(GroupDiplo))),GroupToShip(GroupDiplo));
            DChange(72);
            exit;
        >>>
    }
    55 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.170"));
        Code=
    }
    56 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.177"));
        Code=<<<
            DChange(74);
            exit;
        >>>
    }
    57 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.178"));
        Code=<<<
            diplo_annoy=diplo_annoy+1;
            turns_near_player=0;
        >>>
    }
    58 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.179"));
        Code=<<<
            DChange(76);
            exit;
        >>>
    }
    59 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.180"));
        Code=<<<
            diplo_annoy=diplo_annoy+1;
            turns_near_player=0;
        >>>
    }
    60 ~{
        Command=planet
        Answer=DAnswer('planet~'+CT("Script.PC_fem_rangers.186"));
        Code=
    }
    61 ~{
        Command=planet
        Answer=DAnswer('planet~'+CT("Script.PC_fem_rangers.187"));
        Code=
    }
    62 ~{
        Command=planet
        Answer=DAnswer('planet~'+CT("Script.PC_fem_rangers.188"));
        Code=
    }
    63 ~{
        Command=planet
        Answer=DAnswer('planet~'+CT("Script.PC_fem_rangers.192"));
        Code=
    }
    64 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.142"));
        Code=
    }
    65 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.30"));
        Code=
    }
    66 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.157"));
        Code=
    }
    67 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.143"));
        Code=
    }
    68 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.199"));
        Code=
    }
    69 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.30"));
        Code=
    }
    70 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.210"));
        Code=<<<
            DChange(89);
            exit;
        >>>
    }
    71 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.213"));
        Code=<<<
            quest_star=GalaxyStar(report_stars[Rnd(1,1000)%ArrayDim(report_stars)]-1);
            report_planet1=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));
            while (PlanetOwner(report_planet1)==6){report_planet1=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));}
            if(PlanetRace(report_planet1)==0) {
              DChange(93);
              exit;
            }
            if(PlanetRace(report_planet1)==1) {
              DChange(92);
              exit;
            }
            if(PlanetRace(report_planet1)==2) {
              DChange(91);
              exit;
            }
            if(PlanetRace(report_planet1)==3) {
              DChange(94);
              exit;
            }
            if(PlanetRace(report_planet1)==4) {
              DChange(95);
              exit;
            }
        >>>
    }
    72 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.214"));
        Code=<<<
            num_page=num_page+1;
            if (num_page*5>=(ArrayDim(nearby_stars_list)-1)){num_page=0;}
            DChange(89);
            exit;
        >>>
    }
    73 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.215"),"<0>",Name(GalaxyStar(nearby_stars_list[4+num_page*5]-1))));
        Code=<<<
            chosen_num=num_page*5+4;
            ArrayAdd(report_stars,nearby_stars_list[chosen_num]);
            ArrayDelete(nearby_stars_list,chosen_num);
            num_page=0;
            DChange(89);
            exit;
        >>>
    }
    74 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.215"),"<0>",Name(GalaxyStar(nearby_stars_list[3+num_page*5]-1))));
        Code=<<<
            chosen_num=num_page*5+3;
            ArrayAdd(report_stars,nearby_stars_list[chosen_num]);
            ArrayDelete(nearby_stars_list,chosen_num);
            num_page=0;
            DChange(89);
            exit;
        >>>
    }
    75 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.215"),"<0>",Name(GalaxyStar(nearby_stars_list[2+num_page*5]-1))));
        Code=<<<
            chosen_num=num_page*5+2;
            ArrayAdd(report_stars,nearby_stars_list[chosen_num]);
            ArrayDelete(nearby_stars_list,chosen_num);
            num_page=0;
            DChange(89);
            exit;
        >>>
    }
    76 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.215"),"<0>",Name(GalaxyStar(nearby_stars_list[1+num_page*5]-1))));
        Code=<<<
            chosen_num=num_page*5+1;
            ArrayAdd(report_stars,nearby_stars_list[chosen_num]);
            ArrayDelete(nearby_stars_list,chosen_num);
            num_page=0;
            DChange(89);
            exit;
        >>>
    }
    77 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.215"),"<0>",Name(GalaxyStar(nearby_stars_list[num_page*5]-1))));
        Code=<<<
            chosen_num=num_page*5;
            ArrayAdd(report_stars,nearby_stars_list[chosen_num]);
            ArrayDelete(nearby_stars_list,chosen_num);
            num_page=0;
            DChange(89);
            exit;
        >>>
    }
    78 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.231"));
        Code=<<<
            report_planet_count1=0;
            quest_star=0;
            if (ArrayDim(report_stars)>1){
            quest_star=GalaxyStar(report_stars[Rnd(1,1000)%ArrayDim(report_stars)]-1);
            while (quest_star==PlanetToStar(report_planet1)){
            quest_star=GalaxyStar(report_stars[Rnd(1,1000)%ArrayDim(report_stars)]-1);}
            }
            if (quest_star){
            report_planet2=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));
            while (PlanetOwner(report_planet2)==6){report_planet2=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));}
            }
            if(!report_planet2) {
              suspicious_ships_list[0]=suspicious_ship_name;
              if((ArrayDim(suspicious_ships_list)>1) || (suspicious_ship_id>=1)) {
                if (suspicious_ship_id<1){ArrayDelete(suspicious_ships_list,0);}
                while (ArrayDim(suspicious_ships_list)>5){
                roll=Rnd(1,1000)%ArrayDim(suspicious_ships_list);
                if (suspicious_ships_list[roll]!=suspicious_ship_name){ArrayDelete(suspicious_ships_list,roll);}
                }
                ArrayRandomize(10,suspicious_ships_list);
                DChange(102);
                exit;
              }
              if((ArrayDim(suspicious_ships_list)<=1) && (suspicious_ship_id<1)) {
                DChange(104);
                exit;
              }
            }
            if(report_planet2) {
              if(PlanetRace(report_planet2)!=PlanetRace(report_planet1)) {
                if(PlanetRace(report_planet2)==0) {
                  DChange(96);
                  exit;
                }
                if(PlanetRace(report_planet2)==1) {
                  DChange(97);
                  exit;
                }
                if(PlanetRace(report_planet2)==2) {
                  DChange(98);
                  exit;
                }
                if(PlanetRace(report_planet2)==3) {
                  DChange(99);
                  exit;
                }
                if(PlanetRace(report_planet2)==4) {
                  DChange(100);
                  exit;
                }
              }
              if(PlanetRace(report_planet2)==PlanetRace(report_planet1)) {
                DChange(101);
                exit;
              }
            }
        >>>
    }
    79 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.232"));
        Code=<<<
            report_planet_count1=1;
            quest_star=0;
            if (ArrayDim(report_stars)>1){
            quest_star=GalaxyStar(report_stars[Rnd(1,1000)%ArrayDim(report_stars)]-1);
            while (quest_star==PlanetToStar(report_planet1)){
            quest_star=GalaxyStar(report_stars[Rnd(1,1000)%ArrayDim(report_stars)]-1);}
            }
            if (quest_star){
            report_planet2=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));
            while (PlanetOwner(report_planet2)==6){report_planet2=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));}
            }
            if(!report_planet2) {
              suspicious_ships_list[0]=suspicious_ship_name;
              if((ArrayDim(suspicious_ships_list)>1) || (suspicious_ship_id>=1)) {
                if (suspicious_ship_id<1){ArrayDelete(suspicious_ships_list,0);}
                while (ArrayDim(suspicious_ships_list)>5){
                roll=Rnd(1,1000)%ArrayDim(suspicious_ships_list);
                if (suspicious_ships_list[roll]!=suspicious_ship_name){ArrayDelete(suspicious_ships_list,roll);}
                }
                ArrayRandomize(10,suspicious_ships_list);
                DChange(102);
                exit;
              }
              if((ArrayDim(suspicious_ships_list)<=1) && (suspicious_ship_id<1)) {
                DChange(104);
                exit;
              }
            }
            if(report_planet2) {
              if(PlanetRace(report_planet2)!=PlanetRace(report_planet1)) {
                if(PlanetRace(report_planet2)==0) {
                  DChange(96);
                  exit;
                }
                if(PlanetRace(report_planet2)==1) {
                  DChange(97);
                  exit;
                }
                if(PlanetRace(report_planet2)==2) {
                  DChange(98);
                  exit;
                }
                if(PlanetRace(report_planet2)==3) {
                  DChange(99);
                  exit;
                }
                if(PlanetRace(report_planet2)==4) {
                  DChange(100);
                  exit;
                }
              }
              if(PlanetRace(report_planet2)==PlanetRace(report_planet1)) {
                DChange(101);
                exit;
              }
            }
        >>>
    }
    80 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.233"));
        Code=<<<
            report_planet_count1=2;
            quest_star=0;
            if (ArrayDim(report_stars)>1){
            quest_star=GalaxyStar(report_stars[Rnd(1,1000)%ArrayDim(report_stars)]-1);
            while (quest_star==PlanetToStar(report_planet1)){
            quest_star=GalaxyStar(report_stars[Rnd(1,1000)%ArrayDim(report_stars)]-1);}
            }
            if (quest_star){
            report_planet2=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));
            while (PlanetOwner(report_planet2)==6){report_planet2=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));}
            }
            if(!report_planet2) {
              suspicious_ships_list[0]=suspicious_ship_name;
              if((ArrayDim(suspicious_ships_list)>1) || (suspicious_ship_id>=1)) {
                if (suspicious_ship_id<1){ArrayDelete(suspicious_ships_list,0);}
                while (ArrayDim(suspicious_ships_list)>5){
                roll=Rnd(1,1000)%ArrayDim(suspicious_ships_list);
                if (suspicious_ships_list[roll]!=suspicious_ship_name){ArrayDelete(suspicious_ships_list,roll);}
                }
                ArrayRandomize(10,suspicious_ships_list);
                DChange(102);
                exit;
              }
              if((ArrayDim(suspicious_ships_list)<=1) && (suspicious_ship_id<1)) {
                DChange(104);
                exit;
              }
            }
            if(report_planet2) {
              if(PlanetRace(report_planet2)!=PlanetRace(report_planet1)) {
                if(PlanetRace(report_planet2)==0) {
                  DChange(96);
                  exit;
                }
                if(PlanetRace(report_planet2)==1) {
                  DChange(97);
                  exit;
                }
                if(PlanetRace(report_planet2)==2) {
                  DChange(98);
                  exit;
                }
                if(PlanetRace(report_planet2)==3) {
                  DChange(99);
                  exit;
                }
                if(PlanetRace(report_planet2)==4) {
                  DChange(100);
                  exit;
                }
              }
              if(PlanetRace(report_planet2)==PlanetRace(report_planet1)) {
                DChange(101);
                exit;
              }
            }
        >>>
    }
    81 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.234"));
        Code=<<<
            report_planet_count1=3;
            quest_star=0;
            if (ArrayDim(report_stars)>1){
            quest_star=GalaxyStar(report_stars[Rnd(1,1000)%ArrayDim(report_stars)]-1);
            while (quest_star==PlanetToStar(report_planet1)){
            quest_star=GalaxyStar(report_stars[Rnd(1,1000)%ArrayDim(report_stars)]-1);}
            }
            if (quest_star){
            report_planet2=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));
            while (PlanetOwner(report_planet2)==6){report_planet2=StarPlanets(quest_star,Rnd(1,1000)%StarPlanets(quest_star));}
            }
            if(!report_planet2) {
              suspicious_ships_list[0]=suspicious_ship_name;
              if((ArrayDim(suspicious_ships_list)>1) || (suspicious_ship_id>=1)) {
                if (suspicious_ship_id<1){ArrayDelete(suspicious_ships_list,0);}
                while (ArrayDim(suspicious_ships_list)>5){
                roll=Rnd(1,1000)%ArrayDim(suspicious_ships_list);
                if (suspicious_ships_list[roll]!=suspicious_ship_name){ArrayDelete(suspicious_ships_list,roll);}
                }
                ArrayRandomize(10,suspicious_ships_list);
                DChange(102);
                exit;
              }
              if((ArrayDim(suspicious_ships_list)<=1) && (suspicious_ship_id<1)) {
                DChange(104);
                exit;
              }
            }
            if(report_planet2) {
              if(PlanetRace(report_planet2)!=PlanetRace(report_planet1)) {
                if(PlanetRace(report_planet2)==0) {
                  DChange(96);
                  exit;
                }
                if(PlanetRace(report_planet2)==1) {
                  DChange(97);
                  exit;
                }
                if(PlanetRace(report_planet2)==2) {
                  DChange(98);
                  exit;
                }
                if(PlanetRace(report_planet2)==3) {
                  DChange(99);
                  exit;
                }
                if(PlanetRace(report_planet2)==4) {
                  DChange(100);
                  exit;
                }
              }
              if(PlanetRace(report_planet2)==PlanetRace(report_planet1)) {
                DChange(101);
                exit;
              }
            }
        >>>
    }
    82 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.216"));
        Code=<<<
            report_planet_count2=0;
            suspicious_ships_list[0]=suspicious_ship_name;
            if((ArrayDim(suspicious_ships_list)>1) || (suspicious_ship_id>=1)) {
              if (suspicious_ship_id<1){ArrayDelete(suspicious_ships_list,0);}
              while (ArrayDim(suspicious_ships_list)>5){
              roll=Rnd(1,1000)%ArrayDim(suspicious_ships_list);
              if (suspicious_ships_list[roll]!=suspicious_ship_name){ArrayDelete(suspicious_ships_list,roll);}
              }
              ArrayRandomize(10,suspicious_ships_list);
              DChange(102);
              exit;
            }
            if((ArrayDim(suspicious_ships_list)<=1) && (suspicious_ship_id<1)) {
              DChange(104);
              exit;
            }
        >>>
    }
    83 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.217"));
        Code=<<<
            report_planet_count2=1;
            suspicious_ships_list[0]=suspicious_ship_name;
            if((ArrayDim(suspicious_ships_list)>1) || (suspicious_ship_id>=1)) {
              if (suspicious_ship_id<1){ArrayDelete(suspicious_ships_list,0);}
              while (ArrayDim(suspicious_ships_list)>5){
              roll=Rnd(1,1000)%ArrayDim(suspicious_ships_list);
              if (suspicious_ships_list[roll]!=suspicious_ship_name){ArrayDelete(suspicious_ships_list,roll);}
              }
              ArrayRandomize(10,suspicious_ships_list);
              DChange(102);
              exit;
            }
            if((ArrayDim(suspicious_ships_list)<=1) && (suspicious_ship_id<1)) {
              DChange(104);
              exit;
            }
        >>>
    }
    84 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.235"));
        Code=<<<
            report_planet_count2=2;
            suspicious_ships_list[0]=suspicious_ship_name;
            if((ArrayDim(suspicious_ships_list)>1) || (suspicious_ship_id>=1)) {
              if (suspicious_ship_id<1){ArrayDelete(suspicious_ships_list,0);}
              while (ArrayDim(suspicious_ships_list)>5){
              roll=Rnd(1,1000)%ArrayDim(suspicious_ships_list);
              if (suspicious_ships_list[roll]!=suspicious_ship_name){ArrayDelete(suspicious_ships_list,roll);}
              }
              ArrayRandomize(10,suspicious_ships_list);
              DChange(102);
              exit;
            }
            if((ArrayDim(suspicious_ships_list)<=1) && (suspicious_ship_id<1)) {
              DChange(104);
              exit;
            }
        >>>
    }
    85 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.219"));
        Code=<<<
            report_planet_count2=3;
            suspicious_ships_list[0]=suspicious_ship_name;
            if((ArrayDim(suspicious_ships_list)>1) || (suspicious_ship_id>=1)) {
              if (suspicious_ship_id<1){ArrayDelete(suspicious_ships_list,0);}
              while (ArrayDim(suspicious_ships_list)>5){
              roll=Rnd(1,1000)%ArrayDim(suspicious_ships_list);
              if (suspicious_ships_list[roll]!=suspicious_ship_name){ArrayDelete(suspicious_ships_list,roll);}
              }
              ArrayRandomize(10,suspicious_ships_list);
              DChange(102);
              exit;
            }
            if((ArrayDim(suspicious_ships_list)<=1) && (suspicious_ship_id<1)) {
              DChange(104);
              exit;
            }
        >>>
    }
    86 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.239"));
        Code=<<<
            DChange(104);
            exit;
        >>>
    }
    87 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.240"));
        Code=<<<
            DChange(103);
            exit;
        >>>
    }
    88 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.241"));
        Code=<<<
            quest_status=9;
            investigation_start_date=CurTurn();
            gov_planet=0;
            Ether(4,'FCDE615A-FE54-42CF-81DE-3A8BBE79E500',CT("Script.PC_fem_rangers.205"));
            if(!report_failed) {
              counter=0;
              while (counter<ArrayDim(visited_stars_list)){
              counter=counter+1;}
              counter=0;
              while (counter<ArrayDim(report_stars)){
              counter=counter+1;}
              ArraySort(visited_stars_list);
              ArraySort(report_stars);
              if (ArrayDim(visited_stars_list)!=ArrayDim(report_stars)){report_failed=1;}
              if(!report_failed) {
                counter=0;
                while (counter<ArrayDim(report_stars)){
                if (report_stars[counter]!=visited_stars_list[counter]){report_failed=1;}
                counter=counter+1;}
                if(!report_failed) {
                  counter=0;
                  counter2=0;
                  while (counter<ArrayDim(visited_planets_list)){
                  if (visited_planets_list[counter]==Id(report_planet1)){counter2=counter2+1;}
                  counter=counter+1;}
                  if ((counter2!=report_planet_count1) && (counter2<3)){report_failed=1;}
                  if ((report_planet_count1!=3) && (counter2>=3)){report_failed=1;}
                  counter=0;
                  counter2=0;
                  while (counter<ArrayDim(visited_planets_list)){
                  if (visited_planets_list[counter]==Id(report_planet2)){counter2=counter2+1;}
                  counter=counter+1;}
                  if ((counter2!=report_planet_count2) && (counter2<3)){report_failed=1;}
                  if ((report_planet_count2!=3) && (counter2>=3)){report_failed=1;}
                  if(!report_failed) {
                    if (susp_ship_report_name!=suspicious_ship_name){report_failed=1;}
                  }
                }
              }
            }
        >>>
    }
    89 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.215"),"<0>",suspicious_ships_list[0]));
        Code=<<<
            chosen_num=0;
            susp_ship_report_name=suspicious_ships_list[chosen_num];
            DChange(104);
            exit;
        >>>
    }
    90 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.215"),"<0>",suspicious_ships_list[1]));
        Code=<<<
            chosen_num=1;
            susp_ship_report_name=suspicious_ships_list[chosen_num];
            DChange(104);
            exit;
        >>>
    }
    91 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.215"),"<0>",suspicious_ships_list[2]));
        Code=<<<
            chosen_num=2;
            susp_ship_report_name=suspicious_ships_list[chosen_num];
            DChange(104);
            exit;
        >>>
    }
    92 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.215"),"<0>",suspicious_ships_list[3]));
        Code=<<<
            chosen_num=3;
            susp_ship_report_name=suspicious_ships_list[chosen_num];
            DChange(104);
            exit;
        >>>
    }
    93 ~{
        Command=
        Answer=DAnswer(Format(CT("Script.PC_fem_rangers.215"),"<0>",suspicious_ships_list[4]));
        Code=<<<
            chosen_num=4;
            susp_ship_report_name=suspicious_ships_list[chosen_num];
            DChange(104);
            exit;
        >>>
    }
    94 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.261"));
        Code=<<<
            cur_talk_ship=CurShip;
            if(cur_relation_type>=2) {
              if((GetShipPirateRank(Player())<6) && ((GetShipPirateRank(Player())-agent_counter)<=2)) {
                if(StarOwner(ShipStar(Player()))==0) {
                  counter=0;
                  quest_ship=0;
                  while (counter<GroupCount(GroupEnemies)){
                  if (ShipInNormalSpace(GroupShip(GroupEnemies,counter)) && (ShipStar(cur_talk_ship)==ShipStar(GroupShip(GroupEnemies,counter)))){
                  if ((ShipGetBad(cur_talk_ship)==GroupShip(GroupEnemies,counter)) || (cur_talk_ship==ShipGetBad(GroupShip(GroupEnemies,counter)))){
                  if (Dist(cur_talk_ship,GroupShip(GroupEnemies,counter))<500){quest_ship=GroupShip(GroupEnemies,counter);}
                  }}
                  counter=counter+1;}
                  if (ShipGetBad(cur_talk_ship)){
                  if (ShipStar(ShipGetBad(cur_talk_ship))==ShipStar(cur_talk_ship)){
                  if (Dist(cur_talk_ship,ShipGetBad(cur_talk_ship))<500){
                  quest_ship=ShipGetBad(cur_talk_ship);
                  }}}
                  if(!quest_ship) {
                    if(quest_status==10) {
                      if(shu_extra_mission) {
                        quest_planet=0;
                        quest_star=0;
                        supply_system_value=3;
                        supply_system=0;
                        counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),1,255);
                        if (counter){
                        counter=0;
                        while (counter<(ArrayDim(locations))){
                        counter2=0;
                        counter3=0;
                        supply_system_value2=0;
                        while (counter2<(ArrayDim(locations))){
                        if (Dist(locations[counter2],locations[counter])<(16+3*GalaxyTechLevel())){counter3=counter3+1;}
                        if (Dist(locations[counter2],locations[counter])<(32+6*GalaxyTechLevel())){supply_system_value2=supply_system_value2+1;}
                        counter2=counter2+1;}
                        if ((counter3==supply_system_value) && (supply_system_value2>6)){ 
                        if (abs(Dist(supply_system,ShipStar(Player()))-60)>abs(Dist(locations[counter],ShipStar(Player()))-60)){
                        supply_system=locations[counter];}}
                        if ((counter3>supply_system_value) && (supply_system_value2>6)){
                        supply_system=locations[counter];
                        supply_system_value=counter3;}
                        counter=counter+1;}
                        }
                        if (supply_system_value>3){quest_star=supply_system;
                        quest_planet=FindPlanet(quest_star,'NotMaloc,NotPeleng,NotPeople,NotFei,NotGaal,NotPirateClan',0,100);}
                        if(!quest_planet) {
                          DChange(131);
                          exit;
                        }
                        if(quest_planet) {
                          DChange(106);
                          exit;
                        }
                      }
                      if(!shu_extra_mission) {
                        DChange(105);
                        exit;
                      }
                    }
                    if(quest_status!=10) {
                      if(ShipRank(Player())<3) {
                        DChange(86);
                        exit;
                      }
                      if(ShipRank(Player())>=3) {
                        if(PlayerQuestInProgress()) {
                          DChange(67);
                          exit;
                        }
                        if(!PlayerQuestInProgress()) {
                          if(ControlledSystems(0)>=15) {
                            counter=1;
                            counter2=0;
                            quest_star=0;
                            while (counter<20){
                            if (StarOwner(StarNearbyStars(ShipStar(Player()),counter))==0){
                            quest_star=StarNearbyStars(ShipStar(Player()),counter);
                            counter2=counter2+1;}
                            counter=counter+1;}
                            if(counter2>=10) {
                              DChange(68);
                              exit;
                            }
                            if(counter2<10) {
                              DChange(87);
                              exit;
                            }
                          }
                          if(ControlledSystems(0)<15) {
                            DChange(88);
                            exit;
                          }
                        }
                      }
                    }
                  }
                  if(quest_ship) {
                    if(ShipGetBad(quest_ship)==cur_talk_ship) {
                      DChange(84);
                      exit;
                    }
                    if(ShipGetBad(quest_ship)!=cur_talk_ship) {
                      DChange(85);
                      exit;
                    }
                  }
                }
                if(StarOwner(ShipStar(Player()))==1) {
                  DChange(81);
                  exit;
                }
                if(StarOwner(ShipStar(Player()))==2) {
                  DChange(82);
                  exit;
                }
              }
              if((GetShipPirateRank(Player())>=6) || ((GetShipPirateRank(Player())-agent_counter)>2)) {
                if(GetShipPirateRank(Player())>agent_counter*2) {
                  if(cur_relation_type==0) {
                    DChange(53);
                    exit;
                  }
                  if(cur_relation_type==1) {
                    DChange(54);
                    exit;
                  }
                  if(cur_relation_type==2) {
                    DChange(55);
                    exit;
                  }
                  if(cur_relation_type==3) {
                    DChange(56);
                    exit;
                  }
                  if(cur_relation_type==4) {
                    DChange(57);
                    exit;
                  }
                }
                if(GetShipPirateRank(Player())<=agent_counter*2) {
                  if(cur_relation_type==0) {
                    DChange(58);
                    exit;
                  }
                  if(cur_relation_type==1) {
                    DChange(59);
                    exit;
                  }
                  if(cur_relation_type==2) {
                    DChange(60);
                    exit;
                  }
                  if(cur_relation_type==3) {
                    DChange(61);
                    exit;
                  }
                  if(cur_relation_type==4) {
                    DChange(62);
                    exit;
                  }
                }
              }
            }
            if(cur_relation_type<2) {
              DChange(83);
              exit;
            }
        >>>
    }
    95 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.262"));
        Code=
    }
    96 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.251"));
        Code=<<<
            cur_talk_ship=CurShip;
            if(cur_relation_type>=2) {
              if((GetShipPirateRank(Player())<6) && ((GetShipPirateRank(Player())-agent_counter)<=2)) {
                if(StarOwner(ShipStar(Player()))==0) {
                  counter=0;
                  quest_ship=0;
                  while (counter<GroupCount(GroupEnemies)){
                  if (ShipInNormalSpace(GroupShip(GroupEnemies,counter)) && (ShipStar(cur_talk_ship)==ShipStar(GroupShip(GroupEnemies,counter)))){
                  if ((ShipGetBad(cur_talk_ship)==GroupShip(GroupEnemies,counter)) || (cur_talk_ship==ShipGetBad(GroupShip(GroupEnemies,counter)))){
                  if (Dist(cur_talk_ship,GroupShip(GroupEnemies,counter))<500){quest_ship=GroupShip(GroupEnemies,counter);}
                  }}
                  counter=counter+1;}
                  if (ShipGetBad(cur_talk_ship)){
                  if (ShipStar(ShipGetBad(cur_talk_ship))==ShipStar(cur_talk_ship)){
                  if (Dist(cur_talk_ship,ShipGetBad(cur_talk_ship))<500){
                  quest_ship=ShipGetBad(cur_talk_ship);
                  }}}
                  if(!quest_ship) {
                    if(quest_status==10) {
                      if(shu_extra_mission) {
                        quest_planet=0;
                        quest_star=0;
                        supply_system_value=3;
                        supply_system=0;
                        counter=BuildListOfQuestPossibleLocations(locations,ShipStar(Player()),1,255);
                        if (counter){
                        counter=0;
                        while (counter<(ArrayDim(locations))){
                        counter2=0;
                        counter3=0;
                        supply_system_value2=0;
                        while (counter2<(ArrayDim(locations))){
                        if (Dist(locations[counter2],locations[counter])<(16+3*GalaxyTechLevel())){counter3=counter3+1;}
                        if (Dist(locations[counter2],locations[counter])<(32+6*GalaxyTechLevel())){supply_system_value2=supply_system_value2+1;}
                        counter2=counter2+1;}
                        if ((counter3==supply_system_value) && (supply_system_value2>6)){ 
                        if (abs(Dist(supply_system,ShipStar(Player()))-60)>abs(Dist(locations[counter],ShipStar(Player()))-60)){
                        supply_system=locations[counter];}}
                        if ((counter3>supply_system_value) && (supply_system_value2>6)){
                        supply_system=locations[counter];
                        supply_system_value=counter3;}
                        counter=counter+1;}
                        }
                        if (supply_system_value>3){quest_star=supply_system;
                        quest_planet=FindPlanet(quest_star,'NotMaloc,NotPeleng,NotPeople,NotFei,NotGaal,NotPirateClan',0,100);}
                        if(!quest_planet) {
                          DChange(131);
                          exit;
                        }
                        if(quest_planet) {
                          DChange(106);
                          exit;
                        }
                      }
                      if(!shu_extra_mission) {
                        DChange(105);
                        exit;
                      }
                    }
                    if(quest_status!=10) {
                      if(ShipRank(Player())<3) {
                        DChange(86);
                        exit;
                      }
                      if(ShipRank(Player())>=3) {
                        if(PlayerQuestInProgress()) {
                          DChange(67);
                          exit;
                        }
                        if(!PlayerQuestInProgress()) {
                          if(ControlledSystems(0)>=15) {
                            counter=1;
                            counter2=0;
                            quest_star=0;
                            while (counter<20){
                            if (StarOwner(StarNearbyStars(ShipStar(Player()),counter))==0){
                            quest_star=StarNearbyStars(ShipStar(Player()),counter);
                            counter2=counter2+1;}
                            counter=counter+1;}
                            if(counter2>=10) {
                              DChange(68);
                              exit;
                            }
                            if(counter2<10) {
                              DChange(87);
                              exit;
                            }
                          }
                          if(ControlledSystems(0)<15) {
                            DChange(88);
                            exit;
                          }
                        }
                      }
                    }
                  }
                  if(quest_ship) {
                    if(ShipGetBad(quest_ship)==cur_talk_ship) {
                      DChange(84);
                      exit;
                    }
                    if(ShipGetBad(quest_ship)!=cur_talk_ship) {
                      DChange(85);
                      exit;
                    }
                  }
                }
                if(StarOwner(ShipStar(Player()))==1) {
                  DChange(81);
                  exit;
                }
                if(StarOwner(ShipStar(Player()))==2) {
                  DChange(82);
                  exit;
                }
              }
              if((GetShipPirateRank(Player())>=6) || ((GetShipPirateRank(Player())-agent_counter)>2)) {
                if(GetShipPirateRank(Player())>agent_counter*2) {
                  if(cur_relation_type==0) {
                    DChange(53);
                    exit;
                  }
                  if(cur_relation_type==1) {
                    DChange(54);
                    exit;
                  }
                  if(cur_relation_type==2) {
                    DChange(55);
                    exit;
                  }
                  if(cur_relation_type==3) {
                    DChange(56);
                    exit;
                  }
                  if(cur_relation_type==4) {
                    DChange(57);
                    exit;
                  }
                }
                if(GetShipPirateRank(Player())<=agent_counter*2) {
                  if(cur_relation_type==0) {
                    DChange(58);
                    exit;
                  }
                  if(cur_relation_type==1) {
                    DChange(59);
                    exit;
                  }
                  if(cur_relation_type==2) {
                    DChange(60);
                    exit;
                  }
                  if(cur_relation_type==3) {
                    DChange(61);
                    exit;
                  }
                  if(cur_relation_type==4) {
                    DChange(62);
                    exit;
                  }
                }
              }
            }
            if(cur_relation_type<2) {
              DChange(83);
              exit;
            }
        >>>
    }
    97 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.263"));
        Code=<<<
            DChange(107);
            exit;
        >>>
    }
    98 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.264"));
        Code=<<<
            DChange(108);
            exit;
        >>>
    }
    99 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.265"));
        Code=<<<
            DChange(109);
            exit;
        >>>
    }
    100 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.266"));
        Code=<<<
            DChange(110);
            exit;
        >>>
    }
    101 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.267"));
        Code=<<<
            if((shu_extra_mission%16)<8) {
              DChange(112);
              exit;
            }
            if((shu_extra_mission%16)>=8) {
              DChange(111);
              exit;
            }
        >>>
    }
    102 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.268"));
        Code=<<<
            if((shu_extra_mission%16)<8) {
              DChange(112);
              exit;
            }
            if((shu_extra_mission%16)>=8) {
              DChange(111);
              exit;
            }
        >>>
    }
    103 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.269"));
        Code=<<<
            DChange(113);
            exit;
        >>>
    }
    104 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.86"));
        Code=<<<
            quest_status=11;
            planet_supply=Id(quest_planet);
            supply_system=Id(supply_system);
            last_start=CurTurn();
            Ether(3,'A54ADEB9-FAB4-46E4-B0BC-5B91CB470D5C',Format(CT("Script.PC_fem_rangers.272"),"<0>",Name(IdToPlanet(planet_supply)),"<1>",Name(PlanetToStar(IdToPlanet(planet_supply)))));
        >>>
    }
    105 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.273"));
        Code=<<<
            report_stars=newarray(1);
            report_stars[0]=nearby_stars_list[0];
            ArrayDelete(nearby_stars_list,0);
            ArraySort(nearby_stars_list);
            ArrayAdd(nearby_stars_list,0);
            counter=0;
            DChange(90);
            exit;
        >>>
    }
    106 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.275"));
        Code=<<<
            third_mission_refused=1;
        >>>
    }
    107 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.279"));
        Code=<<<
            DChange(115);
            exit;
        >>>
    }
    108 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.64"));
        Code=<<<
            supply_annoy=1;
            turns_near_player=0;
        >>>
    }
    109 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.64"));
        Code=
    }
    110 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.285"));
        Code=<<<
            DChange(118);
            exit;
        >>>
    }
    111 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.64"));
        Code=<<<
            center_warning=1;
        >>>
    }
    112 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.286"));
        Code=<<<
            DChange(119);
            exit;
        >>>
    }
    113 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.64"));
        Code=
    }
    114 ~{
        Command=planet
        Answer=DAnswer('planet~'+CT("Script.PC_fem_rangers.187"));
        Code=
    }
    115 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.299"));
        Code=<<<
            if((CurTurn()%3)==0) {
              DChange(125);
              exit;
            }
            if((CurTurn()%3)==1) {
              DChange(126);
              exit;
            }
            if((CurTurn()%3)==2) {
              DChange(127);
              exit;
            }
        >>>
    }
    116 ~{
        Command=
        Answer=DAnswer(CT("Script.PC_fem_rangers.300"));
        Code=<<<
            if((CurTurn()%3)==0) {
              DChange(128);
              exit;
            }
            if((CurTurn()%3)==1) {
              DChange(129);
              exit;
            }
            if((CurTurn()%3)==2) {
              DChange(130);
              exit;
            }
        >>>
    }
    117 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.143"));
        Code=
    }
    118 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.64"));
        Code=
    }
    119 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.350"));
        Code=<<<
            ShipMoney(Player(),ShipMoney(Player())+money_truce);
            ShipMoney(CurShip,ShipMoney(CurShip)-money_truce);
            Sound('Sound.Buy');
            TruceBetweenShips(Player(),CurShip);
            RelationToRanger(CurShip,Player(),10);
        >>>
    }
    120 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.351"));
        Code=
    }
    121 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.352"));
        Code=<<<
            ShipMoney(Player(),ShipMoney(Player())+money_truce);
            ShipMoney(CurShip,ShipMoney(CurShip)-money_truce);
            Sound('Sound.Buy');
            TruceBetweenShips(Player(),CurShip);
            RelationToRanger(CurShip,Player(),10);
        >>>
    }
    122 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.353"));
        Code=
    }
    123 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.64"));
        Code=
    }
    124 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.64"));
        Code=
    }
    125 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.358"));
        Code=<<<
            OrderFollowShip(Player(),ShipOrderObj(CurShip));
            AutoBattle(ShipOrderObj(CurShip));
        >>>
    }
    126 ~{
        Command=exit
        Answer=DAnswer('exit~'+CT("Script.PC_fem_rangers.359"));
        Code=
    }
}
